{"version":3,"sources":["/Users/supreme/Desktop/marketsage/src/components/leadpulse/EngagementMetrics.tsx"],"sourcesContent":["'use client';\n\nimport React, { useMemo, useCallback } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, Clock, MousePointer, Eye, Target } from 'lucide-react';\nimport type { VisitorJourney } from '@/lib/leadpulse/dataProvider';\n\ninterface EngagementMetricsProps {\n  journeys: VisitorJourney[];\n  isLoading?: boolean;\n}\n\nconst EngagementMetrics = React.memo<EngagementMetricsProps>(({ journeys, isLoading }) => {\n  const metrics = useMemo(() => {\n    if (journeys.length === 0) {\n      return {\n        averageEngagement: 0,\n        highEngagement: 0,\n        mediumEngagement: 0,\n        lowEngagement: 0,\n        averageSessionTime: 0,\n        averagePageViews: 0,\n        bounceRate: 0,\n        interactions: 0,\n        trend: 'stable' as 'up' | 'down' | 'stable'\n      };\n    }\n\n    const totalVisitors = journeys.length;\n    const totalEngagement = journeys.reduce((sum, j) => sum + j.engagementScore, 0);\n    const averageEngagement = Math.round(totalEngagement / totalVisitors);\n\n    const highEngagement = journeys.filter(j => j.engagementScore >= 70).length;\n    const mediumEngagement = journeys.filter(j => j.engagementScore >= 40 && j.engagementScore < 70).length;\n    const lowEngagement = journeys.filter(j => j.engagementScore < 40).length;\n\n    const totalSessionTime = journeys.reduce((sum, j) => {\n      const sessionTime = j.pulseData.reduce((time, p) => time + (p.value || 60), 0);\n      return sum + sessionTime;\n    }, 0);\n    const averageSessionTime = Math.round(totalSessionTime / totalVisitors);\n\n    const averagePageViews = journeys.reduce((sum, j) => sum + j.totalPages, 0) / totalVisitors;\n    const bounces = journeys.filter(j => j.pulseData.length <= 1).length;\n    const bounceRate = Math.round((bounces / totalVisitors) * 100);\n\n    const interactions = journeys.reduce((sum, j) => {\n      return sum + j.pulseData.filter(p => p.type === 'INTERACTION').length;\n    }, 0);\n\n    const trend = averageEngagement > 60 ? 'up' : averageEngagement < 40 ? 'down' : 'stable';\n\n    return {\n      averageEngagement,\n      highEngagement,\n      mediumEngagement,\n      lowEngagement,\n      averageSessionTime,\n      averagePageViews: Math.round(averagePageViews * 10) / 10,\n      bounceRate,\n      interactions,\n      trend\n    };\n  }, [journeys]);\n\n  if (isLoading) {\n    return (\n      <Card className=\"h-full\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Eye className=\"h-5 w-5\" />\n            Engagement Metrics\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-center h-64\">\n            <div className=\"animate-pulse text-gray-500\">Loading engagement data...</div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Eye className=\"h-5 w-5\" />\n          Engagement Metrics\n        </CardTitle>\n        <div className=\"flex items-center gap-2 mt-2\">\n          <Badge variant={metrics.trend === 'up' ? 'default' : metrics.trend === 'down' ? 'destructive' : 'secondary'}>\n            {metrics.trend === 'up' && <TrendingUp className=\"h-3 w-3 mr-1\" />}\n            {metrics.trend === 'down' && <TrendingDown className=\"h-3 w-3 mr-1\" />}\n            {metrics.trend === 'stable' && <Target className=\"h-3 w-3 mr-1\" />}\n            {metrics.trend === 'up' ? 'High' : metrics.trend === 'down' ? 'Low' : 'Stable'}\n          </Badge>\n          <span className=\"text-sm text-gray-600\">\n            {metrics.averageEngagement}% average engagement\n          </span>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {/* Engagement Score Distribution */}\n        <div className=\"space-y-4\">\n          <h4 className=\"text-sm font-medium\">Engagement Distribution</h4>\n          \n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 bg-green-500 rounded-full\" />\n                <span className=\"text-sm\">High Engagement (70%+)</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm font-medium\">{metrics.highEngagement}</span>\n                <span className=\"text-xs text-gray-500\">\n                  ({journeys.length > 0 ? Math.round((metrics.highEngagement / journeys.length) * 100) : 0}%)\n                </span>\n              </div>\n            </div>\n            <div className=\"w-full bg-gray-200 rounded-full h-2\">\n              <div \n                className=\"bg-green-500 h-2 rounded-full transition-all\" \n                style={{ width: `${journeys.length > 0 ? (metrics.highEngagement / journeys.length) * 100 : 0}%` }}\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 bg-yellow-500 rounded-full\" />\n                <span className=\"text-sm\">Medium Engagement (40-70%)</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm font-medium\">{metrics.mediumEngagement}</span>\n                <span className=\"text-xs text-gray-500\">\n                  ({journeys.length > 0 ? Math.round((metrics.mediumEngagement / journeys.length) * 100) : 0}%)\n                </span>\n              </div>\n            </div>\n            <div className=\"w-full bg-gray-200 rounded-full h-2\">\n              <div \n                className=\"bg-yellow-500 h-2 rounded-full transition-all\" \n                style={{ width: `${journeys.length > 0 ? (metrics.mediumEngagement / journeys.length) * 100 : 0}%` }}\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 bg-red-500 rounded-full\" />\n                <span className=\"text-sm\">Low Engagement (&lt;40%)</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm font-medium\">{metrics.lowEngagement}</span>\n                <span className=\"text-xs text-gray-500\">\n                  ({journeys.length > 0 ? Math.round((metrics.lowEngagement / journeys.length) * 100) : 0}%)\n                </span>\n              </div>\n            </div>\n            <div className=\"w-full bg-gray-200 rounded-full h-2\">\n              <div \n                className=\"bg-red-500 h-2 rounded-full transition-all\" \n                style={{ width: `${journeys.length > 0 ? (metrics.lowEngagement / journeys.length) * 100 : 0}%` }}\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Key Metrics */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n            <Clock className=\"h-6 w-6 mx-auto text-blue-500 mb-2\" />\n            <div className=\"text-lg font-semibold\">{Math.floor(metrics.averageSessionTime / 60)}m {metrics.averageSessionTime % 60}s</div>\n            <div className=\"text-xs text-gray-500\">Avg Session Time</div>\n          </div>\n          \n          <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n            <Eye className=\"h-6 w-6 mx-auto text-purple-500 mb-2\" />\n            <div className=\"text-lg font-semibold\">{metrics.averagePageViews}</div>\n            <div className=\"text-xs text-gray-500\">Pages per Session</div>\n          </div>\n          \n          <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n            <Target className=\"h-6 w-6 mx-auto text-orange-500 mb-2\" />\n            <div className=\"text-lg font-semibold\">{metrics.bounceRate}%</div>\n            <div className=\"text-xs text-gray-500\">Bounce Rate</div>\n          </div>\n          \n          <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n            <MousePointer className=\"h-6 w-6 mx-auto text-green-500 mb-2\" />\n            <div className=\"text-lg font-semibold\">{metrics.interactions}</div>\n            <div className=\"text-xs text-gray-500\">Total Interactions</div>\n          </div>\n        </div>\n\n        {/* Quick Insights */}\n        <div className=\"pt-4 border-t\">\n          <h4 className=\"text-sm font-medium mb-2\">Quick Insights</h4>\n          <div className=\"space-y-2 text-sm text-gray-600\">\n            {metrics.averageEngagement > 60 && (\n              <div className=\"flex items-center gap-2\">\n                <TrendingUp className=\"h-4 w-4 text-green-500\" />\n                <span>Strong visitor engagement across the board</span>\n              </div>\n            )}\n            {metrics.bounceRate > 50 && (\n              <div className=\"flex items-center gap-2\">\n                <TrendingDown className=\"h-4 w-4 text-red-500\" />\n                <span>High bounce rate - consider improving landing pages</span>\n              </div>\n            )}\n            {metrics.averageSessionTime > 180 && (\n              <div className=\"flex items-center gap-2\">\n                <Clock className=\"h-4 w-4 text-blue-500\" />\n                <span>Visitors are spending quality time on your site</span>\n              </div>\n            )}\n            {metrics.interactions > journeys.length && (\n              <div className=\"flex items-center gap-2\">\n                <MousePointer className=\"h-4 w-4 text-purple-500\" />\n                <span>High interaction rate indicates engaging content</span>\n              </div>\n            )}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n});\n\nEngagementMetrics.displayName = 'EngagementMetrics';\n\nexport { EngagementMetrics };\nexport default EngagementMetrics;"],"names":["EngagementMetrics","React","memo","journeys","isLoading","metrics","useMemo","length","averageEngagement","highEngagement","mediumEngagement","lowEngagement","averageSessionTime","averagePageViews","bounceRate","interactions","trend","totalVisitors","totalEngagement","reduce","sum","j","engagementScore","Math","round","filter","totalSessionTime","sessionTime","pulseData","time","p","value","totalPages","bounces","type","Card","className","CardHeader","CardTitle","Eye","CardContent","div","Badge","variant","TrendingUp","TrendingDown","Target","span","h4","style","width","Clock","floor","MousePointer","displayName"],"mappings":"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"}