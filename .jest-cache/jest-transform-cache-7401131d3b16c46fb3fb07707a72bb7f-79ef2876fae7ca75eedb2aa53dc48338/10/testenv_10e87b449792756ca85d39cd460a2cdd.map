{"version":3,"sources":["/Users/supreme/Desktop/marketsage/src/__tests__/integration/mcp/test-env.ts"],"sourcesContent":["/**\n * Test Environment Configuration\n * \n * Sets up environment variables and configuration for integration tests.\n */\n\nimport * as dotenv from 'dotenv';\nimport path from 'path';\n\n// Load environment variables from .env files\ndotenv.config({ path: path.resolve(process.cwd(), '.env') });\ndotenv.config({ path: path.resolve(process.cwd(), '.env.test') });\ndotenv.config({ path: path.resolve(process.cwd(), '.env.local') });\n\n// Set test-specific environment variables\nprocess.env.NODE_ENV = 'test';\n\n// Configure test database URL if not already set\nif (!process.env.TEST_DATABASE_URL && process.env.DATABASE_URL) {\n  // Create test database URL from main database URL\n  const mainDbUrl = process.env.DATABASE_URL;\n  \n  if (mainDbUrl.includes('/marketsage?')) {\n    process.env.TEST_DATABASE_URL = mainDbUrl.replace('/marketsage?', '/marketsage_test?');\n  } else if (mainDbUrl.includes('/marketsage')) {\n    process.env.TEST_DATABASE_URL = mainDbUrl.replace('/marketsage', '/marketsage_test');\n  } else {\n    // Fallback to default test database\n    process.env.TEST_DATABASE_URL = \"postgresql://marketsage:marketsage_password@marketsage-db:5432/marketsage_test?schema=public\";\n  }\n}\n\n// Set other test-specific configurations\nprocess.env.REDIS_URL = process.env.REDIS_URL || 'redis://localhost:6379';\nprocess.env.NEXTAUTH_SECRET = process.env.NEXTAUTH_SECRET || 'test-secret-key-for-integration-tests';\nprocess.env.NEXTAUTH_URL = process.env.NEXTAUTH_URL || 'http://localhost:3000';\n\n// Disable external services in test environment\nprocess.env.DISABLE_EXTERNAL_SERVICES = 'true';\nprocess.env.DISABLE_EMAIL_SENDING = 'true';\nprocess.env.DISABLE_SMS_SENDING = 'true';\nprocess.env.DISABLE_WHATSAPP_SENDING = 'true';\n\n// Set test-specific timeouts\nprocess.env.DATABASE_TIMEOUT = '30000';\nprocess.env.MCP_TIMEOUT = '10000';\n\n// Configure logging for tests\nprocess.env.LOG_LEVEL = process.env.LOG_LEVEL || 'warn';\n\n// Docker environment detection\nif (process.env.DATABASE_URL?.includes('marketsage-db') || process.env.DOCKER_ENV === 'true') {\n  process.env.IS_DOCKER_ENV = 'true';\n  console.log('üê≥ Docker environment detected for integration tests');\n} else {\n  process.env.IS_DOCKER_ENV = 'false';\n  console.log('üíª Local environment detected for integration tests');\n}\n\n// Test database configuration summary\nconsole.log('üîß Test Environment Configuration:');\nconsole.log(`  NODE_ENV: ${process.env.NODE_ENV}`);\nconsole.log(`  DATABASE_URL: ${process.env.DATABASE_URL?.replace(/\\/\\/.*@/, '//***:***@') || 'Not set'}`);\nconsole.log(`  TEST_DATABASE_URL: ${process.env.TEST_DATABASE_URL?.replace(/\\/\\/.*@/, '//***:***@') || 'Not set'}`);\nconsole.log(`  DOCKER_ENV: ${process.env.IS_DOCKER_ENV}`);\nconsole.log('');\n\nexport {};"],"names":["dotenv","config","path","resolve","process","cwd","env","NODE_ENV","TEST_DATABASE_URL","DATABASE_URL","mainDbUrl","includes","replace","REDIS_URL","NEXTAUTH_SECRET","NEXTAUTH_URL","DISABLE_EXTERNAL_SERVICES","DISABLE_EMAIL_SENDING","DISABLE_SMS_SENDING","DISABLE_WHATSAPP_SENDING","DATABASE_TIMEOUT","MCP_TIMEOUT","LOG_LEVEL","DOCKER_ENV","IS_DOCKER_ENV","console","log"],"mappings":"AAAA;;;;CAIC;;;;gEAEuB;6DACP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEjB,6CAA6C;AAC7CA,QAAOC,MAAM,CAAC;IAAEC,MAAMA,aAAI,CAACC,OAAO,CAACC,QAAQC,GAAG,IAAI;AAAQ;AAC1DL,QAAOC,MAAM,CAAC;IAAEC,MAAMA,aAAI,CAACC,OAAO,CAACC,QAAQC,GAAG,IAAI;AAAa;AAC/DL,QAAOC,MAAM,CAAC;IAAEC,MAAMA,aAAI,CAACC,OAAO,CAACC,QAAQC,GAAG,IAAI;AAAc;AAEhE,0CAA0C;AAC1CD,QAAQE,GAAG,CAACC,QAAQ,GAAG;AAEvB,iDAAiD;AACjD,IAAI,CAACH,QAAQE,GAAG,CAACE,iBAAiB,IAAIJ,QAAQE,GAAG,CAACG,YAAY,EAAE;IAC9D,kDAAkD;IAClD,MAAMC,YAAYN,QAAQE,GAAG,CAACG,YAAY;IAE1C,IAAIC,UAAUC,QAAQ,CAAC,iBAAiB;QACtCP,QAAQE,GAAG,CAACE,iBAAiB,GAAGE,UAAUE,OAAO,CAAC,gBAAgB;IACpE,OAAO,IAAIF,UAAUC,QAAQ,CAAC,gBAAgB;QAC5CP,QAAQE,GAAG,CAACE,iBAAiB,GAAGE,UAAUE,OAAO,CAAC,eAAe;IACnE,OAAO;QACL,oCAAoC;QACpCR,QAAQE,GAAG,CAACE,iBAAiB,GAAG;IAClC;AACF;AAEA,yCAAyC;AACzCJ,QAAQE,GAAG,CAACO,SAAS,GAAGT,QAAQE,GAAG,CAACO,SAAS,IAAI;AACjDT,QAAQE,GAAG,CAACQ,eAAe,GAAGV,QAAQE,GAAG,CAACQ,eAAe,IAAI;AAC7DV,QAAQE,GAAG,CAACS,YAAY,GAAGX,QAAQE,GAAG,CAACS,YAAY,IAAI;AAEvD,gDAAgD;AAChDX,QAAQE,GAAG,CAACU,yBAAyB,GAAG;AACxCZ,QAAQE,GAAG,CAACW,qBAAqB,GAAG;AACpCb,QAAQE,GAAG,CAACY,mBAAmB,GAAG;AAClCd,QAAQE,GAAG,CAACa,wBAAwB,GAAG;AAEvC,6BAA6B;AAC7Bf,QAAQE,GAAG,CAACc,gBAAgB,GAAG;AAC/BhB,QAAQE,GAAG,CAACe,WAAW,GAAG;AAE1B,8BAA8B;AAC9BjB,QAAQE,GAAG,CAACgB,SAAS,GAAGlB,QAAQE,GAAG,CAACgB,SAAS,IAAI;AAEjD,+BAA+B;AAC/B,IAAIlB,QAAQE,GAAG,CAACG,YAAY,EAAEE,SAAS,oBAAoBP,QAAQE,GAAG,CAACiB,UAAU,KAAK,QAAQ;IAC5FnB,QAAQE,GAAG,CAACkB,aAAa,GAAG;IAC5BC,QAAQC,GAAG,CAAC;AACd,OAAO;IACLtB,QAAQE,GAAG,CAACkB,aAAa,GAAG;IAC5BC,QAAQC,GAAG,CAAC;AACd;AAEA,sCAAsC;AACtCD,QAAQC,GAAG,CAAC;AACZD,QAAQC,GAAG,CAAC,CAAC,YAAY,EAAEtB,QAAQE,GAAG,CAACC,QAAQ,EAAE;AACjDkB,QAAQC,GAAG,CAAC,CAAC,gBAAgB,EAAEtB,QAAQE,GAAG,CAACG,YAAY,EAAEG,QAAQ,WAAW,iBAAiB,WAAW;AACxGa,QAAQC,GAAG,CAAC,CAAC,qBAAqB,EAAEtB,QAAQE,GAAG,CAACE,iBAAiB,EAAEI,QAAQ,WAAW,iBAAiB,WAAW;AAClHa,QAAQC,GAAG,CAAC,CAAC,cAAc,EAAEtB,QAAQE,GAAG,CAACkB,aAAa,EAAE;AACxDC,QAAQC,GAAG,CAAC"}