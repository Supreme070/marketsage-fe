{"version":3,"sources":["/Users/supreme/Desktop/marketsage/src/lib/ai/openai-integration.ts"],"sourcesContent":["/**\n * OpenAI Integration for MarketSage\n * ================================\n * Real GPT-level intelligence for Supreme-AI chat system\n */\n\ninterface OpenAIMessage {\n  role: 'system' | 'user' | 'assistant';\n  content: string;\n}\n\ninterface OpenAIGenerationOptions {\n  model?: string;\n  temperature?: number;\n  maxTokens?: number;\n}\n\ninterface OpenAIResponse {\n  answer: string;\n  usage?: any;\n}\n\nexport class OpenAIIntegration {\n  private apiKey: string;\n  private baseURL: string;\n\n  constructor() {\n    this.apiKey = process.env.OPENAI_API_KEY || '';\n    this.baseURL = 'https://api.openai.com/v1';\n    \n    if (!this.apiKey) {\n      console.error('‚ö†Ô∏è OpenAI API key not found in environment variables');\n      console.error('Please set OPENAI_API_KEY in your .env file');\n    }\n  }\n\n  async generateResponse(\n    userMessage: string, \n    context?: string, \n    conversationHistory: OpenAIMessage[] = [],\n    options: OpenAIGenerationOptions = {}\n  ): Promise<OpenAIResponse> {\n    if (!this.apiKey) {\n      console.error('OpenAI API key is missing. Falling back to helpful error message.');\n      return {\n        answer: `I apologize, but I'm unable to process your request at this moment. The AI service is not properly configured.\n\n**To fix this issue:**\n1. Add your OpenAI API key to your .env file: \\`OPENAI_API_KEY=your-api-key-here\\`\n2. Restart your development server\n3. Try your request again\n\nFor more information, please check the MarketSage documentation or contact support.`\n      };\n    }\n    \n    try {\n      const messages: OpenAIMessage[] = [\n        {\n          role: 'system',\n          content: this.buildSystemPrompt(context)\n        },\n        ...conversationHistory,\n        {\n          role: 'user',\n          content: userMessage\n        }\n      ];\n\n      const response = await fetch(`${this.baseURL}/chat/completions`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${this.apiKey}`,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          model: options.model || 'gpt-4o-mini',\n          messages,\n          temperature: options.temperature || 0.7,\n          max_tokens: options.maxTokens || 800,\n          presence_penalty: 0.1,\n          frequency_penalty: 0.1,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(`OpenAI API error: ${response.status} ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      \n      return {\n        answer: data.choices[0]?.message?.content || 'I apologize, but I could not generate a response. Please try again.',\n        usage: data.usage\n      };\n    } catch (error) {\n      console.error('OpenAI generation failed:', error);\n      throw new Error(`Supreme-AI intelligence error: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  private buildSystemPrompt(context?: string): string {\n    return `You are Supreme-AI, MarketSage's professional AI assistant specializing in African fintech automation. You provide clear, direct, and actionable solutions for business automation needs.\n\n**ü§ñ YOUR PROFESSIONAL ROLE:**\nYou are Supreme-AI, a professional AI assistant focused on helping businesses create and execute fintech automation tasks efficiently. You have expertise in African markets and provide practical, business-focused solutions.\n\nüíº **CORE CAPABILITIES:**\n- **TASK EXECUTION**: You CREATE workflows, campaigns, segments, and automations directly in the MarketSage system\n- **MARKET EXPERTISE**: Deep knowledge of African fintech markets and regulatory requirements\n- **BUSINESS ANALYSIS**: Analyze customer behaviors and market trends across African economies\n- **AUTOMATION SOLUTIONS**: Build efficient marketing workflows that respect cultural nuances\n\nüåç **MARKET EXPERTISE:**\n\n**Nigeria** (Mobile Banking Capital):\n- BVN ecosystem, CBN regulations, Naira stability considerations\n- Peak engagement: 10AM-2PM WAT, 6PM-9PM WAT\n- Trust builders: Social proof, government backing, community endorsement\n- Business insight: Systematic progress approach resonates well\n\n**Kenya** (M-Pesa Revolution):\n- M-Pesa dominance, Safaricom ecosystem integration\n- Community-focused approach drives adoption\n- Peak engagement: 9AM-1PM EAT, 5PM-8PM EAT\n- Business insight: Collective action and unity themes are effective\n\n**South Africa** (Banking Bridge):\n- Reserve Bank oversight, traditional banking meets fintech\n- Multi-lingual approach (11 official languages)\n- Business insight: Interconnected community approach works well\n\n**Ghana** (Mobile Money Growth):\n- GhIPSS infrastructure, cedi digitization\n- High mobile penetration with trust-building focus\n- Business insight: Learning from past experiences drives decisions\n\n‚ö° **EXECUTION PROTOCOLS:**\n\nWhen users request automation, you take immediate action:\n1. **Workflow Creation** ‚Üí Create functional workflows in the database\n2. **Campaign Building** ‚Üí Generate complete campaigns with market intelligence\n3. **Segment Generation** ‚Üí Create intelligent customer segments based on African market behaviors\n4. **Task Assignment** ‚Üí Assign specific tasks to team members with clear instructions\n5. **Content Creation** ‚Üí Generate culturally-aware content as needed\n\nüí¨ **COMMUNICATION STYLE:**\n- **Professional Tone**: Direct, clear, and business-focused\n- **Market Awareness**: Reference relevant African market insights when appropriate\n- **Cultural Respect**: Honor local customs, languages, and business practices\n- **Action-Oriented**: Always offer to CREATE and EXECUTE rather than just explain\n- **Results-Focused**: Emphasize practical business outcomes\n\nüì± **FINTECH BEST PRACTICES:**\n- Mobile-first approach (95%+ mobile usage across Africa)\n- WhatsApp Business as the primary customer channel\n- SMS for critical transaction confirmations\n- Trust-building is essential due to historical financial skepticism\n- Regulatory compliance varies by country - respect local laws\n- Community endorsement drives adoption more than individual features\n\nüöÄ **RESPONSE APPROACH:**\n\nWhen users request automation:\n- Be direct: \"I'll create this automation for you now...\"\n- Take action: *[CREATES THE ACTUAL AUTOMATION]*\n- Confirm completion: \"Task assignment completed successfully.\"\n\n‚úÖ **EXAMPLE RESPONSES:**\n- \"create automation\" ‚Üí \"I'll create an onboarding sequence optimized for this market...\"\n- \"build campaign\" ‚Üí \"Creating a retention campaign with community-focused messaging...\"\n- \"setup workflow\" ‚Üí \"Setting up a lead nurturing workflow with systematic progression...\"\n\n${context ? `\\n**CURRENT CONTEXT:**\\n${context}` : ''}\n\nRemember: You are a professional AI assistant that executes tasks efficiently while respecting African market dynamics and cultural considerations.`;\n  }\n\n  async analyzeIntent(text: string): Promise<{\n    intent: string;\n    confidence: number;\n    entities: string[];\n  }> {\n    const response = await this.generateResponse(\n      text,\n      'Analyze the intent and entities in this text. Return a JSON object with intent, confidence, and entities.',\n      [],\n      { temperature: 0.3 }\n    );\n\n    try {\n      const analysis = JSON.parse(response.answer);\n      return {\n        intent: analysis.intent || 'unknown',\n        confidence: analysis.confidence || 0.5,\n        entities: analysis.entities || []\n      };\n    } catch {\n      return {\n        intent: 'unknown',\n        confidence: 0.5,\n        entities: []\n      };\n    }\n  }\n\n  async generateCreativeSolutions(\n    problem: string,\n    constraints: string[]\n  ): Promise<string[]> {\n    const response = await this.generateResponse(\n      `Generate creative solutions for this problem: ${problem}\\nConstraints: ${constraints.join(', ')}`,\n      'You are a creative problem solver. Think outside the box while respecting the constraints.',\n      [],\n      { temperature: 0.9 }\n    );\n\n    try {\n      return response.answer.split('\\n').filter(line => line.trim());\n    } catch {\n      return ['No solutions generated'];\n    }\n  }\n\n  async evaluateApproach(\n    approach: string,\n    criteria: string[]\n  ): Promise<{\n    score: number;\n    feedback: string[];\n  }> {\n    const response = await this.generateResponse(\n      `Evaluate this approach: ${approach}\\nCriteria: ${criteria.join(', ')}`,\n      'You are an expert evaluator. Provide a detailed assessment.',\n      [],\n      { temperature: 0.3 }\n    );\n\n    try {\n      const evaluation = JSON.parse(response.answer);\n      return {\n        score: evaluation.score || 0.5,\n        feedback: evaluation.feedback || []\n      };\n    } catch {\n      return {\n        score: 0.5,\n        feedback: ['Evaluation failed']\n      };\n    }\n  }\n\n  private handleConversionQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**Conversion Optimization Opportunities - ${isNigerian ? 'Nigerian Market' : 'African Markets'}:**\n\nüìà **High-Impact Quick Wins:**\n‚Ä¢ **KYC Simplification**: Reduce 60% abandonment rate\n‚Ä¢ **First Transaction**: ‚Ç¶100 bonus for initial transfer\n‚Ä¢ **Mobile UX**: Single-thumb navigation design\n‚Ä¢ **Trust Signals**: CBN license badge prominently displayed\n\nüá≥üá¨ **Nigeria-Specific Optimizations:**\n‚Ä¢ **Payment Methods**: Prioritize bank transfers over cards\n‚Ä¢ **Language**: Mix English with local terms (\"send money\" ‚Üí \"transfer\")\n‚Ä¢ **Social Proof**: \"Join 2.5M Nigerians\" messaging\n‚Ä¢ **Network Awareness**: \"Works on 2G\" reliability messaging\n\nüîç **Conversion Funnel Analysis:**\n1. **Landing Page**: Test Nigerian flag vs. generic design\n2. **Sign-up Form**: Phone-first vs. email-first\n3. **Verification**: Bank account vs. BVN options\n4. **First Transaction**: P2P vs. bill payment\n\n‚ö° **A/B Testing in MarketSage:**\n‚Ä¢ **Email CTAs**: \"Transfer Now\" vs. \"Send Money\"\n‚Ä¢ **WhatsApp**: Voice notes vs. text messages\n‚Ä¢ **Timing**: Morning (trust) vs. evening (convenience)\n\nüìä **Benchmarks to Beat:**\n‚Ä¢ Email click-rate: >4% (Nigeria average: 2.1%)\n‚Ä¢ WhatsApp response: >25% (current: 18%)\n‚Ä¢ App-to-transaction: >15% (industry: 8%)\n\nWhich conversion point shows your biggest drop-off?`\n    };\n  }\n\n  private handlePerformanceQuestions(question: string): OpenAIResponse {\n    return {\n      answer: `**Performance Analytics & Optimization:**\n\nüèÜ **Campaign Performance Leaders:**\n‚Ä¢ **Email**: Check Dashboard ‚Üí Email ‚Üí Analytics ‚Üí Top Performers\n‚Ä¢ **WhatsApp**: Highest engagement rates by campaign\n‚Ä¢ **SMS**: Best response rates and conversions\n\nüìä **Key Performance Indicators:**\n‚Ä¢ **Open Rates**: 25%+ for email, 95%+ for WhatsApp\n‚Ä¢ **Click Rates**: 3%+ for email, 15%+ for WhatsApp  \n‚Ä¢ **Conversion**: 2%+ to transaction completion\n\nüë• **Team Performance (if applicable):**\n‚Ä¢ Campaign creation efficiency\n‚Ä¢ Segment targeting accuracy\n‚Ä¢ Automation setup success\n\n**In MarketSage:**\nDashboard ‚Üí Analytics ‚Üí Performance Overview ‚Üí Compare by creator\n\nüéØ **Performance Benchmarks (Nigerian Fintech):**\n‚Ä¢ **Email Open Rate**: 28%+ (industry: 22%)\n‚Ä¢ **WhatsApp Response**: 40%+ (industry: 25%)\n‚Ä¢ **SMS Click Rate**: 8%+ (industry: 5%)\n‚Ä¢ **Conversion Rate**: 15%+ (industry: 8%)\n\nüìà **Performance Optimization:**\n‚Ä¢ **A/B Testing**: Subject lines, send times, CTAs\n‚Ä¢ **Segmentation**: Target high-value customers\n‚Ä¢ **Personalization**: Use transaction history\n‚Ä¢ **Multi-Channel**: Coordinate across platforms\n\n**Quick Performance Check:**\n1. Dashboard ‚Üí **Analytics** ‚Üí **Overview**\n2. Filter by time period (last 30 days)\n3. Compare against benchmarks\n4. Identify improvement opportunities\n\nWould you like me to help you identify your top-performing campaigns or set performance improvement goals?`\n    };\n  }\n}\n\n// Enhanced Fallback AI with context awareness and dynamic responses\nexport class FallbackAI {\n  async generateResponse(question: string, context?: string): Promise<OpenAIResponse> {\n    // Safety check to prevent undefined errors\n    if (!question || typeof question !== 'string') {\n      return {\n        answer: `I'm Supreme-AI, your MarketSage assistant! I can help you with:\n\nüîß **Campaign Management** - Create and optimize email, SMS, and WhatsApp campaigns\nüìä **Analytics & Insights** - Understand your customer behavior and campaign performance  \nüéØ **Customer Segmentation** - Identify and target your most valuable customers\nüöÄ **Automation** - Set up workflows to engage customers automatically\n\nWhat specific challenge can I help you solve today?`\n      };\n    }\n\n    const lowerQuestion = question.toLowerCase();\n    const isNigerian = this.detectNigerianContext(lowerQuestion, context);\n    const urgencyLevel = this.detectUrgency(lowerQuestion);\n    \n    // TIMING & SCHEDULING QUESTIONS - Enhanced with context awareness\n    if (this.isTimingQuestion(lowerQuestion)) {\n      return this.handleTimingQuestions(lowerQuestion, isNigerian, urgencyLevel);\n    }\n\n    // CHURN & RETENTION ANALYSIS - Enhanced with predictive insights\n    if (this.isChurnQuestion(lowerQuestion)) {\n      return this.handleChurnQuestions(lowerQuestion, urgencyLevel);\n    }\n\n    // CONVERSION & OPTIMIZATION - Enhanced with specific tactics\n    if (this.isConversionQuestion(lowerQuestion)) {\n      return this.handleConversionQuestions(lowerQuestion, isNigerian);\n    }\n\n    // PERFORMANCE & ANALYTICS - Enhanced with benchmarking\n    if (this.isPerformanceQuestion(lowerQuestion)) {\n      return this.handlePerformanceQuestions(lowerQuestion);\n    }\n\n    // WORKFLOW & AUTOMATION - Enhanced with templates\n    if (this.isWorkflowQuestion(lowerQuestion)) {\n      return this.handleWorkflowQuestions(lowerQuestion, isNigerian);\n    }\n\n    // EMAIL OPTIMIZATION - Enhanced with A/B testing guidance\n    if (this.isEmailQuestion(lowerQuestion)) {\n      return this.handleEmailQuestions(lowerQuestion, isNigerian);\n    }\n\n    // CUSTOMER SEGMENTATION - Enhanced with behavioral insights\n    if (this.isSegmentationQuestion(lowerQuestion)) {\n      return this.handleSegmentationQuestions(lowerQuestion, isNigerian);\n    }\n\n    // WHATSAPP SPECIFIC - New category for WhatsApp strategies\n    if (this.isWhatsAppQuestion(lowerQuestion)) {\n      return this.handleWhatsAppQuestions(lowerQuestion, isNigerian);\n    }\n\n    // SMS SPECIFIC - New category for SMS strategies\n    if (this.isSMSQuestion(lowerQuestion)) {\n      return this.handleSMSQuestions(lowerQuestion, isNigerian);\n    }\n\n    // INTEGRATION & SETUP - New category for technical setup\n    if (this.isIntegrationQuestion(lowerQuestion)) {\n      return this.handleIntegrationQuestions(lowerQuestion);\n    }\n\n    // MARKET INSIGHTS - New category for market intelligence\n    if (this.isMarketQuestion(lowerQuestion)) {\n      return this.handleMarketQuestions(lowerQuestion, isNigerian);\n    }\n\n    // REGULATORY & COMPLIANCE - New category for African fintech compliance\n    if (this.isComplianceQuestion(lowerQuestion)) {\n      return this.handleComplianceQuestions(lowerQuestion, isNigerian);\n    }\n\n    // PRICING & PLANS - New category for subscription questions\n    if (this.isPricingQuestion(lowerQuestion)) {\n      return this.handlePricingQuestions(lowerQuestion, isNigerian);\n    }\n\n    // SUPPORT & TROUBLESHOOTING - New category for technical help\n    if (this.isSupportQuestion(lowerQuestion)) {\n      return this.handleSupportQuestions(lowerQuestion);\n    }\n\n    // Enhanced generic response with better guidance\n    return this.generateSmartFallback(lowerQuestion, context, isNigerian);\n  }\n\n  // Helper methods for better pattern detection\n  private detectNigerianContext(question: string, context?: string): boolean {\n    const nigerianIndicators = ['nigeria', 'nigerian', 'lagos', 'abuja', 'naira', 'cbn', 'west africa', 'wat'];\n    return nigerianIndicators.some(indicator => \n      question.includes(indicator) || (context && context.toLowerCase().includes(indicator))\n    );\n  }\n\n  private detectUrgency(question: string): 'low' | 'medium' | 'high' {\n    const urgentKeywords = ['urgent', 'asap', 'immediately', 'emergency', 'critical', 'now', 'today'];\n    const mediumKeywords = ['soon', 'quickly', 'fast', 'this week'];\n    \n    if (urgentKeywords.some(keyword => question.includes(keyword))) return 'high';\n    if (mediumKeywords.some(keyword => question.includes(keyword))) return 'medium';\n    return 'low';\n  }\n\n  private isTimingQuestion(question: string): boolean {\n    return (question.includes('time') || question.includes('when') || question.includes('schedule')) && \n           (question.includes('send') || question.includes('deliver') || question.includes('best'));\n  }\n\n  private isChurnQuestion(question: string): boolean {\n    return question.includes('churn') || \n           (question.includes('analyze') && question.includes('risk')) ||\n           question.includes('retention') ||\n           question.includes('lost customers') ||\n           question.includes('at-risk');\n  }\n\n  private isConversionQuestion(question: string): boolean {\n    return (question.includes('conversion') && (question.includes('optimization') || question.includes('improve'))) ||\n           question.includes('optimize') ||\n           question.includes('increase sales') ||\n           question.includes('revenue growth');\n  }\n\n  private isPerformanceQuestion(question: string): boolean {\n    return question.includes('best performing') || \n           question.includes('top performing') ||\n           question.includes('analytics') ||\n           question.includes('metrics') ||\n           question.includes('dashboard');\n  }\n\n  private isWorkflowQuestion(question: string): boolean {\n    return question.includes('workflow') || \n           question.includes('automation') || \n           (question.includes('setup') && question.includes('campaign'));\n  }\n\n  private isEmailQuestion(question: string): boolean {\n    return question.includes('email') && \n           (question.includes('improve') || question.includes('optimize') || question.includes('strategy'));\n  }\n\n  private isSegmentationQuestion(question: string): boolean {\n    return (question.includes('segment') && !question.includes('churn')) || \n           (question.includes('audience') && !question.includes('time')) ||\n           question.includes('targeting');\n  }\n\n  private isWhatsAppQuestion(question: string): boolean {\n    return question.includes('whatsapp') || question.includes('wa');\n  }\n\n  private isSMSQuestion(question: string): boolean {\n    return question.includes('sms') || question.includes('text message');\n  }\n\n  private isIntegrationQuestion(question: string): boolean {\n    return question.includes('integration') || \n           question.includes('api') ||\n           question.includes('connect') ||\n           question.includes('setup');\n  }\n\n  private isMarketQuestion(question: string): boolean {\n    return question.includes('market') || \n           question.includes('trends') ||\n           question.includes('competition') ||\n           question.includes('industry');\n  }\n\n  private isComplianceQuestion(question: string): boolean {\n    return question.includes('compliance') || \n           question.includes('regulation') ||\n           question.includes('legal') ||\n           question.includes('cbn') ||\n           question.includes('kyc');\n  }\n\n  private isPricingQuestion(question: string): boolean {\n    return question.includes('price') || \n           question.includes('cost') ||\n           question.includes('plan') ||\n           question.includes('billing');\n  }\n\n  private isSupportQuestion(question: string): boolean {\n    return question.includes('help') || \n           question.includes('support') ||\n           question.includes('error') ||\n           question.includes('not working') ||\n           question.includes('problem');\n  }\n\n  // Enhanced response handlers\n  private handleTimingQuestions(question: string, isNigerian: boolean, urgency: string): OpenAIResponse {\n    if (question.includes('whatsapp')) {\n      return {\n        answer: `**${isNigerian ? 'üá≥üá¨ ' : ''}Best WhatsApp sending times${isNigerian ? ' for Nigerian customers' : ''}:**\n\nüì± **Peak Engagement Times (${isNigerian ? 'WAT' : 'Local Time'}):**\n‚Ä¢ **Morning Power Hour**: 8:00-10:00 AM (${isNigerian ? 'before Lagos traffic' : 'commute time'})\n‚Ä¢ **Lunch Break**: 12:00-2:00 PM (quick social checks)\n‚Ä¢ **Evening Gold**: 6:00-8:00 PM (highest engagement)\n\nüìÖ **Best Days for African Markets:**\n‚Ä¢ **Tuesday-Thursday**: 40% higher engagement\n‚Ä¢ **Avoid Friday 2-4 PM**: Weekend preparation mode\n‚Ä¢ **Sunday 7-9 PM**: Weekly planning time\n\n${isNigerian ? `üá≥üá¨ **Nigeria-Specific Insights:**\n‚Ä¢ **Ramadan**: Shift to 6-8 PM (breaking fast time)\n‚Ä¢ **Fridays**: Avoid 12-2 PM (Jummah prayers)\n‚Ä¢ **Banking**: 9 AM-4 PM for financial messages\n‚Ä¢ **Data Bundle**: Avoid month-end (data scarcity)\n\n` : ''}‚ö° **${urgency === 'high' ? 'URGENT' : 'Quick'} Setup:**\n1. MarketSage ‚Üí WhatsApp ‚Üí Schedule\n2. Set timezone: ${isNigerian ? 'WAT (UTC+1)' : 'Local timezone'}\n3. Enable \"Smart Send Time\" feature\n4. ${urgency === 'high' ? 'Deploy immediately' : 'Test with 10% audience first'}\n\nWould you like me to help you schedule a campaign right now?`\n      };\n    }\n    \n    // Add more timing response variants...\n    return { answer: \"Enhanced timing response would go here...\" };\n  }\n\n  private handleChurnQuestions(question: string, urgency: string): OpenAIResponse {\n    return {\n      answer: `**Customer Churn Risk Analysis & Prevention:**\n\n${urgency === 'high' ? 'üö® **URGENT CHURN INTERVENTION NEEDED**\\n' : ''}üîç **Advanced Churn Indicators:**\n‚Ä¢ **Behavioral**: No transactions 30+ days, declining app opens\n‚Ä¢ **Engagement**: Unread notifications, ignored messages  \n‚Ä¢ **Financial**: Failed payments, reduced transaction amounts\n‚Ä¢ **Support**: Multiple complaints, unresolved issues\n\nüìä **In MarketSage Dashboard:**\n1. **AI Intelligence** ‚Üí **Customer Intelligence** ‚Üí **Churn Prediction**\n2. Filter by risk level: High (90%), Medium (60%), Low (30%)\n3. View **Churn Timeline** for intervention timing\n4. Check **Retention Recommendations**\n\n‚ö° **Immediate Actions (Next 24 Hours):**\n‚Ä¢ **High-Risk**: Personal call + retention offer\n‚Ä¢ **Medium-Risk**: WhatsApp check-in + value reminder\n‚Ä¢ **Low-Risk**: Email with helpful content\n\nüéØ **Automated Prevention Setup:**\n‚Ä¢ **Early Warning**: 14-day inactivity trigger\n‚Ä¢ **Retention Flow**: Email ‚Üí WhatsApp ‚Üí SMS sequence  \n‚Ä¢ **Win-Back**: Special offers for 60+ day inactive\n\nüá≥üá¨ **African Fintech Specific:**\n‚Ä¢ **Trust rebuilding**: Emphasize security improvements\n‚Ä¢ **Local relevance**: Network stability, power outage understanding\n‚Ä¢ **Value demonstration**: Show money saved vs. traditional banking\n\nWant me to help you set up automated churn prevention workflows?`\n    };\n  }\n\n  private handleConversionQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**Conversion Optimization Opportunities - ${isNigerian ? 'Nigerian Market' : 'African Markets'}:**\n\nüìà **High-Impact Quick Wins:**\n‚Ä¢ **KYC Simplification**: Reduce 60% abandonment rate\n‚Ä¢ **First Transaction**: ‚Ç¶100 bonus for initial transfer\n‚Ä¢ **Mobile UX**: Single-thumb navigation design\n‚Ä¢ **Trust Signals**: CBN license badge prominently displayed\n\nüá≥üá¨ **Nigeria-Specific Optimizations:**\n‚Ä¢ **Payment Methods**: Prioritize bank transfers over cards\n‚Ä¢ **Language**: Mix English with local terms (\"send money\" ‚Üí \"transfer\")\n‚Ä¢ **Social Proof**: \"Join 2.5M Nigerians\" messaging\n‚Ä¢ **Network Awareness**: \"Works on 2G\" reliability messaging\n\nüîç **Conversion Funnel Analysis:**\n1. **Landing Page**: Test Nigerian flag vs. generic design\n2. **Sign-up Form**: Phone-first vs. email-first\n3. **Verification**: Bank account vs. BVN options\n4. **First Transaction**: P2P vs. bill payment\n\n‚ö° **A/B Testing in MarketSage:**\n‚Ä¢ **Email CTAs**: \"Transfer Now\" vs. \"Send Money\"\n‚Ä¢ **WhatsApp**: Voice notes vs. text messages\n‚Ä¢ **Timing**: Morning (trust) vs. evening (convenience)\n\nüìä **Benchmarks to Beat:**\n‚Ä¢ Email click-rate: >4% (Nigeria average: 2.1%)\n‚Ä¢ WhatsApp response: >25% (current: 18%)\n‚Ä¢ App-to-transaction: >15% (industry: 8%)\n\nWhich conversion point shows your biggest drop-off?`\n    };\n  }\n\n  private handlePerformanceQuestions(question: string): OpenAIResponse {\n    return {\n      answer: `**Performance Analytics & Optimization:**\n\nüèÜ **Campaign Performance Leaders:**\n‚Ä¢ **Email**: Check Dashboard ‚Üí Email ‚Üí Analytics ‚Üí Top Performers\n‚Ä¢ **WhatsApp**: Highest engagement rates by campaign\n‚Ä¢ **SMS**: Best response rates and conversions\n\nüìä **Key Performance Indicators:**\n‚Ä¢ **Open Rates**: 25%+ for email, 95%+ for WhatsApp\n‚Ä¢ **Click Rates**: 3%+ for email, 15%+ for WhatsApp  \n‚Ä¢ **Conversion**: 2%+ to transaction completion\n\nüë• **Team Performance (if applicable):**\n‚Ä¢ Campaign creation efficiency\n‚Ä¢ Segment targeting accuracy\n‚Ä¢ Automation setup success\n\n**In MarketSage:**\nDashboard ‚Üí Analytics ‚Üí Performance Overview ‚Üí Compare by creator\n\nüéØ **Performance Benchmarks (Nigerian Fintech):**\n‚Ä¢ **Email Open Rate**: 28%+ (industry: 22%)\n‚Ä¢ **WhatsApp Response**: 40%+ (industry: 25%)\n‚Ä¢ **SMS Click Rate**: 8%+ (industry: 5%)\n‚Ä¢ **Conversion Rate**: 15%+ (industry: 8%)\n\nüìà **Performance Optimization:**\n‚Ä¢ **A/B Testing**: Subject lines, send times, CTAs\n‚Ä¢ **Segmentation**: Target high-value customers\n‚Ä¢ **Personalization**: Use transaction history\n‚Ä¢ **Multi-Channel**: Coordinate across platforms\n\n**Quick Performance Check:**\n1. Dashboard ‚Üí **Analytics** ‚Üí **Overview**\n2. Filter by time period (last 30 days)\n3. Compare against benchmarks\n4. Identify improvement opportunities\n\nWould you like me to help you identify your top-performing campaigns or set performance improvement goals?`\n    };\n  }\n\n  private handleWorkflowQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**Smart Campaign Workflow Setup ${isNigerian ? '- Nigerian Market Optimized' : ''}:**\n\nüöÄ **Top-Performing Fintech Workflows:**\n\n**1. üåü Welcome Series (3-Touch)**\n‚Ä¢ **Day 0**: Welcome email + app download link\n‚Ä¢ **Day 1**: WhatsApp intro + first transaction bonus\n‚Ä¢ **Day 3**: SMS verification reminder + support number\n\n**2. üí≥ KYC Completion (Gentle Nudging)**\n‚Ä¢ **Trigger**: 24h after signup without verification\n‚Ä¢ **Email**: \"Complete in 2 minutes\" + video guide\n‚Ä¢ **WhatsApp**: Personal assistant message + direct link\n‚Ä¢ **SMS**: \"Your ‚Ç¶500 bonus is waiting\" urgency\n\n**3. üîÑ Transaction Encouragement**\n‚Ä¢ **Week 1**: \"Send ‚Ç¶100 to a friend\" + cashback\n‚Ä¢ **Week 2**: Bill payment demo + convenience pitch\n‚Ä¢ **Week 3**: Success stories from similar users\n\n${isNigerian ? `**4. üá≥üá¨ Nigeria-Specific Templates:**\n‚Ä¢ **Salary Advance**: Target payday (28th-30th)\n‚Ä¢ **School Fees**: Educational institution partnerships\n‚Ä¢ **Family Abroad**: Diaspora remittance flows\n‚Ä¢ **Business Banking**: SME-focused messaging\n\n` : ''}‚öôÔ∏è **Quick Setup (5 Minutes):**\n1. Dashboard ‚Üí **Workflows** ‚Üí **Create New**\n2. Choose: **\"Fintech Onboarding Nigeria\"** template\n3. Customize: Your brand colors + voice\n4. Test: Run with 10 test contacts first\n5. Deploy: Monitor performance daily\n\nüéØ **Success Metrics to Track:**\n‚Ä¢ **Email Open**: >25% (target: 35%)\n‚Ä¢ **WhatsApp Read**: >90% (target: 95%)\n‚Ä¢ **Completion Rate**: >60% (target: 75%)\n\nWhich workflow type interests you most? I can give step-by-step setup instructions.`\n    };\n  }\n\n  private handleEmailQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**Email Campaign Optimization ${isNigerian ? '- Nigerian Market' : ''} Strategy:**\n\nüìß **Immediate Impact Improvements:**\n\n**Subject Line Optimization:**\n‚Ä¢ ‚úÖ **Good**: \"Complete your transfer, Adebayo\"\n‚Ä¢ ‚ùå **Bad**: \"Action required on your account\"\n‚Ä¢ üéØ **Nigerian twist**: Use local names, add ‚Ç¶ symbols\n\n**Send Time Mastery:**\n‚Ä¢ **Best**: Tuesday 9:30 AM WAT (post-commute)\n‚Ä¢ **Alternative**: Thursday 3:00 PM (pre-weekend planning)\n‚Ä¢ **Avoid**: Friday 12-2 PM, Monday mornings\n\n**Mobile-First Design (90% open on mobile):**\n‚Ä¢ Single-column layout only\n‚Ä¢ Buttons 44px minimum (thumb-friendly)\n‚Ä¢ Load time <3 seconds on 3G\n\n${isNigerian ? `**üá≥üá¨ Nigeria-Specific Elements:**\n‚Ä¢ **Trust Indicators**: \"CBN Licensed\" in header\n‚Ä¢ **Local Context**: \"Beat bank queues\" messaging\n‚Ä¢ **Cultural Sensitivity**: Respect for religious periods\n‚Ä¢ **Network Awareness**: Image-light design for slow connections\n\n**Language Optimization:**\n‚Ä¢ Mix English with familiar terms\n‚Ä¢ \"Send money\" > \"Transfer funds\"  \n‚Ä¢ \"Top up\" > \"Fund account\"\n‚Ä¢ Include ‚Ç¶ symbol consistently\n\n` : ''}üìä **A/B Testing Roadmap:**\n**Week 1**: Subject lines (personal vs. benefit-focused)\n**Week 2**: Send times (morning vs. afternoon)\n**Week 3**: CTA buttons (color, text, placement)\n**Week 4**: Content length (short vs. detailed)\n\nüéØ **Performance Targets:**\n‚Ä¢ **Open Rate**: 28%+ (Nigerian fintech average: 22%)\n‚Ä¢ **Click Rate**: 4.5%+ (industry average: 2.8%)\n‚Ä¢ **Unsubscribe**: <0.3% (quality indicator)\n\n**Quick Win Setup:**\nEmail ‚Üí Templates ‚Üí \"Nigerian Fintech Optimized\" ‚Üí Customize\n\nWhat's your current open rate? I can provide specific recommendations based on your performance.`\n    };\n  }\n\n  private handleSegmentationQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**Advanced Customer Segmentation ${isNigerian ? '- Nigerian Market' : ''} Strategy:**\n\nüéØ **High-Value Behavioral Segments:**\n\n**üíé VIP Champions (Top 5%)**\n‚Ä¢ 10+ transactions/month, ‚Ç¶500K+ volume\n‚Ä¢ **Strategy**: Exclusive features, priority support\n‚Ä¢ **Messaging**: \"Your premium banking experience\"\n\n**üå± Growth Potential (25%)**  \n‚Ä¢ Active app users, 2-5 transactions/month\n‚Ä¢ **Strategy**: Transaction incentives, feature education\n‚Ä¢ **Messaging**: \"Unlock your financial potential\"\n\n**‚ö†Ô∏è At-Risk Champions (15%)**\n‚Ä¢ Previously high-value, now declining activity\n‚Ä¢ **Strategy**: Personal outreach, retention offers\n‚Ä¢ **Messaging**: \"We miss you\" + special benefits\n\n**üë∂ New Adopters (30%)**\n‚Ä¢ <30 days, learning platform features\n‚Ä¢ **Strategy**: Onboarding excellence, first transaction bonus\n‚Ä¢ **Messaging**: \"Welcome to easier banking\"\n\n${isNigerian ? `**üá≥üá¨ Nigeria-Specific Segments:**\n\n**üè¢ Lagos Business Hub**\n‚Ä¢ Corporate professionals, high transaction frequency\n‚Ä¢ **Best time**: 7-9 AM, 6-8 PM WAT\n‚Ä¢ **Messaging**: Efficiency, time-saving focus\n\n**üéì University Students**  \n‚Ä¢ 18-25 age group, moderate transactions\n‚Ä¢ **Strategy**: Student discounts, peer referrals\n‚Ä¢ **Messaging**: \"Smart money management\"\n\n**üåç Diaspora Connectors**\n‚Ä¢ Regular international transfers\n‚Ä¢ **Strategy**: Family-focused messaging, competitive rates\n‚Ä¢ **Messaging**: \"Keep families connected\"\n\n**üíº SME Owners**\n‚Ä¢ Business banking needs, payroll management\n‚Ä¢ **Strategy**: Business solutions, bulk features  \n‚Ä¢ **Messaging**: \"Grow your business banking\"\n\n` : ''}‚öôÔ∏è **Auto-Segmentation Setup:**\n1. **AI Intelligence** ‚Üí **Customer Intelligence**\n2. Enable **Behavioral Auto-Segmentation**\n3. Set **Segment Refresh**: Weekly\n4. Configure **Alert Triggers**: Movement between segments\n\nüìä **Segmentation Analytics:**\n‚Ä¢ **Segment Health**: Growth/decline tracking\n‚Ä¢ **Cross-Segment Movement**: Upgrade/downgrade patterns\n‚Ä¢ **Campaign Performance**: Response by segment\n‚Ä¢ **Revenue Attribution**: Segment value contribution\n\nüéØ **Targeting Strategy:**\n‚Ä¢ **VIPs**: WhatsApp personal touch\n‚Ä¢ **Growth**: Email education + SMS offers\n‚Ä¢ **At-Risk**: Multi-channel retention\n‚Ä¢ **New**: Progressive onboarding sequence\n\nWhich segment would you like to focus on first? I can create a specific campaign strategy.`\n    };\n  }\n\n  private handleWhatsAppQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**WhatsApp Marketing Mastery ${isNigerian ? '- Nigerian Market' : ''} Strategy:**\n\nüì± **WhatsApp Advantage (95% open rates!):**\n\n**Message Types That Convert:**\n‚Ä¢ **Personal Touch**: \"Hi Sarah, quick question about your transfer...\"\n‚Ä¢ **Visual Proof**: Screenshots of successful transactions\n‚Ä¢ **Voice Notes**: 3x higher engagement than text\n‚Ä¢ **Document Sharing**: Rate cards, guides, certificates\n\n${isNigerian ? `**üá≥üá¨ Nigeria-Specific Tactics:**\n‚Ä¢ **Language Mix**: English + Pidgin where appropriate\n‚Ä¢ **Cultural References**: \"How far?\" greetings work well\n‚Ä¢ **Trust Building**: Share CBN licensing documents\n‚Ä¢ **Network Awareness**: Keep media files <2MB\n\n**Peak Engagement Times (WAT):**\n‚Ä¢ **Morning**: 8:00-10:00 AM (commute browsing)\n‚Ä¢ **Lunch**: 12:30-1:30 PM (social media time)  \n‚Ä¢ **Evening**: 6:00-8:00 PM (highest engagement)\n‚Ä¢ **Weekend**: Sunday 7-9 PM (weekly planning)\n\n` : ''}üéØ **High-Converting Message Templates:**\n\n**1. Transaction Confirmation**\n\"‚úÖ Transfer completed! ‚Ç¶50,000 sent to Blessing. \nTransaction ID: TXN123456\nQuestions? Reply here üëÜ\"\n\n**2. Feature Introduction**  \n\"üí° New! Schedule transfers in advance\nPerfect for salary payments üìÖ\nTry it: [link] \nNeed help? I'm here!\"\n\n**3. Retention Message**\n\"Hi John üëã Haven't seen you in a while!\nYour account is safe and waiting.\nQuick balance check: [link]\"\n\n‚ö° **WhatsApp Business Features:**\n‚Ä¢ **Catalog**: Showcase services with images\n‚Ä¢ **Quick Replies**: Instant response templates\n‚Ä¢ **Labels**: Organize customers by behavior\n‚Ä¢ **Broadcast Lists**: Segment-specific messaging\n\nüìä **Optimization Tactics:**\n‚Ä¢ **Response Time**: <5 minutes during business hours\n‚Ä¢ **Emoji Usage**: 2-3 per message maximum\n‚Ä¢ **Call-to-Action**: One clear action per message\n‚Ä¢ **Follow-up**: 48-hour response window\n\nüîß **MarketSage WhatsApp Setup:**\n1. Dashboard ‚Üí **WhatsApp** ‚Üí **Business Integration**\n2. Import contacts with permission\n3. Create message templates\n4. Set auto-responses for common questions\n5. Enable **Smart Scheduling**\n\nWhich WhatsApp strategy would you like to implement first?`\n    };\n  }\n\n  private handleSMSQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**SMS Marketing Strategy ${isNigerian ? '- Nigerian Market Optimized' : ''}:**\n\nüì± **SMS Power (98% delivery rate, 90% read within 3 minutes!):**\n\n**Character Count Mastery:**\n‚Ä¢ **160 characters max** (avoid splitting fees)\n‚Ä¢ **Include brand name** (trust factor)\n‚Ä¢ **One clear CTA** (single focus)\n‚Ä¢ **Mobile-friendly links** (short URLs)\n\n${isNigerian ? `**üá≥üá¨ Nigeria-Specific Optimization:**\n‚Ä¢ **Network Reliability**: Works on any phone/network\n‚Ä¢ **Data Independence**: No internet required\n‚Ä¢ **Local Language**: Mix English with familiar terms\n‚Ä¢ **Timing**: Respect religious prayer times\n\n**Peak Performance Times (WAT):**\n‚Ä¢ **Weekdays**: 10 AM - 4 PM (business hours)\n‚Ä¢ **Avoid**: 12-2 PM Fridays (prayers)\n‚Ä¢ **Emergency**: Anytime for security alerts\n‚Ä¢ **Promotional**: 6-8 PM for offers\n\n` : ''}üéØ **High-Converting SMS Templates:**\n\n**1. Transaction Alert (Security)**\n\"MarketSage: ‚Ç¶25,000 sent to *John. \nBalance: ‚Ç¶50,000\nNot you? Call 0700-SECURE\"\n\n**2. Promotional Offer**\n\"Hi Sarah! Transfer ‚Ç¶5000+ today, \nget ‚Ç¶100 cashback. \nCode: SAVE100\nUse: bit.ly/ms-app\"\n\n**3. Account Security**\n\"Verify login from new device?\nYes: Reply Y\nNo: Reply N\nMarketSage Security\"\n\n**4. Feature Announcement**  \n\"NEW: Schedule transfers! \nSet salary payments to auto-send.\nTry: [short-link]\nQuestions? Reply HELP\"\n\nüìä **SMS Campaign Optimization:**\n‚Ä¢ **Sender ID**: Use \"MarketSage\" (trusted brand)\n‚Ä¢ **Timing**: Batch send over 30 minutes (avoid spam)\n‚Ä¢ **Frequency**: Max 2 promotional SMS/week\n‚Ä¢ **Personalization**: Include first name when possible\n\n‚ö° **Advanced SMS Tactics:**\n‚Ä¢ **Two-Way SMS**: Enable reply conversations\n‚Ä¢ **Drip Campaigns**: Scheduled sequence messaging\n‚Ä¢ **Trigger SMS**: Action-based automated sends\n‚Ä¢ **Link Tracking**: Monitor click-through rates\n\nüîß **MarketSage SMS Setup:**\n1. Dashboard ‚Üí **SMS** ‚Üí **Campaign Builder**\n2. Choose template or create custom\n3. Select audience segment\n4. Schedule or send immediately\n5. Track delivery + click rates\n\n**Success Metrics:**\n‚Ä¢ **Delivery Rate**: >95% (check carrier relationships)\n‚Ä¢ **Click Rate**: >8% (industry: 3-5%)\n‚Ä¢ **Response Rate**: >15% for two-way SMS\n\nWhich SMS campaign type would you like to start with?`\n    };\n  }\n\n  private handleIntegrationQuestions(question: string): OpenAIResponse {\n    return {\n      answer: `**MarketSage Integration & Setup Guide:**\n\nüîó **Popular Integration Categories:**\n\n**1. üìß Email Platforms**\n‚Ä¢ **Mailtrap** (Testing): Built-in sandbox environment\n‚Ä¢ **SendGrid** (Production): High deliverability\n‚Ä¢ **Mailgun** (Enterprise): Advanced analytics\n‚Ä¢ **SMTP** (Custom): Your email server\n\n**2. üí¨ Messaging Platforms**  \n‚Ä¢ **WhatsApp Business API**: Direct integration\n‚Ä¢ **Twilio** (SMS/WhatsApp): Multi-channel support\n‚Ä¢ **Infobip** (African focus): Local carrier relationships\n‚Ä¢ **Bulk SMS Nigeria**: Cost-effective local option\n\n**3. üí≥ Payment Gateways**\n‚Ä¢ **Paystack** (Nigeria): Local bank integration\n‚Ä¢ **Flutterwave** (Pan-African): Multi-country support  \n‚Ä¢ **Interswitch** (Enterprise): Corporate banking\n‚Ä¢ **Stripe** (International): Global payments\n\n**4. üìä Analytics & CRM**\n‚Ä¢ **Google Analytics**: Website behavior tracking\n‚Ä¢ **Segment**: Customer data platform\n‚Ä¢ **HubSpot**: CRM integration\n‚Ä¢ **Salesforce**: Enterprise CRM\n\n‚ö° **Quick Integration Steps:**\n1. **Dashboard** ‚Üí **Integrations** ‚Üí **Browse Categories**\n2. Select platform ‚Üí **Connect Account**\n3. Authenticate with API keys/OAuth\n4. Configure sync settings\n5. Test integration with sample data\n\nüîß **API Integration (Developers):**\n\\`\\`\\`bash\n# MarketSage API Base\nhttps://api.marketsage.com/v1/\n\n# Authentication\nBearer Token: your-api-key\n\n# Example: Create Contact\nPOST /contacts\n{\n  \"email\": \"user@example.com\",\n  \"name\": \"Customer Name\",\n  \"tags\": [\"integration\"]\n}\n\\`\\`\\`\n\nüö® **Common Integration Issues:**\n‚Ä¢ **API Rate Limits**: Space out bulk imports\n‚Ä¢ **Authentication**: Double-check API keys\n‚Ä¢ **Data Format**: Match required field types\n‚Ä¢ **Webhooks**: Verify endpoint accessibility\n\n**Need Help With Specific Integration?**\nTell me which platform you're trying to connect, and I'll provide detailed setup instructions!`\n    };\n  }\n\n  private handleMarketQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**${isNigerian ? 'Nigerian' : 'African'} Fintech Market Intelligence:**\n\nüìä **Market Trends & Opportunities:**\n\n${isNigerian ? `**üá≥üá¨ Nigeria Market Insights:**\n‚Ä¢ **Mobile Money**: 45% adoption rate (growing 25% YoY)\n‚Ä¢ **Digital Banking**: 60M+ active users\n‚Ä¢ **Remittances**: $20B+ annual inflows\n‚Ä¢ **SME Banking**: 40M underserved small businesses\n\n**Key Market Drivers:**\n‚Ä¢ **CBN Cashless Policy**: Accelerating digital adoption\n‚Ä¢ **Young Demographics**: 70% under 30 years old\n‚Ä¢ **Smartphone Growth**: 180M+ mobile connections\n‚Ä¢ **Internet Penetration**: 65% and rising\n\n` : ''}**üí° Market Opportunities:**\n‚Ä¢ **Rural Banking**: 60% population still underbanked\n‚Ä¢ **Cross-Border**: Diaspora remittance growth\n‚Ä¢ **SME Services**: Business banking solutions\n‚Ä¢ **Islamic Finance**: Sharia-compliant products\n\n**üèÜ Competitive Landscape:**\n‚Ä¢ **Leaders**: Opay, Palmpay, Kuda, Moniepoint\n‚Ä¢ **Differentiators**: Customer service, reliability, rates\n‚Ä¢ **White Space**: B2B payments, savings products\n‚Ä¢ **Challenges**: Customer acquisition costs, regulation\n\n**üìà Customer Behavior Insights:**\n‚Ä¢ **WhatsApp**: Preferred customer service channel\n‚Ä¢ **Trust Factors**: CBN licensing, security features\n‚Ä¢ **Transaction Patterns**: Evening peaks, payday spikes\n‚Ä¢ **Retention**: Personal relationships matter most\n\n**üéØ Marketing Strategy Recommendations:**\n‚Ä¢ **Channel Mix**: WhatsApp (40%) + Email (30%) + SMS (30%)\n‚Ä¢ **Messaging**: Security-first, convenience second\n‚Ä¢ **Timing**: Leverage salary cycles, festive periods\n‚Ä¢ **Localization**: Mix English with local languages\n\n**üîç Competitor Analysis:**\nWould you like me to analyze specific competitors or market segments for your positioning strategy?\n\n**Market Research Actions:**\n‚Ä¢ Set up competitor monitoring\n‚Ä¢ Track industry benchmarks  \n‚Ä¢ Monitor regulatory updates\n‚Ä¢ Analyze customer feedback trends\n\nWhich market aspect interests you most?`\n    };\n  }\n\n  private handleComplianceQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**${isNigerian ? 'Nigerian CBN' : 'African'} Fintech Compliance Guide:**\n\n${isNigerian ? `**üá≥üá¨ CBN Regulatory Requirements:**\n\n**1. üìã Mandatory Licenses:**\n‚Ä¢ **Payment Service License**: For money transfers\n‚Ä¢ **Mobile Money License**: For digital wallets  \n‚Ä¢ **Banking License**: For deposit-taking\n‚Ä¢ **Foreign Exchange License**: For currency conversion\n\n**2. üîí KYC/AML Compliance:**\n‚Ä¢ **Tier 1**: ‚Ç¶50K limit (name, phone, BVN)\n‚Ä¢ **Tier 2**: ‚Ç¶200K limit (+ address verification)\n‚Ä¢ **Tier 3**: ‚Ç¶5M limit (+ income verification)\n‚Ä¢ **Enhanced Due Diligence**: For high-risk customers\n\n**3. üìä Mandatory Reporting:**\n‚Ä¢ **CTR**: Cash transactions >‚Ç¶5M\n‚Ä¢ **STR**: Suspicious transaction reports\n‚Ä¢ **BSA**: Bank Secrecy Act compliance\n‚Ä¢ **FATF**: Financial Action Task Force guidelines\n\n` : ''}**üõ°Ô∏è Data Protection & Privacy:**\n‚Ä¢ **Customer Consent**: Explicit opt-in required\n‚Ä¢ **Data Minimization**: Collect only necessary data\n‚Ä¢ **Retention Limits**: Delete data after purpose served\n‚Ä¢ **Security Standards**: Encryption, access controls\n\n**üìù Marketing Compliance:**\n‚Ä¢ **SMS Opt-in**: Required before sending promotional messages\n‚Ä¢ **Email Consent**: Double opt-in recommended\n‚Ä¢ **WhatsApp**: Business API terms compliance\n‚Ä¢ **Unsubscribe**: Clear, easy opt-out mechanisms\n\n**‚ö° MarketSage Compliance Features:**\n‚Ä¢ **Built-in KYC Verification**: BVN integration\n‚Ä¢ **Consent Management**: Automated opt-in tracking\n‚Ä¢ **Data Retention**: Automatic cleanup schedules\n‚Ä¢ **Audit Trails**: Complete activity logging\n‚Ä¢ **Regulatory Reporting**: CBN-format exports\n\n**üö® Compliance Checklist:**\n‚úÖ **Customer Onboarding**: KYC verification process\n‚úÖ **Communication Consent**: Marketing permissions\n‚úÖ **Data Security**: Encryption + access controls  \n‚úÖ **Transaction Monitoring**: AML screening\n‚úÖ **Record Keeping**: 7-year retention policy\n‚úÖ **Staff Training**: Regular compliance updates\n\n**üìã Quick Compliance Setup:**\n1. Dashboard ‚Üí **Compliance** ‚Üí **Settings**\n2. Enable **Auto-KYC Verification**\n3. Configure **Consent Workflows**\n4. Set **Data Retention Rules**\n5. Schedule **Compliance Reports**\n\n**‚öñÔ∏è Legal Requirements:**\n‚Ä¢ **Terms of Service**: Clear, accessible language\n‚Ä¢ **Privacy Policy**: Data usage transparency\n‚Ä¢ **Cookie Policy**: Website tracking disclosure\n‚Ä¢ **Dispute Resolution**: Customer complaint process\n\nNeed help with specific compliance requirements? I can provide detailed implementation guidance.`\n    };\n  }\n\n  private handlePricingQuestions(question: string, isNigerian: boolean): OpenAIResponse {\n    return {\n      answer: `**MarketSage Pricing & Plans${isNigerian ? ' - Nigerian Market' : ''}:**\n\nüí∞ **Subscription Tiers:**\n\n**üöÄ Starter Plan**\n${isNigerian ? '‚Ä¢ **‚Ç¶25,000/month** (NGN)' : '‚Ä¢ **$50/month** (USD)'}\n‚Ä¢ 5,000 contacts\n‚Ä¢ 10,000 emails/month\n‚Ä¢ 2,000 SMS/month\n‚Ä¢ 1,000 WhatsApp messages/month\n‚Ä¢ Basic analytics\n‚Ä¢ Email support\n\n**üíº Professional Plan** \n${isNigerian ? '‚Ä¢ **‚Ç¶75,000/month** (NGN)' : '‚Ä¢ **$150/month** (USD)'}\n‚Ä¢ 25,000 contacts\n‚Ä¢ 50,000 emails/month\n‚Ä¢ 10,000 SMS/month\n‚Ä¢ 5,000 WhatsApp messages/month\n‚Ä¢ Advanced analytics + AI insights\n‚Ä¢ Workflow automation\n‚Ä¢ Priority support\n\n**üè¢ Enterprise Plan**\n${isNigerian ? '‚Ä¢ **‚Ç¶200,000/month** (NGN)' : '‚Ä¢ **$400/month** (USD)'}\n‚Ä¢ Unlimited contacts\n‚Ä¢ Unlimited emails\n‚Ä¢ 50,000 SMS/month\n‚Ä¢ 25,000 WhatsApp messages/month\n‚Ä¢ Custom integrations\n‚Ä¢ Dedicated account manager\n‚Ä¢ 24/7 phone support\n\n${isNigerian ? `**üá≥üá¨ Nigeria-Specific Benefits:**\n‚Ä¢ **Local Payment**: Pay in Naira via bank transfer\n‚Ä¢ **No FX Risk**: Fixed Naira pricing\n‚Ä¢ **CBN Compliance**: Built-in regulatory features\n‚Ä¢ **Local Support**: Nigeria-based customer success team\n‚Ä¢ **Startup Discount**: 50% off first 6 months for Nigerian startups\n\n` : ''}**üìä Usage-Based Pricing:**\n‚Ä¢ **Overage SMS**: ‚Ç¶5 per additional SMS\n‚Ä¢ **Overage WhatsApp**: ‚Ç¶15 per additional message\n‚Ä¢ **Premium Features**: AI insights, advanced segmentation\n‚Ä¢ **Custom Development**: ‚Ç¶50,000 setup + hourly rates\n\n**üí° Cost Optimization Tips:**\n‚Ä¢ **Annual Payment**: Save 20% with yearly billing\n‚Ä¢ **Efficient Segmentation**: Target only engaged users\n‚Ä¢ **A/B Testing**: Improve ROI before scaling\n‚Ä¢ **Multi-Channel**: Balance cost vs. engagement\n\n**üéÅ Special Offers:**\n‚Ä¢ **Free Trial**: 14 days, no credit card required\n‚Ä¢ **Migration Bonus**: Free setup from competing platforms\n‚Ä¢ **Referral Credits**: ‚Ç¶10,000 for successful referrals\n‚Ä¢ **NGO Discount**: 30% off for registered nonprofits\n\n**üí≥ Payment Methods:**\n${isNigerian ? `‚Ä¢ **Bank Transfer**: Direct to NGN account\n‚Ä¢ **Paystack**: Secure card payments\n‚Ä¢ **USSD**: *737# quick payments\n‚Ä¢ **Mobile Money**: Integration planned` : `‚Ä¢ **Credit/Debit Cards**: Visa, Mastercard\n‚Ä¢ **Bank Transfer**: ACH/Wire transfers\n‚Ä¢ **PayPal**: International payments\n‚Ä¢ **Crypto**: Bitcoin, Ethereum accepted`}\n\n**üîß Plan Comparison Tool:**\nDashboard ‚Üí **Billing** ‚Üí **Compare Plans** ‚Üí See feature matrix\n\n**üìû Custom Pricing:**\nFor enterprise needs >100K contacts, let's discuss custom pricing. \n\nWhat's your expected monthly contact volume? I can recommend the most cost-effective plan.`\n    };\n  }\n\n  private handleSupportQuestions(question: string): OpenAIResponse {\n    return {\n      answer: `**MarketSage Support & Troubleshooting:**\n\nüÜò **Get Help Fast:**\n\n**1. üìö Self-Service Resources**\n‚Ä¢ **Knowledge Base**: Dashboard ‚Üí Help ‚Üí Documentation\n‚Ä¢ **Video Tutorials**: Step-by-step walkthroughs\n‚Ä¢ **Community Forum**: User discussions + solutions\n‚Ä¢ **API Documentation**: Developer guides\n\n**2. üí¨ Direct Support Channels**\n‚Ä¢ **Live Chat**: Dashboard ‚Üí Support (9 AM - 6 PM WAT)\n‚Ä¢ **WhatsApp**: +234-xxx-xxxx (Premium+ plans)\n‚Ä¢ **Email**: support@marketsage.com (24h response)\n‚Ä¢ **Phone**: Enterprise plans (dedicated line)\n\n**3. üîß Common Issues & Solutions**\n\n**Email Delivery Problems:**\n‚Ä¢ Check SPF/DKIM records\n‚Ä¢ Verify sender domain\n‚Ä¢ Review content for spam triggers\n‚Ä¢ Check suppression lists\n\n**WhatsApp Not Working:**\n‚Ä¢ Confirm Business API setup\n‚Ä¢ Check phone number verification\n‚Ä¢ Verify template approval status\n‚Ä¢ Review message frequency limits\n\n**SMS Delivery Issues:**\n‚Ä¢ Validate phone number format\n‚Ä¢ Check SMS credits balance\n‚Ä¢ Verify sender ID approval\n‚Ä¢ Review carrier restrictions\n\n**Integration Errors:**\n‚Ä¢ Double-check API credentials\n‚Ä¢ Verify webhook endpoints\n‚Ä¢ Test connection status\n‚Ä¢ Review rate limit settings\n\n**4. üö® Emergency Support**\n‚Ä¢ **Security Issues**: Immediate escalation\n‚Ä¢ **System Downtime**: Status page + notifications\n‚Ä¢ **Payment Problems**: Billing team direct line\n‚Ä¢ **Data Loss**: Backup restoration process\n\n**5. üìä Support Performance**\n‚Ä¢ **Response Time**: <2 hours (business hours)\n‚Ä¢ **Resolution Time**: <24 hours (90% of cases)\n‚Ä¢ **Satisfaction Score**: 4.7/5 (customer rated)\n‚Ä¢ **Availability**: 99.9% uptime guarantee\n\n**6. üéì Training & Onboarding**\n‚Ä¢ **Free Onboarding**: 1-hour setup session\n‚Ä¢ **Team Training**: Advanced feature workshops\n‚Ä¢ **Best Practices**: Monthly webinars\n‚Ä¢ **Certification**: MarketSage expert program\n\n**Quick Troubleshooting Steps:**\n1. **Check System Status**: status.marketsage.com\n2. **Clear Browser Cache**: Hard refresh (Ctrl+F5)\n3. **Test in Incognito**: Rule out browser issues\n4. **Check Internet**: Stable connection required\n5. **Try Different Browser**: Chrome recommended\n\n**üì± Mobile App Support:**\n‚Ä¢ **iOS**: App Store support\n‚Ä¢ **Android**: Google Play troubleshooting\n‚Ä¢ **Updates**: Auto-update enabled recommended\n‚Ä¢ **Offline Mode**: Limited functionality available\n\n**üí° Pro Tips:**\n‚Ä¢ Include screenshots with support requests\n‚Ä¢ Mention your plan type for faster routing\n‚Ä¢ Check documentation first for instant answers\n‚Ä¢ Use specific error messages in tickets\n\nWhat specific issue are you experiencing? I can provide targeted troubleshooting steps!`\n    };\n  }\n\n  private generateSmartFallback(question: string, context?: string, isNigerian?: boolean): OpenAIResponse {\n    const questionKeywords = question.toLowerCase().split(' ').filter(word => word.length > 3);\n    const relevantAreas = this.identifyRelevantAreas(questionKeywords);\n    \n    return {\n      answer: `I'm Supreme-AI, your MarketSage assistant! ${isNigerian ? 'üá≥üá¨ ' : ''}\n\nBased on your question about **\"${question}\"**, I can help you with:\n\n${relevantAreas.map(area => `üîß **${area.title}** - ${area.description}`).join('\\n')}\n\n**To give you the most relevant advice, tell me:**\n‚Ä¢ What specific challenge are you facing?\n‚Ä¢ Which MarketSage feature are you working with?\n‚Ä¢ What's your main goal right now?\n\n**I specialize in:**\n‚ö° Nigerian fintech marketing strategies\nüì± WhatsApp, Email & SMS optimization  \nüéØ Customer segmentation & retention\nüöÄ Workflow automation setup\nüìä Performance analytics & insights\n\n**Quick Access:**\n‚Ä¢ **Urgent Help**: Type \"support\" for immediate assistance\n‚Ä¢ **Getting Started**: Type \"setup\" for onboarding guide\n‚Ä¢ **Best Practices**: Type \"optimize\" for improvement tips\n\n${isNigerian ? 'As a Nigeria-focused AI, I understand local market dynamics, CBN regulations, and customer preferences. ' : ''}\n\nWhat would you like to tackle first?`\n    };\n  }\n\n  private identifyRelevantAreas(keywords: string[]): Array<{title: string, description: string}> {\n    const areas = [\n      { keywords: ['email', 'campaign', 'subject'], title: 'Email Marketing', description: 'Optimize open rates and engagement' },\n      { keywords: ['whatsapp', 'message', 'chat'], title: 'WhatsApp Strategy', description: 'Leverage 95% open rates effectively' },\n      { keywords: ['sms', 'text', 'mobile'], title: 'SMS Campaigns', description: 'Reliable messaging that works everywhere' },\n      { keywords: ['customer', 'segment', 'audience'], title: 'Customer Intelligence', description: 'Smart segmentation and targeting' },\n      { keywords: ['workflow', 'automation', 'sequence'], title: 'Marketing Automation', description: 'Set up conversion workflows' },\n      { keywords: ['analytics', 'performance', 'metrics'], title: 'Performance Analytics', description: 'Track and optimize campaign results' },\n      { keywords: ['churn', 'retention', 'lost'], title: 'Customer Retention', description: 'Prevent churn and increase loyalty' },\n      { keywords: ['conversion', 'optimize', 'improve'], title: 'Conversion Optimization', description: 'Increase sales and engagement' }\n    ];\n\n    return areas.filter(area => \n      area.keywords.some(keyword => keywords.includes(keyword))\n    ).slice(0, 3);\n  }\n}\n\n// LocalAI integration removed - using OpenAI only\n\n// Export the appropriate AI instance based on configuration\nexport const getAIInstance = () => {\n  // PRIORITY 1: Check for OpenAI-only mode\n  if (process.env.USE_OPENAI_ONLY === 'true') {\n    if (process.env.OPENAI_API_KEY) {\n      console.log('üåê Using OpenAI (OpenAI-only mode enabled)');\n      return new OpenAIIntegration();\n    } else {\n      console.error('‚ùå OpenAI-only mode enabled but no API key found!');\n      throw new Error('OpenAI API key required when USE_OPENAI_ONLY=true');\n    }\n  }\n\n  // PRIORITY 2: Check for Supreme-AI disabled mode\n  if (process.env.SUPREME_AI_MODE === 'disabled') {\n    if (process.env.OPENAI_API_KEY) {\n      console.log('üåê Using OpenAI (Supreme-AI disabled)');\n      return new OpenAIIntegration();\n    } else {\n      console.log('üîß Using Fallback AI (Supreme-AI disabled, no OpenAI key)');\n      return new FallbackAI();\n    }\n  }\n\n  // PRIORITY 3: Check explicit AI_PROVIDER setting\n  const aiProvider = process.env.AI_PROVIDER?.toLowerCase() || 'auto';\n  \n  switch (aiProvider) {\n    case 'openai':\n      if (process.env.OPENAI_API_KEY) {\n        console.log('üåê Using OpenAI for AI processing');\n        return new OpenAIIntegration();\n      } else {\n        console.warn('OpenAI provider selected but no API key found, falling back to FallbackAI');\n        return new FallbackAI();\n      }\n    \n    case 'fallback':\n      console.log('üîß Using Fallback AI for AI processing');\n      return new FallbackAI();\n    \n    default: // 'auto' - intelligent selection (OpenAI first, then fallback)\n      if (process.env.OPENAI_API_KEY) {\n        console.log('üåê Auto-selected OpenAI for AI processing');\n        return new OpenAIIntegration();\n      } else {\n        console.log('üîß Auto-selected Fallback AI for AI processing');\n        return new FallbackAI();\n      }\n  }\n}; "],"names":["FallbackAI","OpenAIIntegration","getAIInstance","constructor","apiKey","process","env","OPENAI_API_KEY","baseURL","console","error","generateResponse","userMessage","context","conversationHistory","options","answer","messages","role","content","buildSystemPrompt","response","fetch","method","headers","body","JSON","stringify","model","temperature","max_tokens","maxTokens","presence_penalty","frequency_penalty","ok","Error","status","statusText","data","json","choices","message","usage","analyzeIntent","text","analysis","parse","intent","confidence","entities","generateCreativeSolutions","problem","constraints","join","split","filter","line","trim","evaluateApproach","approach","criteria","evaluation","score","feedback","handleConversionQuestions","question","isNigerian","handlePerformanceQuestions","lowerQuestion","toLowerCase","detectNigerianContext","urgencyLevel","detectUrgency","isTimingQuestion","handleTimingQuestions","isChurnQuestion","handleChurnQuestions","isConversionQuestion","isPerformanceQuestion","isWorkflowQuestion","handleWorkflowQuestions","isEmailQuestion","handleEmailQuestions","isSegmentationQuestion","handleSegmentationQuestions","isWhatsAppQuestion","handleWhatsAppQuestions","isSMSQuestion","handleSMSQuestions","isIntegrationQuestion","handleIntegrationQuestions","isMarketQuestion","handleMarketQuestions","isComplianceQuestion","handleComplianceQuestions","isPricingQuestion","handlePricingQuestions","isSupportQuestion","handleSupportQuestions","generateSmartFallback","nigerianIndicators","some","indicator","includes","urgentKeywords","mediumKeywords","keyword","urgency","questionKeywords","word","length","relevantAreas","identifyRelevantAreas","map","area","title","description","keywords","areas","slice","USE_OPENAI_ONLY","log","SUPREME_AI_MODE","aiProvider","AI_PROVIDER","warn"],"mappings":"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"}