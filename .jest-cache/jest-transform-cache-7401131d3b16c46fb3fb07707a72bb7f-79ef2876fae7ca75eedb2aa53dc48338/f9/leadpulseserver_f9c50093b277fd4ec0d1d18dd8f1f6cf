453bf7a8be0772262190c5a9732f0b4e
/**
 * LeadPulse MCP Server for MarketSage
 * 
 * This server provides read-only access to visitor intelligence data,
 * behavioral analytics, and conversion tracking through the MCP protocol.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "LeadPulseMCPServer", {
    enumerable: true,
    get: function() {
        return LeadPulseMCPServer;
    }
});
const _httpbasemcpserver = require("./http-base-mcp-server");
const _mcptypes = require("../types/mcp-types");
const _prisma = require("../../lib/db/prisma");
const _mcpconfig = require("../config/mcp-config");
class LeadPulseMCPServer extends _httpbasemcpserver.HTTPBaseMCPServer {
    constructor(config){
        super({
            ..._mcpconfig.defaultMCPConfig.servers.leadpulse,
            ...config
        });
    }
    /**
   * List available LeadPulse resources
   */ async listResources(authContext) {
        const resources = [
            {
                uri: "leadpulse://visitors",
                name: "Visitor Data",
                description: "Access to visitor sessions and behavioral data",
                mimeType: "application/json"
            },
            {
                uri: "leadpulse://sessions",
                name: "Session Data",
                description: "Access to detailed visitor session information",
                mimeType: "application/json"
            },
            {
                uri: "leadpulse://heatmaps",
                name: "Heatmap Data",
                description: "Access to page heatmap and interaction data",
                mimeType: "application/json"
            },
            {
                uri: "leadpulse://journeys",
                name: "Customer Journeys",
                description: "Access to customer journey and conversion paths",
                mimeType: "application/json"
            },
            {
                uri: "leadpulse://conversions",
                name: "Conversion Data",
                description: "Access to conversion events and funnel analytics",
                mimeType: "application/json"
            },
            {
                uri: "leadpulse://analytics",
                name: "Behavioral Analytics",
                description: "Access to visitor behavior analytics and insights",
                mimeType: "application/json"
            }
        ];
        // Filter resources based on permissions
        if (!authContext.permissions.includes('*') && !authContext.permissions.includes('read:org')) {
            // Users can only access basic visitor data
            return resources.filter((r)=>r.uri.includes('visitors') || r.uri.includes('sessions'));
        }
        return resources;
    }
    /**
   * Read LeadPulse resource
   */ async readResource(uri, authContext) {
        const url = new URL(uri);
        const path = url.pathname;
        const searchParams = url.searchParams;
        // Parse query parameters
        const queryParams = Object.fromEntries(searchParams.entries());
        const validatedQuery = _mcptypes.LeadPulseQuerySchema.parse({
            ...queryParams,
            organizationId: authContext.organizationId,
            limit: queryParams.limit ? Number.parseInt(queryParams.limit) : 10,
            offset: queryParams.offset ? Number.parseInt(queryParams.offset) : 0,
            includeHeatmap: queryParams.includeHeatmap === 'true',
            includeJourney: queryParams.includeJourney === 'true'
        });
        switch(path){
            case '/visitors':
                return await this.getVisitorData(validatedQuery, authContext);
            case '/sessions':
                return await this.getSessionData(validatedQuery, authContext);
            case '/heatmaps':
                return await this.getHeatmapData(validatedQuery, authContext);
            case '/journeys':
                return await this.getJourneyData(validatedQuery, authContext);
            case '/conversions':
                return await this.getConversionData(validatedQuery, authContext);
            case '/analytics':
                return await this.getAnalyticsData(validatedQuery, authContext);
            default:
                throw new _mcptypes.MCPValidationError(`Unknown resource path: ${path}`);
        }
    }
    /**
   * List available LeadPulse tools
   */ async listTools(authContext) {
        const tools = [
            {
                name: "track_visitor",
                description: "Get visitor tracking information and behavior",
                inputSchema: {
                    type: "object",
                    properties: {
                        visitorId: {
                            type: "string",
                            description: "Visitor ID to track"
                        },
                        includeJourney: {
                            type: "boolean",
                            description: "Include customer journey data",
                            default: true
                        },
                        includeHeatmap: {
                            type: "boolean",
                            description: "Include heatmap interaction data",
                            default: false
                        }
                    },
                    required: [
                        "visitorId"
                    ]
                }
            },
            {
                name: "analyze_visitor_behavior",
                description: "Analyze visitor behavior patterns and generate insights",
                inputSchema: {
                    type: "object",
                    properties: {
                        visitorId: {
                            type: "string",
                            description: "Visitor ID to analyze"
                        },
                        sessionId: {
                            type: "string",
                            description: "Specific session ID (optional)"
                        },
                        timeRange: {
                            type: "string",
                            enum: [
                                "1h",
                                "1d",
                                "7d",
                                "30d"
                            ],
                            description: "Time range for analysis",
                            default: "7d"
                        }
                    },
                    required: [
                        "visitorId"
                    ]
                }
            },
            {
                name: "get_conversion_funnel",
                description: "Get conversion funnel data and drop-off points",
                inputSchema: {
                    type: "object",
                    properties: {
                        funnelId: {
                            type: "string",
                            description: "Funnel ID (optional for default funnel)"
                        },
                        dateRange: {
                            type: "string",
                            enum: [
                                "7d",
                                "30d",
                                "90d"
                            ],
                            description: "Date range for funnel analysis",
                            default: "30d"
                        },
                        includeSegments: {
                            type: "boolean",
                            description: "Include segment-based funnel analysis",
                            default: false
                        }
                    }
                }
            },
            {
                name: "get_page_analytics",
                description: "Get page-level analytics and performance metrics",
                inputSchema: {
                    type: "object",
                    properties: {
                        pageUrl: {
                            type: "string",
                            description: "Page URL to analyze"
                        },
                        includeHeatmap: {
                            type: "boolean",
                            description: "Include heatmap data",
                            default: true
                        },
                        dateRange: {
                            type: "string",
                            enum: [
                                "1d",
                                "7d",
                                "30d"
                            ],
                            description: "Date range for analysis",
                            default: "7d"
                        }
                    },
                    required: [
                        "pageUrl"
                    ]
                }
            },
            {
                name: "get_real_time_visitors",
                description: "Get current active visitors and their activities",
                inputSchema: {
                    type: "object",
                    properties: {
                        includeLocation: {
                            type: "boolean",
                            description: "Include geographic location data",
                            default: true
                        },
                        includeDevice: {
                            type: "boolean",
                            description: "Include device and browser information",
                            default: true
                        }
                    }
                }
            },
            {
                name: "identify_high_intent_visitors",
                description: "Identify visitors with high purchase/conversion intent",
                inputSchema: {
                    type: "object",
                    properties: {
                        threshold: {
                            type: "number",
                            description: "Intent score threshold (0-100)",
                            minimum: 0,
                            maximum: 100,
                            default: 70
                        },
                        limit: {
                            type: "number",
                            description: "Maximum number of visitors to return",
                            minimum: 1,
                            maximum: 100,
                            default: 20
                        }
                    }
                }
            }
        ];
        // Filter tools based on permissions
        if (!authContext.permissions.includes('*') && !authContext.permissions.includes('read:org')) {
            // Regular users get limited tools
            return tools.filter((t)=>[
                    'track_visitor',
                    'analyze_visitor_behavior',
                    'get_real_time_visitors'
                ].includes(t.name));
        }
        return tools;
    }
    /**
   * Execute LeadPulse tools
   */ async callTool(name, args, authContext) {
        switch(name){
            case 'track_visitor':
                return await this.trackVisitor(args, authContext);
            case 'analyze_visitor_behavior':
                return await this.analyzeVisitorBehavior(args, authContext);
            case 'get_conversion_funnel':
                return await this.getConversionFunnel(args, authContext);
            case 'get_page_analytics':
                return await this.getPageAnalytics(args, authContext);
            case 'get_real_time_visitors':
                return await this.getRealTimeVisitors(args, authContext);
            case 'identify_high_intent_visitors':
                return await this.identifyHighIntentVisitors(args, authContext);
            default:
                throw new _mcptypes.MCPValidationError(`Unknown tool: ${name}`);
        }
    }
    /**
   * Get visitor data with real MCPVisitorSessions queries
   */ async getVisitorData(query, authContext) {
        try {
            const startTime = Date.now();
            // Build where clause for visitor sessions
            const whereClause = {
                organizationId: authContext.organizationId
            };
            if (query.visitorId) {
                whereClause.visitorId = query.visitorId;
            }
            if (query.dateFrom || query.dateTo) {
                whereClause.sessionStart = {};
                if (query.dateFrom) {
                    whereClause.sessionStart.gte = new Date(query.dateFrom);
                }
                if (query.dateTo) {
                    whereClause.sessionStart.lte = new Date(query.dateTo);
                }
            }
            // Get real visitor sessions from MCP table
            const visitorSessions = await _prisma.prisma.mCPVisitorSessions.findMany({
                where: whereClause,
                take: query.limit,
                skip: query.offset,
                include: {
                    organization: {
                        select: {
                            id: true,
                            name: true
                        }
                    }
                },
                orderBy: {
                    sessionStart: 'desc'
                }
            });
            // Transform sessions to visitor format
            const visitors = visitorSessions.map((session)=>({
                    id: session.visitorId,
                    sessionId: session.sessionId,
                    organizationId: session.organizationId,
                    startTime: session.sessionStart.toISOString(),
                    endTime: session.sessionEnd.toISOString(),
                    pageViews: session.pageViews,
                    duration: session.duration,
                    bounce: session.bounceRate > 0.5,
                    converted: session.conversionValue > 0,
                    intentScore: session.intentScore,
                    geoLocation: {
                        country: session.country,
                        city: session.city,
                        region: session.region
                    },
                    device: {
                        type: session.deviceType,
                        browser: session.browser,
                        os: session.operatingSystem
                    },
                    traffic: {
                        source: session.source,
                        medium: session.medium,
                        campaign: session.campaign,
                        referrer: session.referrer
                    },
                    engagement: {
                        scrollDepth: session.scrollDepth,
                        timeOnPage: session.avgTimeOnPage,
                        interactions: session.interactions,
                        exitPage: session.exitPage
                    },
                    insights: session.insights ? JSON.parse(session.insights) : []
                }));
            // Calculate summary statistics
            const totalSessions = visitors.length;
            const totalPageViews = visitors.reduce((sum, v)=>sum + v.pageViews, 0);
            const avgDuration = totalSessions > 0 ? visitors.reduce((sum, v)=>sum + v.duration, 0) / totalSessions : 0;
            const bounceRate = totalSessions > 0 ? visitors.filter((v)=>v.bounce).length / totalSessions : 0;
            const conversionRate = totalSessions > 0 ? visitors.filter((v)=>v.converted).length / totalSessions : 0;
            const avgIntentScore = totalSessions > 0 ? visitors.reduce((sum, v)=>sum + v.intentScore, 0) / totalSessions : 0;
            // Device and location distribution
            const deviceDistribution = visitors.reduce((acc, v)=>{
                acc[v.device.type] = (acc[v.device.type] || 0) + 1;
                return acc;
            }, {});
            const countryDistribution = visitors.reduce((acc, v)=>{
                acc[v.geoLocation.country] = (acc[v.geoLocation.country] || 0) + 1;
                return acc;
            }, {});
            const duration = Date.now() - startTime;
            // Log resource access
            await this.logMCPResourceAccess(authContext, 'leadpulse://visitors', 'LIST', 'success', {
                duration,
                dataSize: visitors.length
            });
            return {
                uri: "leadpulse://visitors",
                mimeType: "application/json",
                text: JSON.stringify({
                    visitors,
                    summary: {
                        totalSessions,
                        totalPageViews,
                        averageDuration: Math.round(avgDuration),
                        bounceRate: Math.round(bounceRate * 100 * 100) / 100,
                        conversionRate: Math.round(conversionRate * 100 * 100) / 100,
                        avgIntentScore: Math.round(avgIntentScore * 100) / 100,
                        deviceDistribution,
                        countryDistribution
                    },
                    meta: {
                        query: {
                            limit: query.limit,
                            offset: query.offset,
                            organizationId: authContext.organizationId
                        },
                        total: visitors.length,
                        timestamp: new Date().toISOString(),
                        duration,
                        source: 'MCP_VISITOR_SESSIONS'
                    }
                })
            };
        } catch (error) {
            // Log failed access
            await this.logMCPResourceAccess(authContext, 'leadpulse://visitors', 'LIST', 'failure', {
                errorMessage: error instanceof Error ? error.message : 'Unknown error'
            });
            return await this.createFallbackResponse(()=>this.getVisitorDataFallback(query, authContext), 'Failed to retrieve visitor data via MCP');
        }
    }
    /**
   * Track visitor tool with real data
   */ async trackVisitor(args, authContext) {
        const { visitorId, includeJourney = true, includeHeatmap = false } = args;
        const startTime = Date.now();
        try {
            // Log tool execution
            await this.logMCPToolExecution(authContext, 'track_visitor', args, 'success', {
                duration: 0,
                riskLevel: 'low'
            });
            // Get visitor sessions from MCP table
            const visitorSessions = await _prisma.prisma.mCPVisitorSessions.findMany({
                where: {
                    visitorId,
                    organizationId: authContext.organizationId
                },
                include: {
                    organization: {
                        select: {
                            id: true,
                            name: true
                        }
                    }
                },
                orderBy: {
                    sessionStart: 'desc'
                },
                take: 10 // Last 10 sessions for analysis
            });
            if (visitorSessions.length === 0) {
                const duration = Date.now() - startTime;
                await this.logMCPToolExecution(authContext, 'track_visitor', args, 'failure', {
                    duration,
                    errorMessage: 'Visitor not found',
                    riskLevel: 'low'
                });
                return {
                    content: [
                        {
                            type: "text",
                            text: JSON.stringify({
                                success: false,
                                error: "Visitor not found",
                                visitorId
                            })
                        }
                    ],
                    isError: true
                };
            }
            // Get current (most recent) session
            const currentSession = visitorSessions[0];
            // Calculate visitor profile from all sessions
            const totalSessions = visitorSessions.length;
            const totalPageViews = visitorSessions.reduce((sum, s)=>sum + s.pageViews, 0);
            const avgSessionDuration = visitorSessions.reduce((sum, s)=>sum + s.duration, 0) / totalSessions;
            const totalConversions = visitorSessions.filter((s)=>s.conversionValue > 0).length;
            const avgIntentScore = visitorSessions.reduce((sum, s)=>sum + s.intentScore, 0) / totalSessions;
            // Determine if returning visitor
            const isReturning = totalSessions > 1;
            const firstSessionDate = visitorSessions[visitorSessions.length - 1].sessionStart;
            const lastSessionDate = visitorSessions[0].sessionStart;
            // Build visitor profile
            const visitorData = {
                id: visitorId,
                currentSession: {
                    sessionId: currentSession.sessionId,
                    startTime: currentSession.sessionStart.toISOString(),
                    endTime: currentSession.sessionEnd.toISOString(),
                    currentPage: currentSession.exitPage || currentSession.landingPage,
                    pageViews: currentSession.pageViews,
                    duration: currentSession.duration,
                    interactions: currentSession.interactions,
                    intentScore: currentSession.intentScore,
                    scrollDepth: currentSession.scrollDepth,
                    bounced: currentSession.bounceRate > 0.5,
                    converted: currentSession.conversionValue > 0,
                    conversionValue: currentSession.conversionValue
                },
                profile: {
                    isReturning,
                    totalSessions,
                    totalPageViews,
                    totalConversions,
                    averageSessionDuration: Math.round(avgSessionDuration),
                    averageIntentScore: Math.round(avgIntentScore * 100) / 100,
                    firstSeen: firstSessionDate.toISOString(),
                    lastSeen: lastSessionDate.toISOString(),
                    daysSinceFirstVisit: Math.floor((Date.now() - firstSessionDate.getTime()) / (1000 * 60 * 60 * 24))
                },
                geoLocation: {
                    country: currentSession.country,
                    city: currentSession.city,
                    region: currentSession.region,
                    timezone: this.getTimezoneFromCountry(currentSession.country)
                },
                device: {
                    type: currentSession.deviceType,
                    browser: currentSession.browser,
                    os: currentSession.operatingSystem
                },
                trafficSource: {
                    source: currentSession.source,
                    medium: currentSession.medium,
                    campaign: currentSession.campaign,
                    referrer: currentSession.referrer
                },
                behavioral: {
                    avgTimeOnPage: currentSession.avgTimeOnPage,
                    bounceRate: this.calculateVisitorBounceRate(visitorSessions),
                    conversionRate: totalConversions / totalSessions * 100,
                    engagementScore: this.calculateEngagementScore(visitorSessions)
                }
            };
            // Add journey data if requested
            if (includeJourney) {
                visitorData.journey = this.buildVisitorJourney(visitorSessions);
            }
            // Add insights
            visitorData.insights = this.generateVisitorInsights(visitorData, visitorSessions);
            const duration = Date.now() - startTime;
            // Log successful tool execution
            await this.logMCPToolExecution(authContext, 'track_visitor', args, 'success', {
                duration,
                outputSize: 1,
                riskLevel: includeJourney ? 'medium' : 'low'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: visitorData,
                            meta: {
                                includeJourney,
                                includeHeatmap,
                                timestamp: new Date().toISOString(),
                                duration,
                                source: 'MCP_VISITOR_SESSIONS'
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            const duration = Date.now() - startTime;
            // Log failed tool execution
            await this.logMCPToolExecution(authContext, 'track_visitor', args, 'failure', {
                duration,
                errorMessage: error instanceof Error ? error.message : 'Unknown error',
                riskLevel: 'medium'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to track visitor",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Analyze visitor behavior tool
   */ async analyzeVisitorBehavior(args, authContext) {
        const { visitorId, sessionId, timeRange = '7d' } = args;
        try {
            // Placeholder behavior analysis
            const behaviorAnalysis = {
                visitorId,
                sessionId,
                timeRange,
                behaviorPattern: {
                    pageViewsPerSession: 6.5,
                    averageSessionDuration: 420,
                    bounceRate: 0.15,
                    conversionRate: 0.08,
                    engagementScore: 78
                },
                interests: [
                    {
                        category: 'Premium Services',
                        score: 92
                    },
                    {
                        category: 'Analytics',
                        score: 78
                    },
                    {
                        category: 'Automation',
                        score: 65
                    }
                ],
                actions: {
                    totalClicks: 45,
                    formSubmissions: 2,
                    downloadRequests: 1,
                    socialShares: 0
                },
                predictions: {
                    likelihoodToConvert: 0.74,
                    timeToConversion: '2-3 days',
                    preferredChannel: 'email',
                    nextBestAction: 'Send targeted premium service offer'
                },
                insights: [
                    "Visitor shows high engagement with premium content",
                    "Multiple return sessions indicate strong interest",
                    "Behavior pattern suggests readiness to purchase",
                    "Recommended: Send personalized offer within 24 hours"
                ]
            };
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: behaviorAnalysis,
                            meta: {
                                timeRange,
                                analysisType: 'behavioral',
                                timestamp: new Date().toISOString(),
                                fallbackUsed: true
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to analyze visitor behavior",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Get conversion funnel tool
   */ async getConversionFunnel(args, authContext) {
        const { funnelId, dateRange = '30d', includeSegments = false } = args;
        const startTime = Date.now();
        try {
            // Calculate date range
            const daysBack = this.parseDateRange(dateRange);
            const startDate = new Date(Date.now() - daysBack * 24 * 60 * 60 * 1000);
            // Get visitor sessions data for funnel analysis
            const sessions = await _prisma.prisma.mCPVisitorSessions.findMany({
                where: {
                    organizationId: authContext.organizationId,
                    sessionStart: {
                        gte: startDate
                    }
                },
                orderBy: {
                    sessionStart: 'asc'
                }
            });
            // Define funnel steps based on common customer journey
            const funnelSteps = [
                {
                    name: 'Landing Page Visit',
                    pagePattern: '/'
                },
                {
                    name: 'Product/Service View',
                    pagePattern: '/features|/products|/services'
                },
                {
                    name: 'Pricing Page View',
                    pagePattern: '/pricing'
                },
                {
                    name: 'Contact/Demo Request',
                    pagePattern: '/contact|/demo|/signup'
                },
                {
                    name: 'Conversion',
                    conversionRequired: true
                }
            ];
            // Analyze visitor progression through funnel
            const funnelData = this.analyzeFunnelProgression(sessions, funnelSteps);
            // Add segment analysis if requested
            let segmentData = undefined;
            if (includeSegments) {
                segmentData = await this.analyzeFunnelBySegments(sessions, funnelSteps, authContext);
            }
            // Generate insights based on real data
            const insights = this.generateFunnelInsights(funnelData.steps, segmentData);
            const duration = Date.now() - startTime;
            // Log tool execution
            await this.logMCPToolExecution(authContext, 'get_conversion_funnel', args, 'success', {
                duration,
                outputSize: funnelData.steps.length,
                riskLevel: 'low'
            });
            const result = {
                funnelId: funnelId || 'organization-funnel',
                dateRange,
                totalSessions: sessions.length,
                timeframe: {
                    startDate: startDate.toISOString(),
                    endDate: new Date().toISOString(),
                    daysAnalyzed: daysBack
                },
                steps: funnelData.steps,
                overallConversion: funnelData.overallConversion,
                totalRevenue: funnelData.totalRevenue,
                averageOrderValue: funnelData.averageOrderValue,
                segments: segmentData,
                insights,
                performance: {
                    bestPerformingStep: funnelData.bestStep,
                    worstPerformingStep: funnelData.worstStep,
                    biggestDropOff: funnelData.biggestDropOff
                }
            };
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: result,
                            meta: {
                                dateRange,
                                includeSegments,
                                timestamp: new Date().toISOString(),
                                duration,
                                source: 'MCP_VISITOR_SESSIONS'
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to get conversion funnel",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Get page analytics tool
   */ async getPageAnalytics(args, authContext) {
        const { pageUrl, includeHeatmap = true, dateRange = '7d' } = args;
        try {
            // Placeholder page analytics
            const pageAnalytics = {
                pageUrl,
                dateRange,
                metrics: {
                    pageViews: 2500,
                    uniqueVisitors: 1800,
                    averageTimeOnPage: 180,
                    bounceRate: 0.35,
                    exitRate: 0.42,
                    scrollDepth: 0.68,
                    clickThroughRate: 0.15
                },
                heatmapData: includeHeatmap ? {
                    clickMap: {
                        headerNav: 45,
                        primaryCTA: 120,
                        secondaryCTA: 67,
                        footer: 23
                    },
                    scrollMap: {
                        '0-25%': 100,
                        '25-50%': 85,
                        '50-75%': 68,
                        '75-100%': 42
                    },
                    attentionMap: {
                        hero: 8.5,
                        features: 6.2,
                        pricing: 7.8,
                        testimonials: 4.1
                    }
                } : undefined,
                insights: [
                    "Primary CTA has good engagement (120 clicks)",
                    "Users tend to drop off at 50% scroll depth",
                    "Pricing section gets high attention (7.8 seconds average)",
                    "Consider moving testimonials higher up the page"
                ]
            };
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: pageAnalytics,
                            meta: {
                                pageUrl,
                                dateRange,
                                includeHeatmap,
                                timestamp: new Date().toISOString(),
                                fallbackUsed: true
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to get page analytics",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Get real-time visitors tool with actual visitor session data
   */ async getRealTimeVisitors(args, authContext) {
        const { includeLocation = true, includeDevice = true } = args;
        const startTime = Date.now();
        try {
            // Log tool execution
            await this.logMCPToolExecution(authContext, 'get_real_time_visitors', args, 'success', {
                duration: 0,
                riskLevel: 'low'
            });
            // Define "real-time" as sessions that are still active (within last 30 minutes)
            const thirtyMinutesAgo = new Date(Date.now() - 30 * 60 * 1000);
            const now = new Date();
            // Get currently active visitor sessions
            const activeSessions = await _prisma.prisma.mCPVisitorSessions.findMany({
                where: {
                    organizationId: authContext.organizationId,
                    sessionStart: {
                        gte: thirtyMinutesAgo
                    },
                    sessionEnd: {
                        gte: thirtyMinutesAgo // Sessions that ended recently or are still ongoing
                    }
                },
                include: {
                    organization: {
                        select: {
                            id: true,
                            name: true
                        }
                    }
                },
                orderBy: {
                    sessionStart: 'desc'
                },
                take: 50 // Limit for performance
            });
            // Calculate current visitor count (unique visitors in last 30 minutes)
            const uniqueVisitors = new Set(activeSessions.map((s)=>s.visitorId));
            const currentVisitors = uniqueVisitors.size;
            // Calculate active pages by grouping current page views
            const pageActivity = activeSessions.reduce((acc, session)=>{
                const currentPage = session.exitPage || session.landingPage || '/';
                acc[currentPage] = (acc[currentPage] || 0) + 1;
                return acc;
            }, {});
            const activePages = Object.entries(pageActivity).map(([page, visitors])=>({
                    page,
                    visitors
                })).sort((a, b)=>b.visitors - a.visitors).slice(0, 10); // Top 10 pages
            // Transform visitor data
            const visitors = activeSessions.slice(0, 20).map((session)=>{
                const sessionDurationMs = session.sessionEnd.getTime() - session.sessionStart.getTime();
                const timeOnCurrentPage = Math.max(0, (now.getTime() - session.sessionStart.getTime()) / 1000);
                return {
                    id: session.visitorId,
                    sessionId: session.sessionId,
                    currentPage: session.exitPage || session.landingPage,
                    timeOnPage: Math.round(timeOnCurrentPage),
                    sessionDuration: Math.round(sessionDurationMs / 1000),
                    pageViews: session.pageViews,
                    interactions: session.interactions,
                    intentScore: session.intentScore,
                    scrollDepth: session.scrollDepth,
                    isReturning: this.isReturningVisitor(session.visitorId, activeSessions),
                    isConverted: session.conversionValue > 0,
                    trafficSource: {
                        source: session.source,
                        medium: session.medium,
                        campaign: session.campaign
                    },
                    location: includeLocation ? {
                        country: session.country,
                        city: session.city,
                        region: session.region
                    } : undefined,
                    device: includeDevice ? {
                        type: session.deviceType,
                        browser: session.browser,
                        os: session.operatingSystem
                    } : undefined
                };
            });
            // Calculate real-time insights
            const insights = this.generateRealTimeInsights(activeSessions, visitors, currentVisitors);
            // Calculate traffic trends (compare with previous 30 minutes)
            const previousPeriodStart = new Date(thirtyMinutesAgo.getTime() - 30 * 60 * 1000);
            const previousSessions = await _prisma.prisma.mCPVisitorSessions.count({
                where: {
                    organizationId: authContext.organizationId,
                    sessionStart: {
                        gte: previousPeriodStart,
                        lt: thirtyMinutesAgo
                    }
                }
            });
            const trafficChange = previousSessions > 0 ? (currentVisitors - previousSessions) / previousSessions * 100 : 0;
            // Device and location statistics
            const deviceStats = includeDevice ? this.calculateDeviceStats(visitors) : undefined;
            const locationStats = includeLocation ? this.calculateLocationStats(visitors) : undefined;
            const duration = Date.now() - startTime;
            // Log successful tool execution
            await this.logMCPToolExecution(authContext, 'get_real_time_visitors', args, 'success', {
                duration,
                outputSize: visitors.length,
                riskLevel: 'low'
            });
            const realTimeData = {
                currentVisitors,
                trafficTrend: {
                    change: Math.round(trafficChange * 100) / 100,
                    direction: trafficChange > 0 ? 'increasing' : trafficChange < 0 ? 'decreasing' : 'stable',
                    previousPeriodVisitors: previousSessions
                },
                activePages,
                visitors,
                deviceStats,
                locationStats,
                insights,
                sessionStats: {
                    totalActiveSessions: activeSessions.length,
                    avgSessionDuration: activeSessions.length > 0 ? Math.round(activeSessions.reduce((sum, s)=>sum + s.duration, 0) / activeSessions.length) : 0,
                    avgPageViews: activeSessions.length > 0 ? Math.round(activeSessions.reduce((sum, s)=>sum + s.pageViews, 0) / activeSessions.length * 100) / 100 : 0,
                    avgIntentScore: activeSessions.length > 0 ? Math.round(activeSessions.reduce((sum, s)=>sum + s.intentScore, 0) / activeSessions.length * 100) / 100 : 0,
                    conversionRate: activeSessions.length > 0 ? Math.round(activeSessions.filter((s)=>s.conversionValue > 0).length / activeSessions.length * 100 * 100) / 100 : 0
                }
            };
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: realTimeData,
                            meta: {
                                includeLocation,
                                includeDevice,
                                timestamp: new Date().toISOString(),
                                duration,
                                timeWindow: '30 minutes',
                                source: 'MCP_VISITOR_SESSIONS'
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            const duration = Date.now() - startTime;
            // Log failed tool execution
            await this.logMCPToolExecution(authContext, 'get_real_time_visitors', args, 'failure', {
                duration,
                errorMessage: error instanceof Error ? error.message : 'Unknown error',
                riskLevel: 'medium'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to get real-time visitors",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Identify high intent visitors tool with real data
   */ async identifyHighIntentVisitors(args, authContext) {
        const { threshold = 70, limit = 20 } = args;
        const startTime = Date.now();
        try {
            // Log tool execution
            await this.logMCPToolExecution(authContext, 'identify_high_intent_visitors', args, 'success', {
                duration: 0,
                riskLevel: 'low'
            });
            // Get high intent visitors from real session data
            const highIntentSessions = await _prisma.prisma.mCPVisitorSessions.findMany({
                where: {
                    organizationId: authContext.organizationId,
                    intentScore: {
                        gte: threshold
                    },
                    sessionStart: {
                        gte: new Date(Date.now() - 24 * 60 * 60 * 1000) // Last 24 hours
                    }
                },
                include: {
                    organization: {
                        select: {
                            id: true,
                            name: true
                        }
                    }
                },
                orderBy: {
                    intentScore: 'desc'
                },
                take: limit
            });
            // Transform to high intent visitor format
            const highIntentVisitors = await Promise.all(highIntentSessions.map(async (session)=>{
                // Get historical sessions for this visitor to determine behavior patterns
                const visitorSessions = await _prisma.prisma.mCPVisitorSessions.findMany({
                    where: {
                        visitorId: session.visitorId,
                        organizationId: authContext.organizationId
                    },
                    orderBy: {
                        sessionStart: 'desc'
                    },
                    take: 10
                });
                // Analyze visitor behavior patterns
                const signals = this.analyzeVisitorSignals(session, visitorSessions);
                const recommendation = this.generateRecommendation(session, signals);
                return {
                    id: session.visitorId,
                    sessionId: session.sessionId,
                    intentScore: session.intentScore,
                    currentPage: session.exitPage || session.landingPage,
                    sessionDuration: session.duration,
                    pageViews: session.pageViews,
                    interactions: session.interactions,
                    scrollDepth: session.scrollDepth,
                    conversionValue: session.conversionValue,
                    signals,
                    profile: {
                        isReturning: visitorSessions.length > 1,
                        totalSessions: visitorSessions.length,
                        totalPageViews: visitorSessions.reduce((sum, s)=>sum + s.pageViews, 0),
                        avgSessionDuration: Math.round(visitorSessions.reduce((sum, s)=>sum + s.duration, 0) / visitorSessions.length),
                        lastSeen: session.sessionStart.toISOString(),
                        location: {
                            country: session.country,
                            city: session.city,
                            region: session.region
                        },
                        device: {
                            type: session.deviceType,
                            browser: session.browser,
                            os: session.operatingSystem
                        }
                    },
                    trafficSource: {
                        source: session.source,
                        medium: session.medium,
                        campaign: session.campaign,
                        referrer: session.referrer
                    },
                    recommendation
                };
            }));
            // Calculate insights
            const totalCount = highIntentVisitors.length;
            const averageIntentScore = totalCount > 0 ? highIntentVisitors.reduce((sum, v)=>sum + v.intentScore, 0) / totalCount : 0;
            const returningVisitors = highIntentVisitors.filter((v)=>v.profile.isReturning).length;
            const convertedVisitors = highIntentVisitors.filter((v)=>v.conversionValue > 0).length;
            const mobileVisitors = highIntentVisitors.filter((v)=>v.profile.device.type === 'mobile').length;
            const insights = [
                `${totalCount} visitors above ${threshold}% intent threshold in last 24 hours`,
                `Average intent score: ${Math.round(averageIntentScore)}%`,
                `${Math.round(returningVisitors / totalCount * 100)}% are returning visitors showing continued interest`,
                `${convertedVisitors} have already converted in their current session`,
                `${Math.round(mobileVisitors / totalCount * 100)}% are browsing on mobile devices`,
                "Recommend immediate personalized outreach for best conversion rates"
            ];
            const duration = Date.now() - startTime;
            // Log successful tool execution
            await this.logMCPToolExecution(authContext, 'identify_high_intent_visitors', args, 'success', {
                duration,
                outputSize: totalCount,
                riskLevel: 'medium' // Higher risk due to visitor identification
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: {
                                visitors: highIntentVisitors,
                                totalCount,
                                averageIntentScore: Math.round(averageIntentScore * 100) / 100,
                                statistics: {
                                    returningVisitors,
                                    convertedVisitors,
                                    mobileVisitors,
                                    returningPercentage: Math.round(returningVisitors / totalCount * 100),
                                    conversionRate: Math.round(convertedVisitors / totalCount * 100 * 100) / 100,
                                    mobilePercentage: Math.round(mobileVisitors / totalCount * 100)
                                },
                                insights
                            },
                            meta: {
                                threshold,
                                limit,
                                timeRange: '24 hours',
                                timestamp: new Date().toISOString(),
                                duration,
                                source: 'MCP_VISITOR_SESSIONS'
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            const duration = Date.now() - startTime;
            // Log failed tool execution
            await this.logMCPToolExecution(authContext, 'identify_high_intent_visitors', args, 'failure', {
                duration,
                errorMessage: error instanceof Error ? error.message : 'Unknown error',
                riskLevel: 'medium'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to identify high intent visitors",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Fallback methods for LeadPulse data
   */ async getVisitorDataFallback(query, authContext) {
        return {
            visitors: [],
            meta: {
                total: 0,
                offset: query.offset,
                limit: query.limit,
                fallbackUsed: true,
                message: "Visitor data fallback - implementation needed"
            }
        };
    }
    /**
   * Get session data (placeholder)
   */ async getSessionData(query, authContext) {
        return {
            uri: "leadpulse://sessions",
            mimeType: "application/json",
            text: JSON.stringify({
                message: "Session data functionality coming soon",
                fallbackUsed: true
            })
        };
    }
    /**
   * Get heatmap data (placeholder)
   */ async getHeatmapData(query, authContext) {
        return {
            uri: "leadpulse://heatmaps",
            mimeType: "application/json",
            text: JSON.stringify({
                message: "Heatmap data functionality coming soon",
                fallbackUsed: true
            })
        };
    }
    /**
   * Get journey data (placeholder)
   */ async getJourneyData(query, authContext) {
        return {
            uri: "leadpulse://journeys",
            mimeType: "application/json",
            text: JSON.stringify({
                message: "Journey data functionality coming soon",
                fallbackUsed: true
            })
        };
    }
    /**
   * Get conversion data (placeholder)
   */ async getConversionData(query, authContext) {
        return {
            uri: "leadpulse://conversions",
            mimeType: "application/json",
            text: JSON.stringify({
                message: "Conversion data functionality coming soon",
                fallbackUsed: true
            })
        };
    }
    /**
   * Get analytics data (placeholder)
   */ async getAnalyticsData(query, authContext) {
        return {
            uri: "leadpulse://analytics",
            mimeType: "application/json",
            text: JSON.stringify({
                message: "Analytics data functionality coming soon",
                fallbackUsed: true
            })
        };
    }
    /**
   * Helper methods for visitor analysis
   */ /**
   * Get timezone from country code
   */ getTimezoneFromCountry(country) {
        const timezoneMap = {
            'Nigeria': 'Africa/Lagos',
            'Kenya': 'Africa/Nairobi',
            'Ghana': 'Africa/Accra',
            'South Africa': 'Africa/Johannesburg',
            'Egypt': 'Africa/Cairo',
            'Morocco': 'Africa/Casablanca',
            'Tanzania': 'Africa/Dar_es_Salaam',
            'Uganda': 'Africa/Kampala',
            'Rwanda': 'Africa/Kigali',
            'Zambia': 'Africa/Lusaka'
        };
        return timezoneMap[country] || 'UTC';
    }
    /**
   * Calculate visitor bounce rate across sessions
   */ calculateVisitorBounceRate(sessions) {
        if (sessions.length === 0) return 0;
        const bouncedSessions = sessions.filter((s)=>s.bounceRate > 0.5).length;
        return bouncedSessions / sessions.length * 100;
    }
    /**
   * Calculate engagement score based on visitor behavior
   */ calculateEngagementScore(sessions) {
        if (sessions.length === 0) return 0;
        let score = 0;
        const weights = {
            sessionDuration: 0.3,
            pageViews: 0.25,
            interactions: 0.2,
            scrollDepth: 0.15,
            conversions: 0.1
        };
        // Average session duration (normalized to 0-100)
        const avgDuration = sessions.reduce((sum, s)=>sum + s.duration, 0) / sessions.length;
        score += Math.min(avgDuration / 300, 1) * 100 * weights.sessionDuration; // 5 minutes = 100%
        // Average page views per session
        const avgPageViews = sessions.reduce((sum, s)=>sum + s.pageViews, 0) / sessions.length;
        score += Math.min(avgPageViews / 10, 1) * 100 * weights.pageViews; // 10 pages = 100%
        // Average interactions
        const avgInteractions = sessions.reduce((sum, s)=>sum + s.interactions, 0) / sessions.length;
        score += Math.min(avgInteractions / 20, 1) * 100 * weights.interactions; // 20 interactions = 100%
        // Average scroll depth
        const avgScrollDepth = sessions.reduce((sum, s)=>sum + s.scrollDepth, 0) / sessions.length;
        score += avgScrollDepth * 100 * weights.scrollDepth;
        // Conversion bonus
        const conversions = sessions.filter((s)=>s.conversionValue > 0).length;
        score += conversions / sessions.length * 100 * weights.conversions;
        return Math.round(score * 100) / 100;
    }
    /**
   * Build visitor journey from sessions
   */ buildVisitorJourney(sessions) {
        const journey = [];
        sessions.reverse().forEach((session, sessionIndex)=>{
            // Add session start
            journey.push({
                timestamp: session.sessionStart.toISOString(),
                action: 'session_start',
                sessionId: session.sessionId,
                page: session.landingPage,
                source: session.source,
                medium: session.medium,
                campaign: session.campaign
            });
            // Simulate page views based on session data
            const pageViews = Math.max(1, session.pageViews);
            const sessionDuration = session.duration;
            const timePerPage = sessionDuration / pageViews;
            for(let i = 0; i < pageViews; i++){
                const pageTimestamp = new Date(session.sessionStart.getTime() + i * timePerPage * 1000);
                journey.push({
                    timestamp: pageTimestamp.toISOString(),
                    action: 'page_view',
                    page: i === 0 ? session.landingPage : i === pageViews - 1 ? session.exitPage : `/page-${i + 1}`,
                    duration: Math.round(timePerPage),
                    scrollDepth: session.scrollDepth,
                    interactions: Math.round(session.interactions / pageViews)
                });
            }
            // Add conversion event if applicable
            if (session.conversionValue > 0) {
                journey.push({
                    timestamp: new Date(session.sessionEnd.getTime() - 30000).toISOString(),
                    action: 'conversion',
                    page: session.exitPage,
                    value: session.conversionValue,
                    conversionType: 'purchase' // Could be determined from data
                });
            }
            // Add session end
            journey.push({
                timestamp: session.sessionEnd.toISOString(),
                action: 'session_end',
                sessionId: session.sessionId,
                page: session.exitPage,
                duration: session.duration,
                bounced: session.bounceRate > 0.5
            });
        });
        return journey;
    }
    /**
   * Generate insights for visitor behavior
   */ generateVisitorInsights(visitorData, sessions) {
        const insights = [];
        const profile = visitorData.profile;
        const current = visitorData.currentSession;
        const behavioral = visitorData.behavioral;
        // Intent score insights
        if (current.intentScore > 80) {
            insights.push(`High intent visitor - ${current.intentScore}% intent score indicates strong purchase likelihood`);
        } else if (current.intentScore > 60) {
            insights.push(`Moderate intent visitor - ${current.intentScore}% intent score shows interest`);
        } else {
            insights.push(`Low intent visitor - ${current.intentScore}% intent score suggests early stage exploration`);
        }
        // Engagement insights
        if (behavioral.engagementScore > 70) {
            insights.push(`Highly engaged visitor - ${behavioral.engagementScore.toFixed(1)} engagement score`);
        } else if (behavioral.engagementScore > 40) {
            insights.push(`Moderately engaged visitor - ${behavioral.engagementScore.toFixed(1)} engagement score`);
        }
        // Session insights
        if (current.pageViews > 5) {
            insights.push(`Engaged user - ${current.pageViews} page views in current session shows strong interest`);
        }
        if (current.duration > 300) {
            insights.push(`Extended session - ${Math.round(current.duration / 60)} minutes indicates serious consideration`);
        }
        // Returning visitor insights
        if (profile.isReturning) {
            insights.push(`Returning visitor - ${profile.totalSessions} total sessions shows continued interest`);
            if (profile.daysSinceFirstVisit > 7) {
                insights.push(`Long-term interest - first visited ${profile.daysSinceFirstVisit} days ago`);
            }
        } else {
            insights.push("New visitor - first-time visit represents acquisition opportunity");
        }
        // Conversion insights
        if (profile.totalConversions > 0) {
            insights.push(`Converting visitor - ${profile.totalConversions} previous conversions`);
        } else if (behavioral.conversionRate > 0) {
            insights.push("Conversion potential - behavioral patterns suggest readiness to convert");
        }
        // Geographic insights
        if (visitorData.geoLocation.country === 'Nigeria') {
            insights.push("Nigerian visitor - optimize for mobile experience and local payment methods");
        }
        // Device insights
        if (visitorData.device.type === 'mobile') {
            insights.push("Mobile visitor - ensure mobile-optimized experience and WhatsApp integration");
        }
        // Bounce rate insights
        if (behavioral.bounceRate < 20) {
            insights.push("Low bounce rate indicates strong content engagement");
        } else if (behavioral.bounceRate > 60) {
            insights.push("High bounce rate suggests need for content optimization");
        }
        return insights;
    }
    /**
   * Check if visitor is returning based on visitor ID occurrence
   */ isReturningVisitor(visitorId, sessions) {
        return sessions.filter((s)=>s.visitorId === visitorId).length > 1;
    }
    /**
   * Generate real-time insights based on current activity
   */ generateRealTimeInsights(activeSessions, visitors, currentVisitors) {
        const insights = [];
        if (currentVisitors === 0) {
            insights.push("No active visitors currently on the site");
            return insights;
        }
        // Traffic level insights
        if (currentVisitors > 20) {
            insights.push(`High traffic period - ${currentVisitors} active visitors`);
        } else if (currentVisitors > 5) {
            insights.push(`Moderate traffic - ${currentVisitors} active visitors`);
        } else {
            insights.push(`Low traffic period - ${currentVisitors} active visitors`);
        }
        // Device distribution insights
        const mobileVisitors = visitors.filter((v)=>v.device?.type === 'mobile').length;
        const mobilePercentage = visitors.length > 0 ? mobileVisitors / visitors.length * 100 : 0;
        if (mobilePercentage > 70) {
            insights.push(`${Math.round(mobilePercentage)}% of visitors are on mobile devices`);
        }
        // Geographic insights
        const countries = new Set(visitors.map((v)=>v.location?.country).filter(Boolean));
        if (countries.size > 1) {
            insights.push(`Visitors from ${countries.size} countries currently active`);
        }
        // High intent visitors
        const highIntentVisitors = visitors.filter((v)=>v.intentScore > 70).length;
        if (highIntentVisitors > 0) {
            insights.push(`${highIntentVisitors} high-intent visitors (>70% intent score) currently browsing`);
        }
        // Session duration insights
        const longSessions = visitors.filter((v)=>v.sessionDuration > 300).length; // > 5 minutes
        if (longSessions > 0) {
            insights.push(`${longSessions} visitors have been browsing for over 5 minutes`);
        }
        // Page popularity
        const avgPageViews = visitors.length > 0 ? visitors.reduce((sum, v)=>sum + v.pageViews, 0) / visitors.length : 0;
        if (avgPageViews > 3) {
            insights.push(`High engagement - average ${Math.round(avgPageViews * 10) / 10} pages per session`);
        }
        // Returning visitors
        const returningVisitors = visitors.filter((v)=>v.isReturning).length;
        if (returningVisitors > 0) {
            const returningPercentage = returningVisitors / visitors.length * 100;
            insights.push(`${Math.round(returningPercentage)}% are returning visitors`);
        }
        // Conversion insights
        const convertedVisitors = visitors.filter((v)=>v.isConverted).length;
        if (convertedVisitors > 0) {
            insights.push(`${convertedVisitors} visitors have converted in their current session`);
        }
        return insights;
    }
    /**
   * Calculate device statistics for real-time data
   */ calculateDeviceStats(visitors) {
        if (visitors.length === 0) return null;
        const deviceTypes = visitors.reduce((acc, v)=>{
            if (v.device?.type) {
                acc[v.device.type] = (acc[v.device.type] || 0) + 1;
            }
            return acc;
        }, {});
        const browsers = visitors.reduce((acc, v)=>{
            if (v.device?.browser) {
                acc[v.device.browser] = (acc[v.device.browser] || 0) + 1;
            }
            return acc;
        }, {});
        const operatingSystems = visitors.reduce((acc, v)=>{
            if (v.device?.os) {
                acc[v.device.os] = (acc[v.device.os] || 0) + 1;
            }
            return acc;
        }, {});
        return {
            deviceTypes,
            browsers,
            operatingSystems,
            mobilePercentage: deviceTypes.mobile ? deviceTypes.mobile / visitors.length * 100 : 0
        };
    }
    /**
   * Calculate location statistics for real-time data
   */ calculateLocationStats(visitors) {
        if (visitors.length === 0) return null;
        const countries = visitors.reduce((acc, v)=>{
            if (v.location?.country) {
                acc[v.location.country] = (acc[v.location.country] || 0) + 1;
            }
            return acc;
        }, {});
        const cities = visitors.reduce((acc, v)=>{
            if (v.location?.city) {
                acc[v.location.city] = (acc[v.location.city] || 0) + 1;
            }
            return acc;
        }, {});
        const regions = visitors.reduce((acc, v)=>{
            if (v.location?.region) {
                acc[v.location.region] = (acc[v.location.region] || 0) + 1;
            }
            return acc;
        }, {});
        return {
            countries,
            cities,
            regions,
            topCountry: Object.entries(countries).sort((a, b)=>b[1] - a[1])[0]?.[0],
            totalCountries: Object.keys(countries).length
        };
    }
    /**
   * Analyze visitor behavior signals for intent scoring
   */ analyzeVisitorSignals(currentSession, visitorSessions) {
        const signals = {
            engagementSignals: [],
            behavioralSignals: [],
            intentSignals: [],
            riskSignals: []
        };
        // Engagement signals
        if (currentSession.duration > 300) {
            signals.engagementSignals.push({
                type: 'long_session',
                value: currentSession.duration,
                weight: 0.8,
                description: `Extended session duration of ${Math.round(currentSession.duration / 60)} minutes`
            });
        }
        if (currentSession.pageViews > 5) {
            signals.engagementSignals.push({
                type: 'high_page_views',
                value: currentSession.pageViews,
                weight: 0.7,
                description: `High engagement with ${currentSession.pageViews} page views`
            });
        }
        if (currentSession.interactions > 10) {
            signals.engagementSignals.push({
                type: 'high_interactions',
                value: currentSession.interactions,
                weight: 0.6,
                description: `Active user with ${currentSession.interactions} interactions`
            });
        }
        if (currentSession.scrollDepth > 75) {
            signals.engagementSignals.push({
                type: 'deep_scroll',
                value: currentSession.scrollDepth,
                weight: 0.5,
                description: `Deep content engagement with ${currentSession.scrollDepth}% scroll depth`
            });
        }
        // Behavioral signals
        const isReturning = visitorSessions.length > 1;
        if (isReturning) {
            signals.behavioralSignals.push({
                type: 'returning_visitor',
                value: visitorSessions.length,
                weight: 0.9,
                description: `Returning visitor with ${visitorSessions.length} total sessions`
            });
        }
        // Calculate average session duration across all sessions
        const avgSessionDuration = visitorSessions.reduce((sum, s)=>sum + s.duration, 0) / visitorSessions.length;
        if (avgSessionDuration > 180) {
            signals.behavioralSignals.push({
                type: 'consistent_engagement',
                value: avgSessionDuration,
                weight: 0.7,
                description: `Consistent engagement with ${Math.round(avgSessionDuration / 60)} minute average sessions`
            });
        }
        // Intent signals based on pages visited
        const landingPage = currentSession.landingPage?.toLowerCase() || '';
        const exitPage = currentSession.exitPage?.toLowerCase() || '';
        if (landingPage.includes('pricing') || exitPage.includes('pricing')) {
            signals.intentSignals.push({
                type: 'pricing_interest',
                value: 1,
                weight: 0.9,
                description: 'Visited pricing page indicating purchase intent'
            });
        }
        if (landingPage.includes('contact') || exitPage.includes('contact') || landingPage.includes('demo')) {
            signals.intentSignals.push({
                type: 'contact_interest',
                value: 1,
                weight: 0.8,
                description: 'Visited contact/demo page indicating high intent'
            });
        }
        if (currentSession.conversionValue > 0) {
            signals.intentSignals.push({
                type: 'conversion_completed',
                value: currentSession.conversionValue,
                weight: 1.0,
                description: `Completed conversion with value ${currentSession.conversionValue}`
            });
        }
        // Risk signals
        if (currentSession.bounceRate > 0.8) {
            signals.riskSignals.push({
                type: 'high_bounce_risk',
                value: currentSession.bounceRate,
                weight: -0.5,
                description: 'High bounce rate indicates potential disengagement'
            });
        }
        if (currentSession.duration < 30) {
            signals.riskSignals.push({
                type: 'quick_exit',
                value: currentSession.duration,
                weight: -0.6,
                description: 'Very short session duration suggests low interest'
            });
        }
        // Traffic source insights
        if (currentSession.source === 'direct' && isReturning) {
            signals.behavioralSignals.push({
                type: 'direct_return',
                value: 1,
                weight: 0.8,
                description: 'Direct traffic from returning visitor shows brand awareness'
            });
        }
        if (currentSession.source === 'organic') {
            signals.behavioralSignals.push({
                type: 'organic_discovery',
                value: 1,
                weight: 0.6,
                description: 'Organic search traffic indicates active problem-solving'
            });
        }
        return signals;
    }
    /**
   * Generate personalized recommendation based on visitor signals
   */ generateRecommendation(currentSession, signals) {
        const recommendations = [];
        let urgency = 'low';
        let priority = 1;
        // Calculate overall intent score from signals
        let intentScore = currentSession.intentScore || 0;
        // Analyze engagement signals
        if (signals.engagementSignals.length > 2) {
            recommendations.push({
                action: 'immediate_engagement',
                channel: 'live_chat',
                message: 'Offer live chat assistance due to high engagement',
                reason: 'Multiple strong engagement signals detected'
            });
            urgency = 'high';
            priority = 3;
        }
        // Analyze intent signals
        const hasHighIntent = signals.intentSignals.some((s)=>s.weight > 0.8);
        if (hasHighIntent) {
            recommendations.push({
                action: 'sales_outreach',
                channel: 'phone',
                message: 'Schedule immediate sales call',
                reason: 'High purchase intent detected',
                timing: 'within_1_hour'
            });
            urgency = 'critical';
            priority = 5;
        }
        // Pricing page visitors
        const visitedPricing = signals.intentSignals.some((s)=>s.type === 'pricing_interest');
        if (visitedPricing) {
            recommendations.push({
                action: 'pricing_assistance',
                channel: 'email',
                message: 'Send personalized pricing information and case studies',
                reason: 'Showed interest in pricing',
                timing: 'within_2_hours'
            });
            if (currentSession.duration > 180) {
                recommendations.push({
                    action: 'discount_offer',
                    channel: 'popup',
                    message: 'Offer limited-time discount or consultation',
                    reason: 'Extended time on pricing page',
                    timing: 'immediate'
                });
            }
        }
        // Returning visitor recommendations
        const isReturning = signals.behavioralSignals.some((s)=>s.type === 'returning_visitor');
        if (isReturning && !hasHighIntent) {
            recommendations.push({
                action: 'nurture_campaign',
                channel: 'email',
                message: 'Add to targeted nurture campaign with case studies',
                reason: 'Returning visitor showing continued interest',
                timing: 'within_24_hours'
            });
        }
        // Mobile-specific recommendations
        if (currentSession.deviceType === 'mobile') {
            recommendations.push({
                action: 'mobile_optimization',
                channel: 'whatsapp',
                message: 'Offer WhatsApp consultation for mobile convenience',
                reason: 'Mobile user in African market',
                timing: 'within_4_hours'
            });
        }
        // Geographic recommendations
        if (currentSession.country === 'Nigeria' || currentSession.country === 'South Africa') {
            recommendations.push({
                action: 'local_approach',
                channel: 'sms',
                message: 'Send localized message with regional case studies',
                reason: 'African market visitor',
                timing: 'within_6_hours'
            });
        }
        // Risk mitigation
        const hasRiskSignals = signals.riskSignals.length > 0;
        if (hasRiskSignals && !hasHighIntent) {
            recommendations.push({
                action: 'retention_effort',
                channel: 'popup',
                message: 'Show value proposition or offer assistance',
                reason: 'Risk signals detected - prevent bounce',
                timing: 'immediate'
            });
        }
        // Default recommendation for new visitors
        if (!isReturning && intentScore < 50) {
            recommendations.push({
                action: 'lead_magnet',
                channel: 'popup',
                message: 'Offer valuable content download for email capture',
                reason: 'New visitor - build relationship',
                timing: 'after_60_seconds'
            });
        }
        return {
            recommendations,
            urgency,
            priority,
            nextBestAction: recommendations.length > 0 ? recommendations[0] : null,
            confidence: Math.min(intentScore / 100 + signals.engagementSignals.length * 0.1, 1.0),
            reasoning: {
                intentScore,
                engagementLevel: signals.engagementSignals.length > 2 ? 'high' : signals.engagementSignals.length > 0 ? 'medium' : 'low',
                riskLevel: signals.riskSignals.length > 1 ? 'high' : signals.riskSignals.length > 0 ? 'medium' : 'low',
                visitorType: isReturning ? 'returning' : 'new'
            }
        };
    }
    /**
   * Parse date range string to number of days
   */ parseDateRange(dateRange) {
        const rangeMap = {
            '1d': 1,
            '7d': 7,
            '14d': 14,
            '30d': 30,
            '60d': 60,
            '90d': 90,
            '180d': 180,
            '365d': 365
        };
        return rangeMap[dateRange] || 30;
    }
    /**
   * Analyze visitor progression through conversion funnel
   */ analyzeFunnelProgression(sessions, funnelSteps) {
        const stepAnalysis = [];
        let previousStepVisitors = sessions.length;
        // Analyze each funnel step
        for(let i = 0; i < funnelSteps.length; i++){
            const step = funnelSteps[i];
            let stepVisitors = 0;
            let stepRevenue = 0;
            if (step.conversionRequired) {
                // Final conversion step - count sessions with conversions
                const convertedSessions = sessions.filter((session)=>session.conversionValue > 0);
                stepVisitors = convertedSessions.length;
                stepRevenue = convertedSessions.reduce((sum, session)=>sum + session.conversionValue, 0);
            } else {
                // Page visit step - count sessions that visited matching pages
                stepVisitors = sessions.filter((session)=>{
                    const landingPage = session.landingPage?.toLowerCase() || '';
                    const exitPage = session.exitPage?.toLowerCase() || '';
                    const pattern = new RegExp(step.pagePattern, 'i');
                    return pattern.test(landingPage) || pattern.test(exitPage);
                }).length;
            }
            const conversionRate = previousStepVisitors > 0 ? stepVisitors / previousStepVisitors * 100 : 0;
            const dropOffRate = previousStepVisitors > 0 ? (previousStepVisitors - stepVisitors) / previousStepVisitors * 100 : 0;
            stepAnalysis.push({
                step: i + 1,
                name: step.name,
                visitors: stepVisitors,
                conversionRate: Math.round(conversionRate * 100) / 100,
                dropOffRate: Math.round(dropOffRate * 100) / 100,
                revenue: stepRevenue,
                pattern: step.pagePattern || 'conversion'
            });
            previousStepVisitors = stepVisitors;
        }
        // Calculate overall metrics
        const totalSessions = sessions.length;
        const totalConversions = stepAnalysis[stepAnalysis.length - 1]?.visitors || 0;
        const totalRevenue = stepAnalysis[stepAnalysis.length - 1]?.revenue || 0;
        const overallConversion = totalSessions > 0 ? totalConversions / totalSessions * 100 : 0;
        const averageOrderValue = totalConversions > 0 ? totalRevenue / totalConversions : 0;
        // Find best and worst performing steps
        const stepRates = stepAnalysis.slice(1).map((step)=>({
                name: step.name,
                rate: step.conversionRate
            }));
        const bestStep = stepRates.reduce((max, step)=>step.rate > max.rate ? step : max, stepRates[0] || {
            name: 'N/A',
            rate: 0
        });
        const worstStep = stepRates.reduce((min, step)=>step.rate < min.rate ? step : min, stepRates[0] || {
            name: 'N/A',
            rate: 0
        });
        // Find biggest drop-off
        const dropOffs = stepAnalysis.map((step)=>({
                name: step.name,
                dropOff: step.dropOffRate
            }));
        const biggestDropOff = dropOffs.reduce((max, step)=>step.dropOff > max.dropOff ? step : max, dropOffs[0] || {
            name: 'N/A',
            dropOff: 0
        });
        return {
            steps: stepAnalysis,
            overallConversion: Math.round(overallConversion * 100) / 100,
            totalRevenue: Math.round(totalRevenue * 100) / 100,
            averageOrderValue: Math.round(averageOrderValue * 100) / 100,
            bestStep: bestStep.name,
            worstStep: worstStep.name,
            biggestDropOff: biggestDropOff.name
        };
    }
    /**
   * Analyze funnel performance by customer segments
   */ async analyzeFunnelBySegments(sessions, funnelSteps, authContext) {
        try {
            // Get segments for the organization
            const segments = await _prisma.prisma.segment.findMany({
                where: {
                    createdBy: {
                        organizationId: authContext.organizationId
                    }
                },
                include: {
                    members: {
                        include: {
                            contact: true
                        }
                    }
                }
            });
            const segmentAnalysis = [];
            // Analyze new vs returning visitors
            const newVisitorSessions = sessions.filter((session)=>{
                const visitorSessions = sessions.filter((s)=>s.visitorId === session.visitorId);
                return visitorSessions.length === 1;
            });
            const returningVisitorSessions = sessions.filter((session)=>{
                const visitorSessions = sessions.filter((s)=>s.visitorId === session.visitorId);
                return visitorSessions.length > 1;
            });
            // Analyze new visitors
            if (newVisitorSessions.length > 0) {
                const newVisitorFunnel = this.analyzeFunnelProgression(newVisitorSessions, funnelSteps);
                segmentAnalysis.push({
                    name: 'New Visitors',
                    totalSessions: newVisitorSessions.length,
                    overallConversion: newVisitorFunnel.overallConversion,
                    totalRevenue: newVisitorFunnel.totalRevenue,
                    averageOrderValue: newVisitorFunnel.averageOrderValue,
                    topDropOffStep: newVisitorFunnel.biggestDropOff,
                    steps: newVisitorFunnel.steps
                });
            }
            // Analyze returning visitors
            if (returningVisitorSessions.length > 0) {
                const returningVisitorFunnel = this.analyzeFunnelProgression(returningVisitorSessions, funnelSteps);
                segmentAnalysis.push({
                    name: 'Returning Visitors',
                    totalSessions: returningVisitorSessions.length,
                    overallConversion: returningVisitorFunnel.overallConversion,
                    totalRevenue: returningVisitorFunnel.totalRevenue,
                    averageOrderValue: returningVisitorFunnel.averageOrderValue,
                    topDropOffStep: returningVisitorFunnel.biggestDropOff,
                    steps: returningVisitorFunnel.steps
                });
            }
            // Analyze by device type
            const mobileReqs = sessions.filter((s)=>s.deviceType === 'mobile');
            const desktopSessions = sessions.filter((s)=>s.deviceType === 'desktop');
            if (mobileReqs.length > 0) {
                const mobileFunnel = this.analyzeFunnelProgression(mobileReqs, funnelSteps);
                segmentAnalysis.push({
                    name: 'Mobile Visitors',
                    totalSessions: mobileReqs.length,
                    overallConversion: mobileFunnel.overallConversion,
                    totalRevenue: mobileFunnel.totalRevenue,
                    averageOrderValue: mobileFunnel.averageOrderValue,
                    topDropOffStep: mobileFunnel.biggestDropOff,
                    steps: mobileFunnel.steps
                });
            }
            if (desktopSessions.length > 0) {
                const desktopFunnel = this.analyzeFunnelProgression(desktopSessions, funnelSteps);
                segmentAnalysis.push({
                    name: 'Desktop Visitors',
                    totalSessions: desktopSessions.length,
                    overallConversion: desktopFunnel.overallConversion,
                    totalRevenue: desktopFunnel.totalRevenue,
                    averageOrderValue: desktopFunnel.averageOrderValue,
                    topDropOffStep: desktopFunnel.biggestDropOff,
                    steps: desktopFunnel.steps
                });
            }
            // Analyze by traffic source
            const organicSessions = sessions.filter((s)=>s.source === 'organic');
            const directSessions = sessions.filter((s)=>s.source === 'direct');
            const socialSessions = sessions.filter((s)=>s.source === 'social');
            if (organicSessions.length > 0) {
                const organicFunnel = this.analyzeFunnelProgression(organicSessions, funnelSteps);
                segmentAnalysis.push({
                    name: 'Organic Traffic',
                    totalSessions: organicSessions.length,
                    overallConversion: organicFunnel.overallConversion,
                    totalRevenue: organicFunnel.totalRevenue,
                    averageOrderValue: organicFunnel.averageOrderValue,
                    topDropOffStep: organicFunnel.biggestDropOff,
                    steps: organicFunnel.steps
                });
            }
            return segmentAnalysis;
        } catch (error) {
            console.error('Error analyzing funnel by segments:', error);
            return [];
        }
    }
    /**
   * Generate actionable insights from funnel data
   */ generateFunnelInsights(steps, segmentData) {
        const insights = [];
        // Overall funnel insights
        if (steps.length > 0) {
            const firstStep = steps[0];
            const lastStep = steps[steps.length - 1];
            insights.push(`Funnel starts with ${firstStep.visitors.toLocaleString()} visitors and converts ${lastStep.visitors.toLocaleString()} (${lastStep.conversionRate}% overall)`);
            // Find biggest drop-off
            const biggestDropOff = steps.reduce((max, step)=>step.dropOffRate > max.dropOffRate ? step : max, steps[0]);
            if (biggestDropOff.dropOffRate > 50) {
                insights.push(`⚠️ Critical drop-off at ${biggestDropOff.name} (${biggestDropOff.dropOffRate}% exit rate) - requires immediate optimization`);
            } else if (biggestDropOff.dropOffRate > 30) {
                insights.push(`📉 Significant drop-off at ${biggestDropOff.name} (${biggestDropOff.dropOffRate}% exit rate) - optimization opportunity`);
            }
            // Revenue insights
            const revenueStep = steps.find((step)=>step.revenue > 0);
            if (revenueStep) {
                insights.push(`💰 Generated ${revenueStep.revenue.toLocaleString()} in revenue from ${revenueStep.visitors} conversions`);
            }
            // Conversion rate insights
            const overallRate = lastStep.conversionRate;
            if (overallRate > 5) {
                insights.push(`🎯 Excellent conversion rate of ${overallRate}% - above industry average`);
            } else if (overallRate > 2) {
                insights.push(`✅ Good conversion rate of ${overallRate}% - room for improvement`);
            } else {
                insights.push(`📊 Conversion rate of ${overallRate}% is below average - funnel optimization needed`);
            }
        }
        // Segment-specific insights
        if (segmentData && segmentData.length > 0) {
            const newVisitors = segmentData.find((s)=>s.name === 'New Visitors');
            const returningVisitors = segmentData.find((s)=>s.name === 'Returning Visitors');
            if (newVisitors && returningVisitors) {
                const conversionDiff = returningVisitors.overallConversion - newVisitors.overallConversion;
                if (conversionDiff > 2) {
                    insights.push(`🔄 Returning visitors convert ${conversionDiff.toFixed(1)}x better (${returningVisitors.overallConversion}% vs ${newVisitors.overallConversion}%)`);
                }
            }
            const mobileSegment = segmentData.find((s)=>s.name === 'Mobile Visitors');
            const desktopSegment = segmentData.find((s)=>s.name === 'Desktop Visitors');
            if (mobileSegment && desktopSegment) {
                if (mobileSegment.overallConversion < desktopSegment.overallConversion * 0.7) {
                    insights.push(`📱 Mobile conversion (${mobileSegment.overallConversion}%) significantly lower than desktop (${desktopSegment.overallConversion}%) - mobile optimization needed`);
                }
            }
            // Traffic source insights
            const organicSegment = segmentData.find((s)=>s.name === 'Organic Traffic');
            if (organicSegment && organicSegment.overallConversion > 3) {
                insights.push(`🌱 Organic traffic shows strong intent with ${organicSegment.overallConversion}% conversion - invest in SEO`);
            }
        }
        // African market specific insights
        insights.push(`🌍 Consider African market optimization: mobile-first design, WhatsApp integration, and local payment methods`);
        return insights;
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdXByZW1lL0Rlc2t0b3AvbWFya2V0c2FnZS9zcmMvbWNwL3NlcnZlcnMvbGVhZHB1bHNlLXNlcnZlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExlYWRQdWxzZSBNQ1AgU2VydmVyIGZvciBNYXJrZXRTYWdlXG4gKiBcbiAqIFRoaXMgc2VydmVyIHByb3ZpZGVzIHJlYWQtb25seSBhY2Nlc3MgdG8gdmlzaXRvciBpbnRlbGxpZ2VuY2UgZGF0YSxcbiAqIGJlaGF2aW9yYWwgYW5hbHl0aWNzLCBhbmQgY29udmVyc2lvbiB0cmFja2luZyB0aHJvdWdoIHRoZSBNQ1AgcHJvdG9jb2wuXG4gKi9cblxuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBIVFRQQmFzZU1DUFNlcnZlciB9IGZyb20gJy4vaHR0cC1iYXNlLW1jcC1zZXJ2ZXInO1xuaW1wb3J0IHsgXG4gIHR5cGUgTUNQQXV0aENvbnRleHQsIFxuICB0eXBlIE1DUFNlcnZlckNvbmZpZyxcbiAgTGVhZFB1bHNlUXVlcnlTY2hlbWEsXG4gIHR5cGUgTGVhZFB1bHNlUXVlcnksXG4gIFZpc2l0b3JTZXNzaW9uLFxuICBNQ1BBdXRob3JpemF0aW9uRXJyb3IsXG4gIE1DUFZhbGlkYXRpb25FcnJvclxufSBmcm9tICcuLi90eXBlcy9tY3AtdHlwZXMnO1xuXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuLi8uLi9saWIvZGIvcHJpc21hJztcbmltcG9ydCB7IGRlZmF1bHRNQ1BDb25maWcgfSBmcm9tICcuLi9jb25maWcvbWNwLWNvbmZpZyc7XG5cbmV4cG9ydCBjbGFzcyBMZWFkUHVsc2VNQ1BTZXJ2ZXIgZXh0ZW5kcyBIVFRQQmFzZU1DUFNlcnZlciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZz86IFBhcnRpYWw8TUNQU2VydmVyQ29uZmlnPikge1xuICAgIHN1cGVyKHtcbiAgICAgIC4uLmRlZmF1bHRNQ1BDb25maWcuc2VydmVycy5sZWFkcHVsc2UsXG4gICAgICAuLi5jb25maWdcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMaXN0IGF2YWlsYWJsZSBMZWFkUHVsc2UgcmVzb3VyY2VzXG4gICAqL1xuICBwcm90ZWN0ZWQgYXN5bmMgbGlzdFJlc291cmNlcyhhdXRoQ29udGV4dDogTUNQQXV0aENvbnRleHQpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgY29uc3QgcmVzb3VyY2VzID0gW1xuICAgICAge1xuICAgICAgICB1cmk6IFwibGVhZHB1bHNlOi8vdmlzaXRvcnNcIixcbiAgICAgICAgbmFtZTogXCJWaXNpdG9yIERhdGFcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQWNjZXNzIHRvIHZpc2l0b3Igc2Vzc2lvbnMgYW5kIGJlaGF2aW9yYWwgZGF0YVwiLFxuICAgICAgICBtaW1lVHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHVyaTogXCJsZWFkcHVsc2U6Ly9zZXNzaW9uc1wiLFxuICAgICAgICBuYW1lOiBcIlNlc3Npb24gRGF0YVwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJBY2Nlc3MgdG8gZGV0YWlsZWQgdmlzaXRvciBzZXNzaW9uIGluZm9ybWF0aW9uXCIsXG4gICAgICAgIG1pbWVUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdXJpOiBcImxlYWRwdWxzZTovL2hlYXRtYXBzXCIsXG4gICAgICAgIG5hbWU6IFwiSGVhdG1hcCBEYXRhXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkFjY2VzcyB0byBwYWdlIGhlYXRtYXAgYW5kIGludGVyYWN0aW9uIGRhdGFcIixcbiAgICAgICAgbWltZVR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB1cmk6IFwibGVhZHB1bHNlOi8vam91cm5leXNcIixcbiAgICAgICAgbmFtZTogXCJDdXN0b21lciBKb3VybmV5c1wiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJBY2Nlc3MgdG8gY3VzdG9tZXIgam91cm5leSBhbmQgY29udmVyc2lvbiBwYXRoc1wiLFxuICAgICAgICBtaW1lVHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHVyaTogXCJsZWFkcHVsc2U6Ly9jb252ZXJzaW9uc1wiLFxuICAgICAgICBuYW1lOiBcIkNvbnZlcnNpb24gRGF0YVwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJBY2Nlc3MgdG8gY29udmVyc2lvbiBldmVudHMgYW5kIGZ1bm5lbCBhbmFseXRpY3NcIixcbiAgICAgICAgbWltZVR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB1cmk6IFwibGVhZHB1bHNlOi8vYW5hbHl0aWNzXCIsXG4gICAgICAgIG5hbWU6IFwiQmVoYXZpb3JhbCBBbmFseXRpY3NcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQWNjZXNzIHRvIHZpc2l0b3IgYmVoYXZpb3IgYW5hbHl0aWNzIGFuZCBpbnNpZ2h0c1wiLFxuICAgICAgICBtaW1lVHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgIH1cbiAgICBdO1xuXG4gICAgLy8gRmlsdGVyIHJlc291cmNlcyBiYXNlZCBvbiBwZXJtaXNzaW9uc1xuICAgIGlmICghYXV0aENvbnRleHQucGVybWlzc2lvbnMuaW5jbHVkZXMoJyonKSAmJiAhYXV0aENvbnRleHQucGVybWlzc2lvbnMuaW5jbHVkZXMoJ3JlYWQ6b3JnJykpIHtcbiAgICAgIC8vIFVzZXJzIGNhbiBvbmx5IGFjY2VzcyBiYXNpYyB2aXNpdG9yIGRhdGFcbiAgICAgIHJldHVybiByZXNvdXJjZXMuZmlsdGVyKHIgPT4gci51cmkuaW5jbHVkZXMoJ3Zpc2l0b3JzJykgfHwgci51cmkuaW5jbHVkZXMoJ3Nlc3Npb25zJykpO1xuICAgIH1cblxuICAgIHJldHVybiByZXNvdXJjZXM7XG4gIH1cblxuICAvKipcbiAgICogUmVhZCBMZWFkUHVsc2UgcmVzb3VyY2VcbiAgICovXG4gIHByb3RlY3RlZCBhc3luYyByZWFkUmVzb3VyY2UodXJpOiBzdHJpbmcsIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTCh1cmkpO1xuICAgIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWU7XG4gICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gdXJsLnNlYXJjaFBhcmFtcztcblxuICAgIC8vIFBhcnNlIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICBjb25zdCBxdWVyeVBhcmFtcyA9IE9iamVjdC5mcm9tRW50cmllcyhzZWFyY2hQYXJhbXMuZW50cmllcygpKTtcbiAgICBjb25zdCB2YWxpZGF0ZWRRdWVyeSA9IExlYWRQdWxzZVF1ZXJ5U2NoZW1hLnBhcnNlKHtcbiAgICAgIC4uLnF1ZXJ5UGFyYW1zLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IGF1dGhDb250ZXh0Lm9yZ2FuaXphdGlvbklkLCAvLyBBbHdheXMgdXNlIHVzZXIncyBvcmdcbiAgICAgIGxpbWl0OiBxdWVyeVBhcmFtcy5saW1pdCA/IE51bWJlci5wYXJzZUludChxdWVyeVBhcmFtcy5saW1pdCkgOiAxMCxcbiAgICAgIG9mZnNldDogcXVlcnlQYXJhbXMub2Zmc2V0ID8gTnVtYmVyLnBhcnNlSW50KHF1ZXJ5UGFyYW1zLm9mZnNldCkgOiAwLFxuICAgICAgaW5jbHVkZUhlYXRtYXA6IHF1ZXJ5UGFyYW1zLmluY2x1ZGVIZWF0bWFwID09PSAndHJ1ZScsXG4gICAgICBpbmNsdWRlSm91cm5leTogcXVlcnlQYXJhbXMuaW5jbHVkZUpvdXJuZXkgPT09ICd0cnVlJ1xuICAgIH0pO1xuXG4gICAgc3dpdGNoIChwYXRoKSB7XG4gICAgICBjYXNlICcvdmlzaXRvcnMnOlxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRWaXNpdG9yRGF0YSh2YWxpZGF0ZWRRdWVyeSwgYXV0aENvbnRleHQpO1xuICAgICAgY2FzZSAnL3Nlc3Npb25zJzpcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0U2Vzc2lvbkRhdGEodmFsaWRhdGVkUXVlcnksIGF1dGhDb250ZXh0KTtcbiAgICAgIGNhc2UgJy9oZWF0bWFwcyc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldEhlYXRtYXBEYXRhKHZhbGlkYXRlZFF1ZXJ5LCBhdXRoQ29udGV4dCk7XG4gICAgICBjYXNlICcvam91cm5leXMnOlxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRKb3VybmV5RGF0YSh2YWxpZGF0ZWRRdWVyeSwgYXV0aENvbnRleHQpO1xuICAgICAgY2FzZSAnL2NvbnZlcnNpb25zJzpcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0Q29udmVyc2lvbkRhdGEodmFsaWRhdGVkUXVlcnksIGF1dGhDb250ZXh0KTtcbiAgICAgIGNhc2UgJy9hbmFseXRpY3MnOlxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRBbmFseXRpY3NEYXRhKHZhbGlkYXRlZFF1ZXJ5LCBhdXRoQ29udGV4dCk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgTUNQVmFsaWRhdGlvbkVycm9yKGBVbmtub3duIHJlc291cmNlIHBhdGg6ICR7cGF0aH1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTGlzdCBhdmFpbGFibGUgTGVhZFB1bHNlIHRvb2xzXG4gICAqL1xuICBwcm90ZWN0ZWQgYXN5bmMgbGlzdFRvb2xzKGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55W10+IHtcbiAgICBjb25zdCB0b29scyA9IFtcbiAgICAgIHtcbiAgICAgICAgbmFtZTogXCJ0cmFja192aXNpdG9yXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkdldCB2aXNpdG9yIHRyYWNraW5nIGluZm9ybWF0aW9uIGFuZCBiZWhhdmlvclwiLFxuICAgICAgICBpbnB1dFNjaGVtYToge1xuICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgdmlzaXRvcklkOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlZpc2l0b3IgSUQgdG8gdHJhY2tcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluY2x1ZGVKb3VybmV5OiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmNsdWRlIGN1c3RvbWVyIGpvdXJuZXkgZGF0YVwiLFxuICAgICAgICAgICAgICBkZWZhdWx0OiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jbHVkZUhlYXRtYXA6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsIFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmNsdWRlIGhlYXRtYXAgaW50ZXJhY3Rpb24gZGF0YVwiLFxuICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVxdWlyZWQ6IFtcInZpc2l0b3JJZFwiXVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiBcImFuYWx5emVfdmlzaXRvcl9iZWhhdmlvclwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJBbmFseXplIHZpc2l0b3IgYmVoYXZpb3IgcGF0dGVybnMgYW5kIGdlbmVyYXRlIGluc2lnaHRzXCIsXG4gICAgICAgIGlucHV0U2NoZW1hOiB7XG4gICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICB2aXNpdG9ySWQ6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVmlzaXRvciBJRCB0byBhbmFseXplXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXNzaW9uSWQ6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3BlY2lmaWMgc2Vzc2lvbiBJRCAob3B0aW9uYWwpXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aW1lUmFuZ2U6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgZW51bTogW1wiMWhcIiwgXCIxZFwiLCBcIjdkXCIsIFwiMzBkXCJdLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaW1lIHJhbmdlIGZvciBhbmFseXNpc1wiLFxuICAgICAgICAgICAgICBkZWZhdWx0OiBcIjdkXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcXVpcmVkOiBbXCJ2aXNpdG9ySWRcIl1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogXCJnZXRfY29udmVyc2lvbl9mdW5uZWxcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IGNvbnZlcnNpb24gZnVubmVsIGRhdGEgYW5kIGRyb3Atb2ZmIHBvaW50c1wiLFxuICAgICAgICBpbnB1dFNjaGVtYToge1xuICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgZnVubmVsSWQ6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRnVubmVsIElEIChvcHRpb25hbCBmb3IgZGVmYXVsdCBmdW5uZWwpXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkYXRlUmFuZ2U6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgZW51bTogW1wiN2RcIiwgXCIzMGRcIiwgXCI5MGRcIl0sXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkRhdGUgcmFuZ2UgZm9yIGZ1bm5lbCBhbmFseXNpc1wiLFxuICAgICAgICAgICAgICBkZWZhdWx0OiBcIjMwZFwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jbHVkZVNlZ21lbnRzOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmNsdWRlIHNlZ21lbnQtYmFzZWQgZnVubmVsIGFuYWx5c2lzXCIsXG4gICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiBcImdldF9wYWdlX2FuYWx5dGljc1wiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgcGFnZS1sZXZlbCBhbmFseXRpY3MgYW5kIHBlcmZvcm1hbmNlIG1ldHJpY3NcIixcbiAgICAgICAgaW5wdXRTY2hlbWE6IHtcbiAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIHBhZ2VVcmw6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiUGFnZSBVUkwgdG8gYW5hbHl6ZVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jbHVkZUhlYXRtYXA6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluY2x1ZGUgaGVhdG1hcCBkYXRhXCIsXG4gICAgICAgICAgICAgIGRlZmF1bHQ6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkYXRlUmFuZ2U6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgZW51bTogW1wiMWRcIiwgXCI3ZFwiLCBcIjMwZFwiXSxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRGF0ZSByYW5nZSBmb3IgYW5hbHlzaXNcIixcbiAgICAgICAgICAgICAgZGVmYXVsdDogXCI3ZFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXF1aXJlZDogW1wicGFnZVVybFwiXVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiBcImdldF9yZWFsX3RpbWVfdmlzaXRvcnNcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IGN1cnJlbnQgYWN0aXZlIHZpc2l0b3JzIGFuZCB0aGVpciBhY3Rpdml0aWVzXCIsXG4gICAgICAgIGlucHV0U2NoZW1hOiB7XG4gICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICBpbmNsdWRlTG9jYXRpb246IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluY2x1ZGUgZ2VvZ3JhcGhpYyBsb2NhdGlvbiBkYXRhXCIsXG4gICAgICAgICAgICAgIGRlZmF1bHQ6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmNsdWRlRGV2aWNlOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmNsdWRlIGRldmljZSBhbmQgYnJvd3NlciBpbmZvcm1hdGlvblwiLFxuICAgICAgICAgICAgICBkZWZhdWx0OiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiBcImlkZW50aWZ5X2hpZ2hfaW50ZW50X3Zpc2l0b3JzXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIklkZW50aWZ5IHZpc2l0b3JzIHdpdGggaGlnaCBwdXJjaGFzZS9jb252ZXJzaW9uIGludGVudFwiLFxuICAgICAgICBpbnB1dFNjaGVtYToge1xuICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgdGhyZXNob2xkOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkludGVudCBzY29yZSB0aHJlc2hvbGQgKDAtMTAwKVwiLFxuICAgICAgICAgICAgICBtaW5pbXVtOiAwLFxuICAgICAgICAgICAgICBtYXhpbXVtOiAxMDAsXG4gICAgICAgICAgICAgIGRlZmF1bHQ6IDcwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGltaXQ6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJudW1iZXJcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTWF4aW11bSBudW1iZXIgb2YgdmlzaXRvcnMgdG8gcmV0dXJuXCIsXG4gICAgICAgICAgICAgIG1pbmltdW06IDEsXG4gICAgICAgICAgICAgIG1heGltdW06IDEwMCxcbiAgICAgICAgICAgICAgZGVmYXVsdDogMjBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdO1xuXG4gICAgLy8gRmlsdGVyIHRvb2xzIGJhc2VkIG9uIHBlcm1pc3Npb25zXG4gICAgaWYgKCFhdXRoQ29udGV4dC5wZXJtaXNzaW9ucy5pbmNsdWRlcygnKicpICYmICFhdXRoQ29udGV4dC5wZXJtaXNzaW9ucy5pbmNsdWRlcygncmVhZDpvcmcnKSkge1xuICAgICAgLy8gUmVndWxhciB1c2VycyBnZXQgbGltaXRlZCB0b29sc1xuICAgICAgcmV0dXJuIHRvb2xzLmZpbHRlcih0ID0+IFsndHJhY2tfdmlzaXRvcicsICdhbmFseXplX3Zpc2l0b3JfYmVoYXZpb3InLCAnZ2V0X3JlYWxfdGltZV92aXNpdG9ycyddLmluY2x1ZGVzKHQubmFtZSkpO1xuICAgIH1cblxuICAgIHJldHVybiB0b29scztcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlIExlYWRQdWxzZSB0b29sc1xuICAgKi9cbiAgcHJvdGVjdGVkIGFzeW5jIGNhbGxUb29sKG5hbWU6IHN0cmluZywgYXJnczogYW55LCBhdXRoQ29udGV4dDogTUNQQXV0aENvbnRleHQpOiBQcm9taXNlPGFueT4ge1xuICAgIHN3aXRjaCAobmFtZSkge1xuICAgICAgY2FzZSAndHJhY2tfdmlzaXRvcic6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnRyYWNrVmlzaXRvcihhcmdzLCBhdXRoQ29udGV4dCk7XG4gICAgICBjYXNlICdhbmFseXplX3Zpc2l0b3JfYmVoYXZpb3InOlxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5hbmFseXplVmlzaXRvckJlaGF2aW9yKGFyZ3MsIGF1dGhDb250ZXh0KTtcbiAgICAgIGNhc2UgJ2dldF9jb252ZXJzaW9uX2Z1bm5lbCc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldENvbnZlcnNpb25GdW5uZWwoYXJncywgYXV0aENvbnRleHQpO1xuICAgICAgY2FzZSAnZ2V0X3BhZ2VfYW5hbHl0aWNzJzpcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0UGFnZUFuYWx5dGljcyhhcmdzLCBhdXRoQ29udGV4dCk7XG4gICAgICBjYXNlICdnZXRfcmVhbF90aW1lX3Zpc2l0b3JzJzpcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0UmVhbFRpbWVWaXNpdG9ycyhhcmdzLCBhdXRoQ29udGV4dCk7XG4gICAgICBjYXNlICdpZGVudGlmeV9oaWdoX2ludGVudF92aXNpdG9ycyc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmlkZW50aWZ5SGlnaEludGVudFZpc2l0b3JzKGFyZ3MsIGF1dGhDb250ZXh0KTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBNQ1BWYWxpZGF0aW9uRXJyb3IoYFVua25vd24gdG9vbDogJHtuYW1lfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdmlzaXRvciBkYXRhIHdpdGggcmVhbCBNQ1BWaXNpdG9yU2Vzc2lvbnMgcXVlcmllc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRWaXNpdG9yRGF0YShxdWVyeTogTGVhZFB1bHNlUXVlcnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBcbiAgICAgIC8vIEJ1aWxkIHdoZXJlIGNsYXVzZSBmb3IgdmlzaXRvciBzZXNzaW9uc1xuICAgICAgY29uc3Qgd2hlcmVDbGF1c2U6IGFueSA9IHtcbiAgICAgICAgb3JnYW5pemF0aW9uSWQ6IGF1dGhDb250ZXh0Lm9yZ2FuaXphdGlvbklkXG4gICAgICB9O1xuXG4gICAgICBpZiAocXVlcnkudmlzaXRvcklkKSB7XG4gICAgICAgIHdoZXJlQ2xhdXNlLnZpc2l0b3JJZCA9IHF1ZXJ5LnZpc2l0b3JJZDtcbiAgICAgIH1cblxuICAgICAgaWYgKHF1ZXJ5LmRhdGVGcm9tIHx8IHF1ZXJ5LmRhdGVUbykge1xuICAgICAgICB3aGVyZUNsYXVzZS5zZXNzaW9uU3RhcnQgPSB7fTtcbiAgICAgICAgaWYgKHF1ZXJ5LmRhdGVGcm9tKSB7XG4gICAgICAgICAgd2hlcmVDbGF1c2Uuc2Vzc2lvblN0YXJ0Lmd0ZSA9IG5ldyBEYXRlKHF1ZXJ5LmRhdGVGcm9tKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocXVlcnkuZGF0ZVRvKSB7XG4gICAgICAgICAgd2hlcmVDbGF1c2Uuc2Vzc2lvblN0YXJ0Lmx0ZSA9IG5ldyBEYXRlKHF1ZXJ5LmRhdGVUbyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gR2V0IHJlYWwgdmlzaXRvciBzZXNzaW9ucyBmcm9tIE1DUCB0YWJsZVxuICAgICAgY29uc3QgdmlzaXRvclNlc3Npb25zID0gYXdhaXQgcHJpc21hLm1DUFZpc2l0b3JTZXNzaW9ucy5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcbiAgICAgICAgdGFrZTogcXVlcnkubGltaXQsXG4gICAgICAgIHNraXA6IHF1ZXJ5Lm9mZnNldCxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIG9yZ2FuaXphdGlvbjoge1xuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBzZXNzaW9uU3RhcnQ6ICdkZXNjJ1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gVHJhbnNmb3JtIHNlc3Npb25zIHRvIHZpc2l0b3IgZm9ybWF0XG4gICAgICBjb25zdCB2aXNpdG9ycyA9IHZpc2l0b3JTZXNzaW9ucy5tYXAoc2Vzc2lvbiA9PiAoe1xuICAgICAgICBpZDogc2Vzc2lvbi52aXNpdG9ySWQsXG4gICAgICAgIHNlc3Npb25JZDogc2Vzc2lvbi5zZXNzaW9uSWQsXG4gICAgICAgIG9yZ2FuaXphdGlvbklkOiBzZXNzaW9uLm9yZ2FuaXphdGlvbklkLFxuICAgICAgICBzdGFydFRpbWU6IHNlc3Npb24uc2Vzc2lvblN0YXJ0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGVuZFRpbWU6IHNlc3Npb24uc2Vzc2lvbkVuZC50b0lTT1N0cmluZygpLFxuICAgICAgICBwYWdlVmlld3M6IHNlc3Npb24ucGFnZVZpZXdzLFxuICAgICAgICBkdXJhdGlvbjogc2Vzc2lvbi5kdXJhdGlvbixcbiAgICAgICAgYm91bmNlOiBzZXNzaW9uLmJvdW5jZVJhdGUgPiAwLjUsXG4gICAgICAgIGNvbnZlcnRlZDogc2Vzc2lvbi5jb252ZXJzaW9uVmFsdWUgPiAwLFxuICAgICAgICBpbnRlbnRTY29yZTogc2Vzc2lvbi5pbnRlbnRTY29yZSxcbiAgICAgICAgZ2VvTG9jYXRpb246IHtcbiAgICAgICAgICBjb3VudHJ5OiBzZXNzaW9uLmNvdW50cnksXG4gICAgICAgICAgY2l0eTogc2Vzc2lvbi5jaXR5LFxuICAgICAgICAgIHJlZ2lvbjogc2Vzc2lvbi5yZWdpb25cbiAgICAgICAgfSxcbiAgICAgICAgZGV2aWNlOiB7XG4gICAgICAgICAgdHlwZTogc2Vzc2lvbi5kZXZpY2VUeXBlLFxuICAgICAgICAgIGJyb3dzZXI6IHNlc3Npb24uYnJvd3NlcixcbiAgICAgICAgICBvczogc2Vzc2lvbi5vcGVyYXRpbmdTeXN0ZW1cbiAgICAgICAgfSxcbiAgICAgICAgdHJhZmZpYzoge1xuICAgICAgICAgIHNvdXJjZTogc2Vzc2lvbi5zb3VyY2UsXG4gICAgICAgICAgbWVkaXVtOiBzZXNzaW9uLm1lZGl1bSxcbiAgICAgICAgICBjYW1wYWlnbjogc2Vzc2lvbi5jYW1wYWlnbixcbiAgICAgICAgICByZWZlcnJlcjogc2Vzc2lvbi5yZWZlcnJlclxuICAgICAgICB9LFxuICAgICAgICBlbmdhZ2VtZW50OiB7XG4gICAgICAgICAgc2Nyb2xsRGVwdGg6IHNlc3Npb24uc2Nyb2xsRGVwdGgsXG4gICAgICAgICAgdGltZU9uUGFnZTogc2Vzc2lvbi5hdmdUaW1lT25QYWdlLFxuICAgICAgICAgIGludGVyYWN0aW9uczogc2Vzc2lvbi5pbnRlcmFjdGlvbnMsXG4gICAgICAgICAgZXhpdFBhZ2U6IHNlc3Npb24uZXhpdFBhZ2VcbiAgICAgICAgfSxcbiAgICAgICAgaW5zaWdodHM6IHNlc3Npb24uaW5zaWdodHMgPyBKU09OLnBhcnNlKHNlc3Npb24uaW5zaWdodHMpIDogW11cbiAgICAgIH0pKTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIHN1bW1hcnkgc3RhdGlzdGljc1xuICAgICAgY29uc3QgdG90YWxTZXNzaW9ucyA9IHZpc2l0b3JzLmxlbmd0aDtcbiAgICAgIGNvbnN0IHRvdGFsUGFnZVZpZXdzID0gdmlzaXRvcnMucmVkdWNlKChzdW0sIHYpID0+IHN1bSArIHYucGFnZVZpZXdzLCAwKTtcbiAgICAgIGNvbnN0IGF2Z0R1cmF0aW9uID0gdG90YWxTZXNzaW9ucyA+IDAgPyB2aXNpdG9ycy5yZWR1Y2UoKHN1bSwgdikgPT4gc3VtICsgdi5kdXJhdGlvbiwgMCkgLyB0b3RhbFNlc3Npb25zIDogMDtcbiAgICAgIGNvbnN0IGJvdW5jZVJhdGUgPSB0b3RhbFNlc3Npb25zID4gMCA/IHZpc2l0b3JzLmZpbHRlcih2ID0+IHYuYm91bmNlKS5sZW5ndGggLyB0b3RhbFNlc3Npb25zIDogMDtcbiAgICAgIGNvbnN0IGNvbnZlcnNpb25SYXRlID0gdG90YWxTZXNzaW9ucyA+IDAgPyB2aXNpdG9ycy5maWx0ZXIodiA9PiB2LmNvbnZlcnRlZCkubGVuZ3RoIC8gdG90YWxTZXNzaW9ucyA6IDA7XG4gICAgICBjb25zdCBhdmdJbnRlbnRTY29yZSA9IHRvdGFsU2Vzc2lvbnMgPiAwID8gdmlzaXRvcnMucmVkdWNlKChzdW0sIHYpID0+IHN1bSArIHYuaW50ZW50U2NvcmUsIDApIC8gdG90YWxTZXNzaW9ucyA6IDA7XG5cbiAgICAgIC8vIERldmljZSBhbmQgbG9jYXRpb24gZGlzdHJpYnV0aW9uXG4gICAgICBjb25zdCBkZXZpY2VEaXN0cmlidXRpb24gPSB2aXNpdG9ycy5yZWR1Y2UoKGFjYzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiwgdikgPT4ge1xuICAgICAgICBhY2Nbdi5kZXZpY2UudHlwZV0gPSAoYWNjW3YuZGV2aWNlLnR5cGVdIHx8IDApICsgMTtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sIHt9KTtcblxuICAgICAgY29uc3QgY291bnRyeURpc3RyaWJ1dGlvbiA9IHZpc2l0b3JzLnJlZHVjZSgoYWNjOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LCB2KSA9PiB7XG4gICAgICAgIGFjY1t2Lmdlb0xvY2F0aW9uLmNvdW50cnldID0gKGFjY1t2Lmdlb0xvY2F0aW9uLmNvdW50cnldIHx8IDApICsgMTtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sIHt9KTtcblxuICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuXG4gICAgICAvLyBMb2cgcmVzb3VyY2UgYWNjZXNzXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFJlc291cmNlQWNjZXNzKFxuICAgICAgICBhdXRoQ29udGV4dCxcbiAgICAgICAgJ2xlYWRwdWxzZTovL3Zpc2l0b3JzJyxcbiAgICAgICAgJ0xJU1QnLFxuICAgICAgICAnc3VjY2VzcycsXG4gICAgICAgIHsgZHVyYXRpb24sIGRhdGFTaXplOiB2aXNpdG9ycy5sZW5ndGggfVxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXJpOiBcImxlYWRwdWxzZTovL3Zpc2l0b3JzXCIsXG4gICAgICAgIG1pbWVUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIHZpc2l0b3JzLFxuICAgICAgICAgIHN1bW1hcnk6IHtcbiAgICAgICAgICAgIHRvdGFsU2Vzc2lvbnMsXG4gICAgICAgICAgICB0b3RhbFBhZ2VWaWV3cyxcbiAgICAgICAgICAgIGF2ZXJhZ2VEdXJhdGlvbjogTWF0aC5yb3VuZChhdmdEdXJhdGlvbiksXG4gICAgICAgICAgICBib3VuY2VSYXRlOiBNYXRoLnJvdW5kKGJvdW5jZVJhdGUgKiAxMDAgKiAxMDApIC8gMTAwLFxuICAgICAgICAgICAgY29udmVyc2lvblJhdGU6IE1hdGgucm91bmQoY29udmVyc2lvblJhdGUgKiAxMDAgKiAxMDApIC8gMTAwLFxuICAgICAgICAgICAgYXZnSW50ZW50U2NvcmU6IE1hdGgucm91bmQoYXZnSW50ZW50U2NvcmUgKiAxMDApIC8gMTAwLFxuICAgICAgICAgICAgZGV2aWNlRGlzdHJpYnV0aW9uLFxuICAgICAgICAgICAgY291bnRyeURpc3RyaWJ1dGlvblxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWV0YToge1xuICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgbGltaXQ6IHF1ZXJ5LmxpbWl0LFxuICAgICAgICAgICAgICBvZmZzZXQ6IHF1ZXJ5Lm9mZnNldCxcbiAgICAgICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IGF1dGhDb250ZXh0Lm9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdG90YWw6IHZpc2l0b3JzLmxlbmd0aCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBzb3VyY2U6ICdNQ1BfVklTSVRPUl9TRVNTSU9OUydcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBMb2cgZmFpbGVkIGFjY2Vzc1xuICAgICAgYXdhaXQgdGhpcy5sb2dNQ1BSZXNvdXJjZUFjY2VzcyhcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICdsZWFkcHVsc2U6Ly92aXNpdG9ycycsXG4gICAgICAgICdMSVNUJyxcbiAgICAgICAgJ2ZhaWx1cmUnLFxuICAgICAgICB7IGVycm9yTWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicgfVxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuY3JlYXRlRmFsbGJhY2tSZXNwb25zZShcbiAgICAgICAgKCkgPT4gdGhpcy5nZXRWaXNpdG9yRGF0YUZhbGxiYWNrKHF1ZXJ5LCBhdXRoQ29udGV4dCksXG4gICAgICAgICdGYWlsZWQgdG8gcmV0cmlldmUgdmlzaXRvciBkYXRhIHZpYSBNQ1AnXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUcmFjayB2aXNpdG9yIHRvb2wgd2l0aCByZWFsIGRhdGFcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgdHJhY2tWaXNpdG9yKGFyZ3M6IGFueSwgYXV0aENvbnRleHQ6IE1DUEF1dGhDb250ZXh0KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IHZpc2l0b3JJZCwgaW5jbHVkZUpvdXJuZXkgPSB0cnVlLCBpbmNsdWRlSGVhdG1hcCA9IGZhbHNlIH0gPSBhcmdzO1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICB0cnkge1xuICAgICAgLy8gTG9nIHRvb2wgZXhlY3V0aW9uXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFRvb2xFeGVjdXRpb24oXG4gICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAndHJhY2tfdmlzaXRvcicsXG4gICAgICAgIGFyZ3MsXG4gICAgICAgICdzdWNjZXNzJyxcbiAgICAgICAgeyBkdXJhdGlvbjogMCwgcmlza0xldmVsOiAnbG93JyB9XG4gICAgICApO1xuXG4gICAgICAvLyBHZXQgdmlzaXRvciBzZXNzaW9ucyBmcm9tIE1DUCB0YWJsZVxuICAgICAgY29uc3QgdmlzaXRvclNlc3Npb25zID0gYXdhaXQgcHJpc21hLm1DUFZpc2l0b3JTZXNzaW9ucy5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgdmlzaXRvcklkLFxuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZFxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgb3JnYW5pemF0aW9uOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeToge1xuICAgICAgICAgIHNlc3Npb25TdGFydDogJ2Rlc2MnXG4gICAgICAgIH0sXG4gICAgICAgIHRha2U6IDEwIC8vIExhc3QgMTAgc2Vzc2lvbnMgZm9yIGFuYWx5c2lzXG4gICAgICB9KTtcblxuICAgICAgaWYgKHZpc2l0b3JTZXNzaW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgICBcbiAgICAgICAgYXdhaXQgdGhpcy5sb2dNQ1BUb29sRXhlY3V0aW9uKFxuICAgICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAgICd0cmFja192aXNpdG9yJyxcbiAgICAgICAgICBhcmdzLFxuICAgICAgICAgICdmYWlsdXJlJyxcbiAgICAgICAgICB7IFxuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBlcnJvck1lc3NhZ2U6ICdWaXNpdG9yIG5vdCBmb3VuZCcsXG4gICAgICAgICAgICByaXNrTGV2ZWw6ICdsb3cnXG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29udGVudDogW3tcbiAgICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgZXJyb3I6IFwiVmlzaXRvciBub3QgZm91bmRcIixcbiAgICAgICAgICAgICAgdmlzaXRvcklkXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1dLFxuICAgICAgICAgIGlzRXJyb3I6IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gR2V0IGN1cnJlbnQgKG1vc3QgcmVjZW50KSBzZXNzaW9uXG4gICAgICBjb25zdCBjdXJyZW50U2Vzc2lvbiA9IHZpc2l0b3JTZXNzaW9uc1swXTtcbiAgICAgIFxuICAgICAgLy8gQ2FsY3VsYXRlIHZpc2l0b3IgcHJvZmlsZSBmcm9tIGFsbCBzZXNzaW9uc1xuICAgICAgY29uc3QgdG90YWxTZXNzaW9ucyA9IHZpc2l0b3JTZXNzaW9ucy5sZW5ndGg7XG4gICAgICBjb25zdCB0b3RhbFBhZ2VWaWV3cyA9IHZpc2l0b3JTZXNzaW9ucy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy5wYWdlVmlld3MsIDApO1xuICAgICAgY29uc3QgYXZnU2Vzc2lvbkR1cmF0aW9uID0gdmlzaXRvclNlc3Npb25zLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLmR1cmF0aW9uLCAwKSAvIHRvdGFsU2Vzc2lvbnM7XG4gICAgICBjb25zdCB0b3RhbENvbnZlcnNpb25zID0gdmlzaXRvclNlc3Npb25zLmZpbHRlcihzID0+IHMuY29udmVyc2lvblZhbHVlID4gMCkubGVuZ3RoO1xuICAgICAgY29uc3QgYXZnSW50ZW50U2NvcmUgPSB2aXNpdG9yU2Vzc2lvbnMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuaW50ZW50U2NvcmUsIDApIC8gdG90YWxTZXNzaW9ucztcblxuICAgICAgLy8gRGV0ZXJtaW5lIGlmIHJldHVybmluZyB2aXNpdG9yXG4gICAgICBjb25zdCBpc1JldHVybmluZyA9IHRvdGFsU2Vzc2lvbnMgPiAxO1xuICAgICAgY29uc3QgZmlyc3RTZXNzaW9uRGF0ZSA9IHZpc2l0b3JTZXNzaW9uc1t2aXNpdG9yU2Vzc2lvbnMubGVuZ3RoIC0gMV0uc2Vzc2lvblN0YXJ0O1xuICAgICAgY29uc3QgbGFzdFNlc3Npb25EYXRlID0gdmlzaXRvclNlc3Npb25zWzBdLnNlc3Npb25TdGFydDtcblxuICAgICAgLy8gQnVpbGQgdmlzaXRvciBwcm9maWxlXG4gICAgICBjb25zdCB2aXNpdG9yRGF0YSA9IHtcbiAgICAgICAgaWQ6IHZpc2l0b3JJZCxcbiAgICAgICAgY3VycmVudFNlc3Npb246IHtcbiAgICAgICAgICBzZXNzaW9uSWQ6IGN1cnJlbnRTZXNzaW9uLnNlc3Npb25JZCxcbiAgICAgICAgICBzdGFydFRpbWU6IGN1cnJlbnRTZXNzaW9uLnNlc3Npb25TdGFydC50b0lTT1N0cmluZygpLFxuICAgICAgICAgIGVuZFRpbWU6IGN1cnJlbnRTZXNzaW9uLnNlc3Npb25FbmQudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBjdXJyZW50UGFnZTogY3VycmVudFNlc3Npb24uZXhpdFBhZ2UgfHwgY3VycmVudFNlc3Npb24ubGFuZGluZ1BhZ2UsXG4gICAgICAgICAgcGFnZVZpZXdzOiBjdXJyZW50U2Vzc2lvbi5wYWdlVmlld3MsXG4gICAgICAgICAgZHVyYXRpb246IGN1cnJlbnRTZXNzaW9uLmR1cmF0aW9uLFxuICAgICAgICAgIGludGVyYWN0aW9uczogY3VycmVudFNlc3Npb24uaW50ZXJhY3Rpb25zLFxuICAgICAgICAgIGludGVudFNjb3JlOiBjdXJyZW50U2Vzc2lvbi5pbnRlbnRTY29yZSxcbiAgICAgICAgICBzY3JvbGxEZXB0aDogY3VycmVudFNlc3Npb24uc2Nyb2xsRGVwdGgsXG4gICAgICAgICAgYm91bmNlZDogY3VycmVudFNlc3Npb24uYm91bmNlUmF0ZSA+IDAuNSxcbiAgICAgICAgICBjb252ZXJ0ZWQ6IGN1cnJlbnRTZXNzaW9uLmNvbnZlcnNpb25WYWx1ZSA+IDAsXG4gICAgICAgICAgY29udmVyc2lvblZhbHVlOiBjdXJyZW50U2Vzc2lvbi5jb252ZXJzaW9uVmFsdWVcbiAgICAgICAgfSxcbiAgICAgICAgcHJvZmlsZToge1xuICAgICAgICAgIGlzUmV0dXJuaW5nLFxuICAgICAgICAgIHRvdGFsU2Vzc2lvbnMsXG4gICAgICAgICAgdG90YWxQYWdlVmlld3MsXG4gICAgICAgICAgdG90YWxDb252ZXJzaW9ucyxcbiAgICAgICAgICBhdmVyYWdlU2Vzc2lvbkR1cmF0aW9uOiBNYXRoLnJvdW5kKGF2Z1Nlc3Npb25EdXJhdGlvbiksXG4gICAgICAgICAgYXZlcmFnZUludGVudFNjb3JlOiBNYXRoLnJvdW5kKGF2Z0ludGVudFNjb3JlICogMTAwKSAvIDEwMCxcbiAgICAgICAgICBmaXJzdFNlZW46IGZpcnN0U2Vzc2lvbkRhdGUudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBsYXN0U2VlbjogbGFzdFNlc3Npb25EYXRlLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgZGF5c1NpbmNlRmlyc3RWaXNpdDogTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAtIGZpcnN0U2Vzc2lvbkRhdGUuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSlcbiAgICAgICAgfSxcbiAgICAgICAgZ2VvTG9jYXRpb246IHtcbiAgICAgICAgICBjb3VudHJ5OiBjdXJyZW50U2Vzc2lvbi5jb3VudHJ5LFxuICAgICAgICAgIGNpdHk6IGN1cnJlbnRTZXNzaW9uLmNpdHksXG4gICAgICAgICAgcmVnaW9uOiBjdXJyZW50U2Vzc2lvbi5yZWdpb24sXG4gICAgICAgICAgdGltZXpvbmU6IHRoaXMuZ2V0VGltZXpvbmVGcm9tQ291bnRyeShjdXJyZW50U2Vzc2lvbi5jb3VudHJ5KVxuICAgICAgICB9LFxuICAgICAgICBkZXZpY2U6IHtcbiAgICAgICAgICB0eXBlOiBjdXJyZW50U2Vzc2lvbi5kZXZpY2VUeXBlLFxuICAgICAgICAgIGJyb3dzZXI6IGN1cnJlbnRTZXNzaW9uLmJyb3dzZXIsXG4gICAgICAgICAgb3M6IGN1cnJlbnRTZXNzaW9uLm9wZXJhdGluZ1N5c3RlbVxuICAgICAgICB9LFxuICAgICAgICB0cmFmZmljU291cmNlOiB7XG4gICAgICAgICAgc291cmNlOiBjdXJyZW50U2Vzc2lvbi5zb3VyY2UsXG4gICAgICAgICAgbWVkaXVtOiBjdXJyZW50U2Vzc2lvbi5tZWRpdW0sXG4gICAgICAgICAgY2FtcGFpZ246IGN1cnJlbnRTZXNzaW9uLmNhbXBhaWduLFxuICAgICAgICAgIHJlZmVycmVyOiBjdXJyZW50U2Vzc2lvbi5yZWZlcnJlclxuICAgICAgICB9LFxuICAgICAgICBiZWhhdmlvcmFsOiB7XG4gICAgICAgICAgYXZnVGltZU9uUGFnZTogY3VycmVudFNlc3Npb24uYXZnVGltZU9uUGFnZSxcbiAgICAgICAgICBib3VuY2VSYXRlOiB0aGlzLmNhbGN1bGF0ZVZpc2l0b3JCb3VuY2VSYXRlKHZpc2l0b3JTZXNzaW9ucyksXG4gICAgICAgICAgY29udmVyc2lvblJhdGU6IHRvdGFsQ29udmVyc2lvbnMgLyB0b3RhbFNlc3Npb25zICogMTAwLFxuICAgICAgICAgIGVuZ2FnZW1lbnRTY29yZTogdGhpcy5jYWxjdWxhdGVFbmdhZ2VtZW50U2NvcmUodmlzaXRvclNlc3Npb25zKVxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvLyBBZGQgam91cm5leSBkYXRhIGlmIHJlcXVlc3RlZFxuICAgICAgaWYgKGluY2x1ZGVKb3VybmV5KSB7XG4gICAgICAgIHZpc2l0b3JEYXRhLmpvdXJuZXkgPSB0aGlzLmJ1aWxkVmlzaXRvckpvdXJuZXkodmlzaXRvclNlc3Npb25zKTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIGluc2lnaHRzXG4gICAgICB2aXNpdG9yRGF0YS5pbnNpZ2h0cyA9IHRoaXMuZ2VuZXJhdGVWaXNpdG9ySW5zaWdodHModmlzaXRvckRhdGEsIHZpc2l0b3JTZXNzaW9ucyk7XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgLy8gTG9nIHN1Y2Nlc3NmdWwgdG9vbCBleGVjdXRpb25cbiAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICd0cmFja192aXNpdG9yJyxcbiAgICAgICAgYXJncyxcbiAgICAgICAgJ3N1Y2Nlc3MnLFxuICAgICAgICB7IFxuICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgIG91dHB1dFNpemU6IDEsXG4gICAgICAgICAgcmlza0xldmVsOiBpbmNsdWRlSm91cm5leSA/ICdtZWRpdW0nIDogJ2xvdydcbiAgICAgICAgfVxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29udGVudDogW3tcbiAgICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgZGF0YTogdmlzaXRvckRhdGEsXG4gICAgICAgICAgICBtZXRhOiB7XG4gICAgICAgICAgICAgIGluY2x1ZGVKb3VybmV5LFxuICAgICAgICAgICAgICBpbmNsdWRlSGVhdG1hcCxcbiAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgICBzb3VyY2U6ICdNQ1BfVklTSVRPUl9TRVNTSU9OUydcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgXG4gICAgICAvLyBMb2cgZmFpbGVkIHRvb2wgZXhlY3V0aW9uXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFRvb2xFeGVjdXRpb24oXG4gICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAndHJhY2tfdmlzaXRvcicsXG4gICAgICAgIGFyZ3MsXG4gICAgICAgICdmYWlsdXJlJyxcbiAgICAgICAgeyBcbiAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICBlcnJvck1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgIHJpc2tMZXZlbDogJ21lZGl1bSdcbiAgICAgICAgfVxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29udGVudDogW3tcbiAgICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBcIkZhaWxlZCB0byB0cmFjayB2aXNpdG9yXCIsXG4gICAgICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgIH0pXG4gICAgICAgIH1dLFxuICAgICAgICBpc0Vycm9yOiB0cnVlXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFseXplIHZpc2l0b3IgYmVoYXZpb3IgdG9vbFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplVmlzaXRvckJlaGF2aW9yKGFyZ3M6IGFueSwgYXV0aENvbnRleHQ6IE1DUEF1dGhDb250ZXh0KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IHZpc2l0b3JJZCwgc2Vzc2lvbklkLCB0aW1lUmFuZ2UgPSAnN2QnIH0gPSBhcmdzO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFBsYWNlaG9sZGVyIGJlaGF2aW9yIGFuYWx5c2lzXG4gICAgICBjb25zdCBiZWhhdmlvckFuYWx5c2lzID0ge1xuICAgICAgICB2aXNpdG9ySWQsXG4gICAgICAgIHNlc3Npb25JZCxcbiAgICAgICAgdGltZVJhbmdlLFxuICAgICAgICBiZWhhdmlvclBhdHRlcm46IHtcbiAgICAgICAgICBwYWdlVmlld3NQZXJTZXNzaW9uOiA2LjUsXG4gICAgICAgICAgYXZlcmFnZVNlc3Npb25EdXJhdGlvbjogNDIwLFxuICAgICAgICAgIGJvdW5jZVJhdGU6IDAuMTUsXG4gICAgICAgICAgY29udmVyc2lvblJhdGU6IDAuMDgsXG4gICAgICAgICAgZW5nYWdlbWVudFNjb3JlOiA3OFxuICAgICAgICB9LFxuICAgICAgICBpbnRlcmVzdHM6IFtcbiAgICAgICAgICB7IGNhdGVnb3J5OiAnUHJlbWl1bSBTZXJ2aWNlcycsIHNjb3JlOiA5MiB9LFxuICAgICAgICAgIHsgY2F0ZWdvcnk6ICdBbmFseXRpY3MnLCBzY29yZTogNzggfSxcbiAgICAgICAgICB7IGNhdGVnb3J5OiAnQXV0b21hdGlvbicsIHNjb3JlOiA2NSB9XG4gICAgICAgIF0sXG4gICAgICAgIGFjdGlvbnM6IHtcbiAgICAgICAgICB0b3RhbENsaWNrczogNDUsXG4gICAgICAgICAgZm9ybVN1Ym1pc3Npb25zOiAyLFxuICAgICAgICAgIGRvd25sb2FkUmVxdWVzdHM6IDEsXG4gICAgICAgICAgc29jaWFsU2hhcmVzOiAwXG4gICAgICAgIH0sXG4gICAgICAgIHByZWRpY3Rpb25zOiB7XG4gICAgICAgICAgbGlrZWxpaG9vZFRvQ29udmVydDogMC43NCxcbiAgICAgICAgICB0aW1lVG9Db252ZXJzaW9uOiAnMi0zIGRheXMnLFxuICAgICAgICAgIHByZWZlcnJlZENoYW5uZWw6ICdlbWFpbCcsXG4gICAgICAgICAgbmV4dEJlc3RBY3Rpb246ICdTZW5kIHRhcmdldGVkIHByZW1pdW0gc2VydmljZSBvZmZlcidcbiAgICAgICAgfSxcbiAgICAgICAgaW5zaWdodHM6IFtcbiAgICAgICAgICBcIlZpc2l0b3Igc2hvd3MgaGlnaCBlbmdhZ2VtZW50IHdpdGggcHJlbWl1bSBjb250ZW50XCIsXG4gICAgICAgICAgXCJNdWx0aXBsZSByZXR1cm4gc2Vzc2lvbnMgaW5kaWNhdGUgc3Ryb25nIGludGVyZXN0XCIsXG4gICAgICAgICAgXCJCZWhhdmlvciBwYXR0ZXJuIHN1Z2dlc3RzIHJlYWRpbmVzcyB0byBwdXJjaGFzZVwiLFxuICAgICAgICAgIFwiUmVjb21tZW5kZWQ6IFNlbmQgcGVyc29uYWxpemVkIG9mZmVyIHdpdGhpbiAyNCBob3Vyc1wiXG4gICAgICAgIF1cbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IGJlaGF2aW9yQW5hbHlzaXMsXG4gICAgICAgICAgICBtZXRhOiB7XG4gICAgICAgICAgICAgIHRpbWVSYW5nZSxcbiAgICAgICAgICAgICAgYW5hbHlzaXNUeXBlOiAnYmVoYXZpb3JhbCcsXG4gICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICBmYWxsYmFja1VzZWQ6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29udGVudDogW3tcbiAgICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBcIkZhaWxlZCB0byBhbmFseXplIHZpc2l0b3IgYmVoYXZpb3JcIixcbiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgfSlcbiAgICAgICAgfV0sXG4gICAgICAgIGlzRXJyb3I6IHRydWVcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjb252ZXJzaW9uIGZ1bm5lbCB0b29sXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldENvbnZlcnNpb25GdW5uZWwoYXJnczogYW55LCBhdXRoQ29udGV4dDogTUNQQXV0aENvbnRleHQpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHsgZnVubmVsSWQsIGRhdGVSYW5nZSA9ICczMGQnLCBpbmNsdWRlU2VnbWVudHMgPSBmYWxzZSB9ID0gYXJncztcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIENhbGN1bGF0ZSBkYXRlIHJhbmdlXG4gICAgICBjb25zdCBkYXlzQmFjayA9IHRoaXMucGFyc2VEYXRlUmFuZ2UoZGF0ZVJhbmdlKTtcbiAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKERhdGUubm93KCkgLSBkYXlzQmFjayAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuXG4gICAgICAvLyBHZXQgdmlzaXRvciBzZXNzaW9ucyBkYXRhIGZvciBmdW5uZWwgYW5hbHlzaXNcbiAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgcHJpc21hLm1DUFZpc2l0b3JTZXNzaW9ucy5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IGF1dGhDb250ZXh0Lm9yZ2FuaXphdGlvbklkLFxuICAgICAgICAgIHNlc3Npb25TdGFydDoge1xuICAgICAgICAgICAgZ3RlOiBzdGFydERhdGVcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBzZXNzaW9uU3RhcnQ6ICdhc2MnXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBEZWZpbmUgZnVubmVsIHN0ZXBzIGJhc2VkIG9uIGNvbW1vbiBjdXN0b21lciBqb3VybmV5XG4gICAgICBjb25zdCBmdW5uZWxTdGVwcyA9IFtcbiAgICAgICAgeyBuYW1lOiAnTGFuZGluZyBQYWdlIFZpc2l0JywgcGFnZVBhdHRlcm46ICcvJyB9LFxuICAgICAgICB7IG5hbWU6ICdQcm9kdWN0L1NlcnZpY2UgVmlldycsIHBhZ2VQYXR0ZXJuOiAnL2ZlYXR1cmVzfC9wcm9kdWN0c3wvc2VydmljZXMnIH0sXG4gICAgICAgIHsgbmFtZTogJ1ByaWNpbmcgUGFnZSBWaWV3JywgcGFnZVBhdHRlcm46ICcvcHJpY2luZycgfSxcbiAgICAgICAgeyBuYW1lOiAnQ29udGFjdC9EZW1vIFJlcXVlc3QnLCBwYWdlUGF0dGVybjogJy9jb250YWN0fC9kZW1vfC9zaWdudXAnIH0sXG4gICAgICAgIHsgbmFtZTogJ0NvbnZlcnNpb24nLCBjb252ZXJzaW9uUmVxdWlyZWQ6IHRydWUgfVxuICAgICAgXTtcblxuICAgICAgLy8gQW5hbHl6ZSB2aXNpdG9yIHByb2dyZXNzaW9uIHRocm91Z2ggZnVubmVsXG4gICAgICBjb25zdCBmdW5uZWxEYXRhID0gdGhpcy5hbmFseXplRnVubmVsUHJvZ3Jlc3Npb24oc2Vzc2lvbnMsIGZ1bm5lbFN0ZXBzKTtcblxuICAgICAgLy8gQWRkIHNlZ21lbnQgYW5hbHlzaXMgaWYgcmVxdWVzdGVkXG4gICAgICBsZXQgc2VnbWVudERhdGEgPSB1bmRlZmluZWQ7XG4gICAgICBpZiAoaW5jbHVkZVNlZ21lbnRzKSB7XG4gICAgICAgIHNlZ21lbnREYXRhID0gYXdhaXQgdGhpcy5hbmFseXplRnVubmVsQnlTZWdtZW50cyhzZXNzaW9ucywgZnVubmVsU3RlcHMsIGF1dGhDb250ZXh0KTtcbiAgICAgIH1cblxuICAgICAgLy8gR2VuZXJhdGUgaW5zaWdodHMgYmFzZWQgb24gcmVhbCBkYXRhXG4gICAgICBjb25zdCBpbnNpZ2h0cyA9IHRoaXMuZ2VuZXJhdGVGdW5uZWxJbnNpZ2h0cyhmdW5uZWxEYXRhLnN0ZXBzLCBzZWdtZW50RGF0YSk7XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgLy8gTG9nIHRvb2wgZXhlY3V0aW9uXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFRvb2xFeGVjdXRpb24oXG4gICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAnZ2V0X2NvbnZlcnNpb25fZnVubmVsJyxcbiAgICAgICAgYXJncyxcbiAgICAgICAgJ3N1Y2Nlc3MnLFxuICAgICAgICB7IFxuICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgIG91dHB1dFNpemU6IGZ1bm5lbERhdGEuc3RlcHMubGVuZ3RoLFxuICAgICAgICAgIHJpc2tMZXZlbDogJ2xvdydcbiAgICAgICAgfVxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICBmdW5uZWxJZDogZnVubmVsSWQgfHwgJ29yZ2FuaXphdGlvbi1mdW5uZWwnLFxuICAgICAgICBkYXRlUmFuZ2UsXG4gICAgICAgIHRvdGFsU2Vzc2lvbnM6IHNlc3Npb25zLmxlbmd0aCxcbiAgICAgICAgdGltZWZyYW1lOiB7XG4gICAgICAgICAgc3RhcnREYXRlOiBzdGFydERhdGUudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBlbmREYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgZGF5c0FuYWx5emVkOiBkYXlzQmFja1xuICAgICAgICB9LFxuICAgICAgICBzdGVwczogZnVubmVsRGF0YS5zdGVwcyxcbiAgICAgICAgb3ZlcmFsbENvbnZlcnNpb246IGZ1bm5lbERhdGEub3ZlcmFsbENvbnZlcnNpb24sXG4gICAgICAgIHRvdGFsUmV2ZW51ZTogZnVubmVsRGF0YS50b3RhbFJldmVudWUsXG4gICAgICAgIGF2ZXJhZ2VPcmRlclZhbHVlOiBmdW5uZWxEYXRhLmF2ZXJhZ2VPcmRlclZhbHVlLFxuICAgICAgICBzZWdtZW50czogc2VnbWVudERhdGEsXG4gICAgICAgIGluc2lnaHRzLFxuICAgICAgICBwZXJmb3JtYW5jZToge1xuICAgICAgICAgIGJlc3RQZXJmb3JtaW5nU3RlcDogZnVubmVsRGF0YS5iZXN0U3RlcCxcbiAgICAgICAgICB3b3JzdFBlcmZvcm1pbmdTdGVwOiBmdW5uZWxEYXRhLndvcnN0U3RlcCxcbiAgICAgICAgICBiaWdnZXN0RHJvcE9mZjogZnVubmVsRGF0YS5iaWdnZXN0RHJvcE9mZlxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250ZW50OiBbe1xuICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICBtZXRhOiB7XG4gICAgICAgICAgICAgIGRhdGVSYW5nZSxcbiAgICAgICAgICAgICAgaW5jbHVkZVNlZ21lbnRzLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICAgIHNvdXJjZTogJ01DUF9WSVNJVE9SX1NFU1NJT05TJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH1dXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250ZW50OiBbe1xuICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3I6IFwiRmFpbGVkIHRvIGdldCBjb252ZXJzaW9uIGZ1bm5lbFwiLFxuICAgICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICB9KVxuICAgICAgICB9XSxcbiAgICAgICAgaXNFcnJvcjogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHBhZ2UgYW5hbHl0aWNzIHRvb2xcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0UGFnZUFuYWx5dGljcyhhcmdzOiBhbnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgeyBwYWdlVXJsLCBpbmNsdWRlSGVhdG1hcCA9IHRydWUsIGRhdGVSYW5nZSA9ICc3ZCcgfSA9IGFyZ3M7XG5cbiAgICB0cnkge1xuICAgICAgLy8gUGxhY2Vob2xkZXIgcGFnZSBhbmFseXRpY3NcbiAgICAgIGNvbnN0IHBhZ2VBbmFseXRpY3MgPSB7XG4gICAgICAgIHBhZ2VVcmwsXG4gICAgICAgIGRhdGVSYW5nZSxcbiAgICAgICAgbWV0cmljczoge1xuICAgICAgICAgIHBhZ2VWaWV3czogMjUwMCxcbiAgICAgICAgICB1bmlxdWVWaXNpdG9yczogMTgwMCxcbiAgICAgICAgICBhdmVyYWdlVGltZU9uUGFnZTogMTgwLFxuICAgICAgICAgIGJvdW5jZVJhdGU6IDAuMzUsXG4gICAgICAgICAgZXhpdFJhdGU6IDAuNDIsXG4gICAgICAgICAgc2Nyb2xsRGVwdGg6IDAuNjgsXG4gICAgICAgICAgY2xpY2tUaHJvdWdoUmF0ZTogMC4xNVxuICAgICAgICB9LFxuICAgICAgICBoZWF0bWFwRGF0YTogaW5jbHVkZUhlYXRtYXAgPyB7XG4gICAgICAgICAgY2xpY2tNYXA6IHtcbiAgICAgICAgICAgIGhlYWRlck5hdjogNDUsXG4gICAgICAgICAgICBwcmltYXJ5Q1RBOiAxMjAsXG4gICAgICAgICAgICBzZWNvbmRhcnlDVEE6IDY3LFxuICAgICAgICAgICAgZm9vdGVyOiAyM1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2Nyb2xsTWFwOiB7XG4gICAgICAgICAgICAnMC0yNSUnOiAxMDAsXG4gICAgICAgICAgICAnMjUtNTAlJzogODUsXG4gICAgICAgICAgICAnNTAtNzUlJzogNjgsXG4gICAgICAgICAgICAnNzUtMTAwJSc6IDQyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhdHRlbnRpb25NYXA6IHtcbiAgICAgICAgICAgIGhlcm86IDguNSxcbiAgICAgICAgICAgIGZlYXR1cmVzOiA2LjIsXG4gICAgICAgICAgICBwcmljaW5nOiA3LjgsXG4gICAgICAgICAgICB0ZXN0aW1vbmlhbHM6IDQuMVxuICAgICAgICAgIH1cbiAgICAgICAgfSA6IHVuZGVmaW5lZCxcbiAgICAgICAgaW5zaWdodHM6IFtcbiAgICAgICAgICBcIlByaW1hcnkgQ1RBIGhhcyBnb29kIGVuZ2FnZW1lbnQgKDEyMCBjbGlja3MpXCIsXG4gICAgICAgICAgXCJVc2VycyB0ZW5kIHRvIGRyb3Agb2ZmIGF0IDUwJSBzY3JvbGwgZGVwdGhcIixcbiAgICAgICAgICBcIlByaWNpbmcgc2VjdGlvbiBnZXRzIGhpZ2ggYXR0ZW50aW9uICg3Ljggc2Vjb25kcyBhdmVyYWdlKVwiLFxuICAgICAgICAgIFwiQ29uc2lkZXIgbW92aW5nIHRlc3RpbW9uaWFscyBoaWdoZXIgdXAgdGhlIHBhZ2VcIlxuICAgICAgICBdXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250ZW50OiBbe1xuICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBwYWdlQW5hbHl0aWNzLFxuICAgICAgICAgICAgbWV0YToge1xuICAgICAgICAgICAgICBwYWdlVXJsLFxuICAgICAgICAgICAgICBkYXRlUmFuZ2UsXG4gICAgICAgICAgICAgIGluY2x1ZGVIZWF0bWFwLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgZmFsbGJhY2tVc2VkOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfV1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogXCJGYWlsZWQgdG8gZ2V0IHBhZ2UgYW5hbHl0aWNzXCIsXG4gICAgICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgIH0pXG4gICAgICAgIH1dLFxuICAgICAgICBpc0Vycm9yOiB0cnVlXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcmVhbC10aW1lIHZpc2l0b3JzIHRvb2wgd2l0aCBhY3R1YWwgdmlzaXRvciBzZXNzaW9uIGRhdGFcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0UmVhbFRpbWVWaXNpdG9ycyhhcmdzOiBhbnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgeyBpbmNsdWRlTG9jYXRpb24gPSB0cnVlLCBpbmNsdWRlRGV2aWNlID0gdHJ1ZSB9ID0gYXJncztcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIExvZyB0b29sIGV4ZWN1dGlvblxuICAgICAgYXdhaXQgdGhpcy5sb2dNQ1BUb29sRXhlY3V0aW9uKFxuICAgICAgICBhdXRoQ29udGV4dCxcbiAgICAgICAgJ2dldF9yZWFsX3RpbWVfdmlzaXRvcnMnLFxuICAgICAgICBhcmdzLFxuICAgICAgICAnc3VjY2VzcycsXG4gICAgICAgIHsgZHVyYXRpb246IDAsIHJpc2tMZXZlbDogJ2xvdycgfVxuICAgICAgKTtcblxuICAgICAgLy8gRGVmaW5lIFwicmVhbC10aW1lXCIgYXMgc2Vzc2lvbnMgdGhhdCBhcmUgc3RpbGwgYWN0aXZlICh3aXRoaW4gbGFzdCAzMCBtaW51dGVzKVxuICAgICAgY29uc3QgdGhpcnR5TWludXRlc0FnbyA9IG5ldyBEYXRlKERhdGUubm93KCkgLSAzMCAqIDYwICogMTAwMCk7XG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAvLyBHZXQgY3VycmVudGx5IGFjdGl2ZSB2aXNpdG9yIHNlc3Npb25zXG4gICAgICBjb25zdCBhY3RpdmVTZXNzaW9ucyA9IGF3YWl0IHByaXNtYS5tQ1BWaXNpdG9yU2Vzc2lvbnMuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZCxcbiAgICAgICAgICBzZXNzaW9uU3RhcnQ6IHtcbiAgICAgICAgICAgIGd0ZTogdGhpcnR5TWludXRlc0Fnb1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2Vzc2lvbkVuZDoge1xuICAgICAgICAgICAgZ3RlOiB0aGlydHlNaW51dGVzQWdvIC8vIFNlc3Npb25zIHRoYXQgZW5kZWQgcmVjZW50bHkgb3IgYXJlIHN0aWxsIG9uZ29pbmdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBvcmdhbml6YXRpb246IHtcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgc2Vzc2lvblN0YXJ0OiAnZGVzYydcbiAgICAgICAgfSxcbiAgICAgICAgdGFrZTogNTAgLy8gTGltaXQgZm9yIHBlcmZvcm1hbmNlXG4gICAgICB9KTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGN1cnJlbnQgdmlzaXRvciBjb3VudCAodW5pcXVlIHZpc2l0b3JzIGluIGxhc3QgMzAgbWludXRlcylcbiAgICAgIGNvbnN0IHVuaXF1ZVZpc2l0b3JzID0gbmV3IFNldChhY3RpdmVTZXNzaW9ucy5tYXAocyA9PiBzLnZpc2l0b3JJZCkpO1xuICAgICAgY29uc3QgY3VycmVudFZpc2l0b3JzID0gdW5pcXVlVmlzaXRvcnMuc2l6ZTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGFjdGl2ZSBwYWdlcyBieSBncm91cGluZyBjdXJyZW50IHBhZ2Ugdmlld3NcbiAgICAgIGNvbnN0IHBhZ2VBY3Rpdml0eSA9IGFjdGl2ZVNlc3Npb25zLnJlZHVjZSgoYWNjOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LCBzZXNzaW9uKSA9PiB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRQYWdlID0gc2Vzc2lvbi5leGl0UGFnZSB8fCBzZXNzaW9uLmxhbmRpbmdQYWdlIHx8ICcvJztcbiAgICAgICAgYWNjW2N1cnJlbnRQYWdlXSA9IChhY2NbY3VycmVudFBhZ2VdIHx8IDApICsgMTtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sIHt9KTtcblxuICAgICAgY29uc3QgYWN0aXZlUGFnZXMgPSBPYmplY3QuZW50cmllcyhwYWdlQWN0aXZpdHkpXG4gICAgICAgIC5tYXAoKFtwYWdlLCB2aXNpdG9yc10pID0+ICh7IHBhZ2UsIHZpc2l0b3JzIH0pKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi52aXNpdG9ycyAtIGEudmlzaXRvcnMpXG4gICAgICAgIC5zbGljZSgwLCAxMCk7IC8vIFRvcCAxMCBwYWdlc1xuXG4gICAgICAvLyBUcmFuc2Zvcm0gdmlzaXRvciBkYXRhXG4gICAgICBjb25zdCB2aXNpdG9ycyA9IGFjdGl2ZVNlc3Npb25zLnNsaWNlKDAsIDIwKS5tYXAoc2Vzc2lvbiA9PiB7XG4gICAgICAgIGNvbnN0IHNlc3Npb25EdXJhdGlvbk1zID0gc2Vzc2lvbi5zZXNzaW9uRW5kLmdldFRpbWUoKSAtIHNlc3Npb24uc2Vzc2lvblN0YXJ0LmdldFRpbWUoKTtcbiAgICAgICAgY29uc3QgdGltZU9uQ3VycmVudFBhZ2UgPSBNYXRoLm1heCgwLCAobm93LmdldFRpbWUoKSAtIHNlc3Npb24uc2Vzc2lvblN0YXJ0LmdldFRpbWUoKSkgLyAxMDAwKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IHNlc3Npb24udmlzaXRvcklkLFxuICAgICAgICAgIHNlc3Npb25JZDogc2Vzc2lvbi5zZXNzaW9uSWQsXG4gICAgICAgICAgY3VycmVudFBhZ2U6IHNlc3Npb24uZXhpdFBhZ2UgfHwgc2Vzc2lvbi5sYW5kaW5nUGFnZSxcbiAgICAgICAgICB0aW1lT25QYWdlOiBNYXRoLnJvdW5kKHRpbWVPbkN1cnJlbnRQYWdlKSxcbiAgICAgICAgICBzZXNzaW9uRHVyYXRpb246IE1hdGgucm91bmQoc2Vzc2lvbkR1cmF0aW9uTXMgLyAxMDAwKSxcbiAgICAgICAgICBwYWdlVmlld3M6IHNlc3Npb24ucGFnZVZpZXdzLFxuICAgICAgICAgIGludGVyYWN0aW9uczogc2Vzc2lvbi5pbnRlcmFjdGlvbnMsXG4gICAgICAgICAgaW50ZW50U2NvcmU6IHNlc3Npb24uaW50ZW50U2NvcmUsXG4gICAgICAgICAgc2Nyb2xsRGVwdGg6IHNlc3Npb24uc2Nyb2xsRGVwdGgsXG4gICAgICAgICAgaXNSZXR1cm5pbmc6IHRoaXMuaXNSZXR1cm5pbmdWaXNpdG9yKHNlc3Npb24udmlzaXRvcklkLCBhY3RpdmVTZXNzaW9ucyksXG4gICAgICAgICAgaXNDb252ZXJ0ZWQ6IHNlc3Npb24uY29udmVyc2lvblZhbHVlID4gMCxcbiAgICAgICAgICB0cmFmZmljU291cmNlOiB7XG4gICAgICAgICAgICBzb3VyY2U6IHNlc3Npb24uc291cmNlLFxuICAgICAgICAgICAgbWVkaXVtOiBzZXNzaW9uLm1lZGl1bSxcbiAgICAgICAgICAgIGNhbXBhaWduOiBzZXNzaW9uLmNhbXBhaWduXG4gICAgICAgICAgfSxcbiAgICAgICAgICBsb2NhdGlvbjogaW5jbHVkZUxvY2F0aW9uID8ge1xuICAgICAgICAgICAgY291bnRyeTogc2Vzc2lvbi5jb3VudHJ5LFxuICAgICAgICAgICAgY2l0eTogc2Vzc2lvbi5jaXR5LFxuICAgICAgICAgICAgcmVnaW9uOiBzZXNzaW9uLnJlZ2lvblxuICAgICAgICAgIH0gOiB1bmRlZmluZWQsXG4gICAgICAgICAgZGV2aWNlOiBpbmNsdWRlRGV2aWNlID8ge1xuICAgICAgICAgICAgdHlwZTogc2Vzc2lvbi5kZXZpY2VUeXBlLFxuICAgICAgICAgICAgYnJvd3Nlcjogc2Vzc2lvbi5icm93c2VyLFxuICAgICAgICAgICAgb3M6IHNlc3Npb24ub3BlcmF0aW5nU3lzdGVtXG4gICAgICAgICAgfSA6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSByZWFsLXRpbWUgaW5zaWdodHNcbiAgICAgIGNvbnN0IGluc2lnaHRzID0gdGhpcy5nZW5lcmF0ZVJlYWxUaW1lSW5zaWdodHMoYWN0aXZlU2Vzc2lvbnMsIHZpc2l0b3JzLCBjdXJyZW50VmlzaXRvcnMpO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgdHJhZmZpYyB0cmVuZHMgKGNvbXBhcmUgd2l0aCBwcmV2aW91cyAzMCBtaW51dGVzKVxuICAgICAgY29uc3QgcHJldmlvdXNQZXJpb2RTdGFydCA9IG5ldyBEYXRlKHRoaXJ0eU1pbnV0ZXNBZ28uZ2V0VGltZSgpIC0gMzAgKiA2MCAqIDEwMDApO1xuICAgICAgY29uc3QgcHJldmlvdXNTZXNzaW9ucyA9IGF3YWl0IHByaXNtYS5tQ1BWaXNpdG9yU2Vzc2lvbnMuY291bnQoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZCxcbiAgICAgICAgICBzZXNzaW9uU3RhcnQ6IHtcbiAgICAgICAgICAgIGd0ZTogcHJldmlvdXNQZXJpb2RTdGFydCxcbiAgICAgICAgICAgIGx0OiB0aGlydHlNaW51dGVzQWdvXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdHJhZmZpY0NoYW5nZSA9IHByZXZpb3VzU2Vzc2lvbnMgPiAwIFxuICAgICAgICA/ICgoY3VycmVudFZpc2l0b3JzIC0gcHJldmlvdXNTZXNzaW9ucykgLyBwcmV2aW91c1Nlc3Npb25zKSAqIDEwMCBcbiAgICAgICAgOiAwO1xuXG4gICAgICAvLyBEZXZpY2UgYW5kIGxvY2F0aW9uIHN0YXRpc3RpY3NcbiAgICAgIGNvbnN0IGRldmljZVN0YXRzID0gaW5jbHVkZURldmljZSA/IHRoaXMuY2FsY3VsYXRlRGV2aWNlU3RhdHModmlzaXRvcnMpIDogdW5kZWZpbmVkO1xuICAgICAgY29uc3QgbG9jYXRpb25TdGF0cyA9IGluY2x1ZGVMb2NhdGlvbiA/IHRoaXMuY2FsY3VsYXRlTG9jYXRpb25TdGF0cyh2aXNpdG9ycykgOiB1bmRlZmluZWQ7XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgLy8gTG9nIHN1Y2Nlc3NmdWwgdG9vbCBleGVjdXRpb25cbiAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICdnZXRfcmVhbF90aW1lX3Zpc2l0b3JzJyxcbiAgICAgICAgYXJncyxcbiAgICAgICAgJ3N1Y2Nlc3MnLFxuICAgICAgICB7IFxuICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgIG91dHB1dFNpemU6IHZpc2l0b3JzLmxlbmd0aCxcbiAgICAgICAgICByaXNrTGV2ZWw6ICdsb3cnXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlYWxUaW1lRGF0YSA9IHtcbiAgICAgICAgY3VycmVudFZpc2l0b3JzLFxuICAgICAgICB0cmFmZmljVHJlbmQ6IHtcbiAgICAgICAgICBjaGFuZ2U6IE1hdGgucm91bmQodHJhZmZpY0NoYW5nZSAqIDEwMCkgLyAxMDAsXG4gICAgICAgICAgZGlyZWN0aW9uOiB0cmFmZmljQ2hhbmdlID4gMCA/ICdpbmNyZWFzaW5nJyA6IHRyYWZmaWNDaGFuZ2UgPCAwID8gJ2RlY3JlYXNpbmcnIDogJ3N0YWJsZScsXG4gICAgICAgICAgcHJldmlvdXNQZXJpb2RWaXNpdG9yczogcHJldmlvdXNTZXNzaW9uc1xuICAgICAgICB9LFxuICAgICAgICBhY3RpdmVQYWdlcyxcbiAgICAgICAgdmlzaXRvcnMsXG4gICAgICAgIGRldmljZVN0YXRzLFxuICAgICAgICBsb2NhdGlvblN0YXRzLFxuICAgICAgICBpbnNpZ2h0cyxcbiAgICAgICAgc2Vzc2lvblN0YXRzOiB7XG4gICAgICAgICAgdG90YWxBY3RpdmVTZXNzaW9uczogYWN0aXZlU2Vzc2lvbnMubGVuZ3RoLFxuICAgICAgICAgIGF2Z1Nlc3Npb25EdXJhdGlvbjogYWN0aXZlU2Vzc2lvbnMubGVuZ3RoID4gMCBcbiAgICAgICAgICAgID8gTWF0aC5yb3VuZChhY3RpdmVTZXNzaW9ucy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy5kdXJhdGlvbiwgMCkgLyBhY3RpdmVTZXNzaW9ucy5sZW5ndGgpXG4gICAgICAgICAgICA6IDAsXG4gICAgICAgICAgYXZnUGFnZVZpZXdzOiBhY3RpdmVTZXNzaW9ucy5sZW5ndGggPiAwIFxuICAgICAgICAgICAgPyBNYXRoLnJvdW5kKGFjdGl2ZVNlc3Npb25zLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnBhZ2VWaWV3cywgMCkgLyBhY3RpdmVTZXNzaW9ucy5sZW5ndGggKiAxMDApIC8gMTAwXG4gICAgICAgICAgICA6IDAsXG4gICAgICAgICAgYXZnSW50ZW50U2NvcmU6IGFjdGl2ZVNlc3Npb25zLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICA/IE1hdGgucm91bmQoYWN0aXZlU2Vzc2lvbnMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuaW50ZW50U2NvcmUsIDApIC8gYWN0aXZlU2Vzc2lvbnMubGVuZ3RoICogMTAwKSAvIDEwMFxuICAgICAgICAgICAgOiAwLFxuICAgICAgICAgIGNvbnZlcnNpb25SYXRlOiBhY3RpdmVTZXNzaW9ucy5sZW5ndGggPiAwIFxuICAgICAgICAgICAgPyBNYXRoLnJvdW5kKGFjdGl2ZVNlc3Npb25zLmZpbHRlcihzID0+IHMuY29udmVyc2lvblZhbHVlID4gMCkubGVuZ3RoIC8gYWN0aXZlU2Vzc2lvbnMubGVuZ3RoICogMTAwICogMTAwKSAvIDEwMFxuICAgICAgICAgICAgOiAwXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IHJlYWxUaW1lRGF0YSxcbiAgICAgICAgICAgIG1ldGE6IHtcbiAgICAgICAgICAgICAgaW5jbHVkZUxvY2F0aW9uLFxuICAgICAgICAgICAgICBpbmNsdWRlRGV2aWNlLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICAgIHRpbWVXaW5kb3c6ICczMCBtaW51dGVzJyxcbiAgICAgICAgICAgICAgc291cmNlOiAnTUNQX1ZJU0lUT1JfU0VTU0lPTlMnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfV1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIFxuICAgICAgLy8gTG9nIGZhaWxlZCB0b29sIGV4ZWN1dGlvblxuICAgICAgYXdhaXQgdGhpcy5sb2dNQ1BUb29sRXhlY3V0aW9uKFxuICAgICAgICBhdXRoQ29udGV4dCxcbiAgICAgICAgJ2dldF9yZWFsX3RpbWVfdmlzaXRvcnMnLFxuICAgICAgICBhcmdzLFxuICAgICAgICAnZmFpbHVyZScsXG4gICAgICAgIHsgXG4gICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgZXJyb3JNZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICByaXNrTGV2ZWw6ICdtZWRpdW0nXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogXCJGYWlsZWQgdG8gZ2V0IHJlYWwtdGltZSB2aXNpdG9yc1wiLFxuICAgICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICB9KVxuICAgICAgICB9XSxcbiAgICAgICAgaXNFcnJvcjogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSWRlbnRpZnkgaGlnaCBpbnRlbnQgdmlzaXRvcnMgdG9vbCB3aXRoIHJlYWwgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBpZGVudGlmeUhpZ2hJbnRlbnRWaXNpdG9ycyhhcmdzOiBhbnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgeyB0aHJlc2hvbGQgPSA3MCwgbGltaXQgPSAyMCB9ID0gYXJncztcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIExvZyB0b29sIGV4ZWN1dGlvblxuICAgICAgYXdhaXQgdGhpcy5sb2dNQ1BUb29sRXhlY3V0aW9uKFxuICAgICAgICBhdXRoQ29udGV4dCxcbiAgICAgICAgJ2lkZW50aWZ5X2hpZ2hfaW50ZW50X3Zpc2l0b3JzJyxcbiAgICAgICAgYXJncyxcbiAgICAgICAgJ3N1Y2Nlc3MnLFxuICAgICAgICB7IGR1cmF0aW9uOiAwLCByaXNrTGV2ZWw6ICdsb3cnIH1cbiAgICAgICk7XG5cbiAgICAgIC8vIEdldCBoaWdoIGludGVudCB2aXNpdG9ycyBmcm9tIHJlYWwgc2Vzc2lvbiBkYXRhXG4gICAgICBjb25zdCBoaWdoSW50ZW50U2Vzc2lvbnMgPSBhd2FpdCBwcmlzbWEubUNQVmlzaXRvclNlc3Npb25zLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBvcmdhbml6YXRpb25JZDogYXV0aENvbnRleHQub3JnYW5pemF0aW9uSWQsXG4gICAgICAgICAgaW50ZW50U2NvcmU6IHtcbiAgICAgICAgICAgIGd0ZTogdGhyZXNob2xkXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzZXNzaW9uU3RhcnQ6IHtcbiAgICAgICAgICAgIGd0ZTogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDI0ICogNjAgKiA2MCAqIDEwMDApIC8vIExhc3QgMjQgaG91cnNcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBvcmdhbml6YXRpb246IHtcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgaW50ZW50U2NvcmU6ICdkZXNjJ1xuICAgICAgICB9LFxuICAgICAgICB0YWtlOiBsaW1pdFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFRyYW5zZm9ybSB0byBoaWdoIGludGVudCB2aXNpdG9yIGZvcm1hdFxuICAgICAgY29uc3QgaGlnaEludGVudFZpc2l0b3JzID0gYXdhaXQgUHJvbWlzZS5hbGwoaGlnaEludGVudFNlc3Npb25zLm1hcChhc3luYyAoc2Vzc2lvbikgPT4ge1xuICAgICAgICAvLyBHZXQgaGlzdG9yaWNhbCBzZXNzaW9ucyBmb3IgdGhpcyB2aXNpdG9yIHRvIGRldGVybWluZSBiZWhhdmlvciBwYXR0ZXJuc1xuICAgICAgICBjb25zdCB2aXNpdG9yU2Vzc2lvbnMgPSBhd2FpdCBwcmlzbWEubUNQVmlzaXRvclNlc3Npb25zLmZpbmRNYW55KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgdmlzaXRvcklkOiBzZXNzaW9uLnZpc2l0b3JJZCxcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZFxuICAgICAgICAgIH0sXG4gICAgICAgICAgb3JkZXJCeToge1xuICAgICAgICAgICAgc2Vzc2lvblN0YXJ0OiAnZGVzYydcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRha2U6IDEwXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFuYWx5emUgdmlzaXRvciBiZWhhdmlvciBwYXR0ZXJuc1xuICAgICAgICBjb25zdCBzaWduYWxzID0gdGhpcy5hbmFseXplVmlzaXRvclNpZ25hbHMoc2Vzc2lvbiwgdmlzaXRvclNlc3Npb25zKTtcbiAgICAgICAgY29uc3QgcmVjb21tZW5kYXRpb24gPSB0aGlzLmdlbmVyYXRlUmVjb21tZW5kYXRpb24oc2Vzc2lvbiwgc2lnbmFscyk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogc2Vzc2lvbi52aXNpdG9ySWQsXG4gICAgICAgICAgc2Vzc2lvbklkOiBzZXNzaW9uLnNlc3Npb25JZCxcbiAgICAgICAgICBpbnRlbnRTY29yZTogc2Vzc2lvbi5pbnRlbnRTY29yZSxcbiAgICAgICAgICBjdXJyZW50UGFnZTogc2Vzc2lvbi5leGl0UGFnZSB8fCBzZXNzaW9uLmxhbmRpbmdQYWdlLFxuICAgICAgICAgIHNlc3Npb25EdXJhdGlvbjogc2Vzc2lvbi5kdXJhdGlvbixcbiAgICAgICAgICBwYWdlVmlld3M6IHNlc3Npb24ucGFnZVZpZXdzLFxuICAgICAgICAgIGludGVyYWN0aW9uczogc2Vzc2lvbi5pbnRlcmFjdGlvbnMsXG4gICAgICAgICAgc2Nyb2xsRGVwdGg6IHNlc3Npb24uc2Nyb2xsRGVwdGgsXG4gICAgICAgICAgY29udmVyc2lvblZhbHVlOiBzZXNzaW9uLmNvbnZlcnNpb25WYWx1ZSxcbiAgICAgICAgICBzaWduYWxzLFxuICAgICAgICAgIHByb2ZpbGU6IHtcbiAgICAgICAgICAgIGlzUmV0dXJuaW5nOiB2aXNpdG9yU2Vzc2lvbnMubGVuZ3RoID4gMSxcbiAgICAgICAgICAgIHRvdGFsU2Vzc2lvbnM6IHZpc2l0b3JTZXNzaW9ucy5sZW5ndGgsXG4gICAgICAgICAgICB0b3RhbFBhZ2VWaWV3czogdmlzaXRvclNlc3Npb25zLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnBhZ2VWaWV3cywgMCksXG4gICAgICAgICAgICBhdmdTZXNzaW9uRHVyYXRpb246IE1hdGgucm91bmQodmlzaXRvclNlc3Npb25zLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLmR1cmF0aW9uLCAwKSAvIHZpc2l0b3JTZXNzaW9ucy5sZW5ndGgpLFxuICAgICAgICAgICAgbGFzdFNlZW46IHNlc3Npb24uc2Vzc2lvblN0YXJ0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBsb2NhdGlvbjoge1xuICAgICAgICAgICAgICBjb3VudHJ5OiBzZXNzaW9uLmNvdW50cnksXG4gICAgICAgICAgICAgIGNpdHk6IHNlc3Npb24uY2l0eSxcbiAgICAgICAgICAgICAgcmVnaW9uOiBzZXNzaW9uLnJlZ2lvblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRldmljZToge1xuICAgICAgICAgICAgICB0eXBlOiBzZXNzaW9uLmRldmljZVR5cGUsXG4gICAgICAgICAgICAgIGJyb3dzZXI6IHNlc3Npb24uYnJvd3NlcixcbiAgICAgICAgICAgICAgb3M6IHNlc3Npb24ub3BlcmF0aW5nU3lzdGVtXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0cmFmZmljU291cmNlOiB7XG4gICAgICAgICAgICBzb3VyY2U6IHNlc3Npb24uc291cmNlLFxuICAgICAgICAgICAgbWVkaXVtOiBzZXNzaW9uLm1lZGl1bSxcbiAgICAgICAgICAgIGNhbXBhaWduOiBzZXNzaW9uLmNhbXBhaWduLFxuICAgICAgICAgICAgcmVmZXJyZXI6IHNlc3Npb24ucmVmZXJyZXJcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlY29tbWVuZGF0aW9uXG4gICAgICAgIH07XG4gICAgICB9KSk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBpbnNpZ2h0c1xuICAgICAgY29uc3QgdG90YWxDb3VudCA9IGhpZ2hJbnRlbnRWaXNpdG9ycy5sZW5ndGg7XG4gICAgICBjb25zdCBhdmVyYWdlSW50ZW50U2NvcmUgPSB0b3RhbENvdW50ID4gMCBcbiAgICAgICAgPyBoaWdoSW50ZW50VmlzaXRvcnMucmVkdWNlKChzdW0sIHYpID0+IHN1bSArIHYuaW50ZW50U2NvcmUsIDApIC8gdG90YWxDb3VudCBcbiAgICAgICAgOiAwO1xuICAgICAgXG4gICAgICBjb25zdCByZXR1cm5pbmdWaXNpdG9ycyA9IGhpZ2hJbnRlbnRWaXNpdG9ycy5maWx0ZXIodiA9PiB2LnByb2ZpbGUuaXNSZXR1cm5pbmcpLmxlbmd0aDtcbiAgICAgIGNvbnN0IGNvbnZlcnRlZFZpc2l0b3JzID0gaGlnaEludGVudFZpc2l0b3JzLmZpbHRlcih2ID0+IHYuY29udmVyc2lvblZhbHVlID4gMCkubGVuZ3RoO1xuICAgICAgY29uc3QgbW9iaWxlVmlzaXRvcnMgPSBoaWdoSW50ZW50VmlzaXRvcnMuZmlsdGVyKHYgPT4gdi5wcm9maWxlLmRldmljZS50eXBlID09PSAnbW9iaWxlJykubGVuZ3RoO1xuXG4gICAgICBjb25zdCBpbnNpZ2h0cyA9IFtcbiAgICAgICAgYCR7dG90YWxDb3VudH0gdmlzaXRvcnMgYWJvdmUgJHt0aHJlc2hvbGR9JSBpbnRlbnQgdGhyZXNob2xkIGluIGxhc3QgMjQgaG91cnNgLFxuICAgICAgICBgQXZlcmFnZSBpbnRlbnQgc2NvcmU6ICR7TWF0aC5yb3VuZChhdmVyYWdlSW50ZW50U2NvcmUpfSVgLFxuICAgICAgICBgJHtNYXRoLnJvdW5kKChyZXR1cm5pbmdWaXNpdG9ycyAvIHRvdGFsQ291bnQpICogMTAwKX0lIGFyZSByZXR1cm5pbmcgdmlzaXRvcnMgc2hvd2luZyBjb250aW51ZWQgaW50ZXJlc3RgLFxuICAgICAgICBgJHtjb252ZXJ0ZWRWaXNpdG9yc30gaGF2ZSBhbHJlYWR5IGNvbnZlcnRlZCBpbiB0aGVpciBjdXJyZW50IHNlc3Npb25gLFxuICAgICAgICBgJHtNYXRoLnJvdW5kKChtb2JpbGVWaXNpdG9ycyAvIHRvdGFsQ291bnQpICogMTAwKX0lIGFyZSBicm93c2luZyBvbiBtb2JpbGUgZGV2aWNlc2AsXG4gICAgICAgIFwiUmVjb21tZW5kIGltbWVkaWF0ZSBwZXJzb25hbGl6ZWQgb3V0cmVhY2ggZm9yIGJlc3QgY29udmVyc2lvbiByYXRlc1wiXG4gICAgICBdO1xuXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIC8vIExvZyBzdWNjZXNzZnVsIHRvb2wgZXhlY3V0aW9uXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFRvb2xFeGVjdXRpb24oXG4gICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAnaWRlbnRpZnlfaGlnaF9pbnRlbnRfdmlzaXRvcnMnLFxuICAgICAgICBhcmdzLFxuICAgICAgICAnc3VjY2VzcycsXG4gICAgICAgIHsgXG4gICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgb3V0cHV0U2l6ZTogdG90YWxDb3VudCxcbiAgICAgICAgICByaXNrTGV2ZWw6ICdtZWRpdW0nIC8vIEhpZ2hlciByaXNrIGR1ZSB0byB2aXNpdG9yIGlkZW50aWZpY2F0aW9uXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgdmlzaXRvcnM6IGhpZ2hJbnRlbnRWaXNpdG9ycyxcbiAgICAgICAgICAgICAgdG90YWxDb3VudCxcbiAgICAgICAgICAgICAgYXZlcmFnZUludGVudFNjb3JlOiBNYXRoLnJvdW5kKGF2ZXJhZ2VJbnRlbnRTY29yZSAqIDEwMCkgLyAxMDAsXG4gICAgICAgICAgICAgIHN0YXRpc3RpY3M6IHtcbiAgICAgICAgICAgICAgICByZXR1cm5pbmdWaXNpdG9ycyxcbiAgICAgICAgICAgICAgICBjb252ZXJ0ZWRWaXNpdG9ycyxcbiAgICAgICAgICAgICAgICBtb2JpbGVWaXNpdG9ycyxcbiAgICAgICAgICAgICAgICByZXR1cm5pbmdQZXJjZW50YWdlOiBNYXRoLnJvdW5kKChyZXR1cm5pbmdWaXNpdG9ycyAvIHRvdGFsQ291bnQpICogMTAwKSxcbiAgICAgICAgICAgICAgICBjb252ZXJzaW9uUmF0ZTogTWF0aC5yb3VuZCgoY29udmVydGVkVmlzaXRvcnMgLyB0b3RhbENvdW50KSAqIDEwMCAqIDEwMCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgbW9iaWxlUGVyY2VudGFnZTogTWF0aC5yb3VuZCgobW9iaWxlVmlzaXRvcnMgLyB0b3RhbENvdW50KSAqIDEwMClcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaW5zaWdodHNcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRhOiB7XG4gICAgICAgICAgICAgIHRocmVzaG9sZCxcbiAgICAgICAgICAgICAgbGltaXQsXG4gICAgICAgICAgICAgIHRpbWVSYW5nZTogJzI0IGhvdXJzJyxcbiAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgICBzb3VyY2U6ICdNQ1BfVklTSVRPUl9TRVNTSU9OUydcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgXG4gICAgICAvLyBMb2cgZmFpbGVkIHRvb2wgZXhlY3V0aW9uXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFRvb2xFeGVjdXRpb24oXG4gICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAnaWRlbnRpZnlfaGlnaF9pbnRlbnRfdmlzaXRvcnMnLFxuICAgICAgICBhcmdzLFxuICAgICAgICAnZmFpbHVyZScsXG4gICAgICAgIHsgXG4gICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgZXJyb3JNZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICByaXNrTGV2ZWw6ICdtZWRpdW0nXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogXCJGYWlsZWQgdG8gaWRlbnRpZnkgaGlnaCBpbnRlbnQgdmlzaXRvcnNcIixcbiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgfSlcbiAgICAgICAgfV0sXG4gICAgICAgIGlzRXJyb3I6IHRydWVcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZhbGxiYWNrIG1ldGhvZHMgZm9yIExlYWRQdWxzZSBkYXRhXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldFZpc2l0b3JEYXRhRmFsbGJhY2socXVlcnk6IExlYWRQdWxzZVF1ZXJ5LCBhdXRoQ29udGV4dDogTUNQQXV0aENvbnRleHQpOiBQcm9taXNlPGFueT4ge1xuICAgIHJldHVybiB7XG4gICAgICB2aXNpdG9yczogW10sXG4gICAgICBtZXRhOiB7XG4gICAgICAgIHRvdGFsOiAwLFxuICAgICAgICBvZmZzZXQ6IHF1ZXJ5Lm9mZnNldCxcbiAgICAgICAgbGltaXQ6IHF1ZXJ5LmxpbWl0LFxuICAgICAgICBmYWxsYmFja1VzZWQ6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6IFwiVmlzaXRvciBkYXRhIGZhbGxiYWNrIC0gaW1wbGVtZW50YXRpb24gbmVlZGVkXCJcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzZXNzaW9uIGRhdGEgKHBsYWNlaG9sZGVyKVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRTZXNzaW9uRGF0YShxdWVyeTogTGVhZFB1bHNlUXVlcnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVyaTogXCJsZWFkcHVsc2U6Ly9zZXNzaW9uc1wiLFxuICAgICAgbWltZVR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBtZXNzYWdlOiBcIlNlc3Npb24gZGF0YSBmdW5jdGlvbmFsaXR5IGNvbWluZyBzb29uXCIsXG4gICAgICAgIGZhbGxiYWNrVXNlZDogdHJ1ZVxuICAgICAgfSlcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBoZWF0bWFwIGRhdGEgKHBsYWNlaG9sZGVyKVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRIZWF0bWFwRGF0YShxdWVyeTogTGVhZFB1bHNlUXVlcnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVyaTogXCJsZWFkcHVsc2U6Ly9oZWF0bWFwc1wiLFxuICAgICAgbWltZVR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBtZXNzYWdlOiBcIkhlYXRtYXAgZGF0YSBmdW5jdGlvbmFsaXR5IGNvbWluZyBzb29uXCIsXG4gICAgICAgIGZhbGxiYWNrVXNlZDogdHJ1ZVxuICAgICAgfSlcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBqb3VybmV5IGRhdGEgKHBsYWNlaG9sZGVyKVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRKb3VybmV5RGF0YShxdWVyeTogTGVhZFB1bHNlUXVlcnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVyaTogXCJsZWFkcHVsc2U6Ly9qb3VybmV5c1wiLFxuICAgICAgbWltZVR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBtZXNzYWdlOiBcIkpvdXJuZXkgZGF0YSBmdW5jdGlvbmFsaXR5IGNvbWluZyBzb29uXCIsXG4gICAgICAgIGZhbGxiYWNrVXNlZDogdHJ1ZVxuICAgICAgfSlcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjb252ZXJzaW9uIGRhdGEgKHBsYWNlaG9sZGVyKVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRDb252ZXJzaW9uRGF0YShxdWVyeTogTGVhZFB1bHNlUXVlcnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVyaTogXCJsZWFkcHVsc2U6Ly9jb252ZXJzaW9uc1wiLFxuICAgICAgbWltZVR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBtZXNzYWdlOiBcIkNvbnZlcnNpb24gZGF0YSBmdW5jdGlvbmFsaXR5IGNvbWluZyBzb29uXCIsXG4gICAgICAgIGZhbGxiYWNrVXNlZDogdHJ1ZVxuICAgICAgfSlcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbmFseXRpY3MgZGF0YSAocGxhY2Vob2xkZXIpXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldEFuYWx5dGljc0RhdGEocXVlcnk6IExlYWRQdWxzZVF1ZXJ5LCBhdXRoQ29udGV4dDogTUNQQXV0aENvbnRleHQpOiBQcm9taXNlPGFueT4ge1xuICAgIHJldHVybiB7XG4gICAgICB1cmk6IFwibGVhZHB1bHNlOi8vYW5hbHl0aWNzXCIsXG4gICAgICBtaW1lVHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG1lc3NhZ2U6IFwiQW5hbHl0aWNzIGRhdGEgZnVuY3Rpb25hbGl0eSBjb21pbmcgc29vblwiLFxuICAgICAgICBmYWxsYmFja1VzZWQ6IHRydWVcbiAgICAgIH0pXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIZWxwZXIgbWV0aG9kcyBmb3IgdmlzaXRvciBhbmFseXNpc1xuICAgKi9cbiAgXG4gIC8qKlxuICAgKiBHZXQgdGltZXpvbmUgZnJvbSBjb3VudHJ5IGNvZGVcbiAgICovXG4gIHByaXZhdGUgZ2V0VGltZXpvbmVGcm9tQ291bnRyeShjb3VudHJ5OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHRpbWV6b25lTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgJ05pZ2VyaWEnOiAnQWZyaWNhL0xhZ29zJyxcbiAgICAgICdLZW55YSc6ICdBZnJpY2EvTmFpcm9iaScsXG4gICAgICAnR2hhbmEnOiAnQWZyaWNhL0FjY3JhJyxcbiAgICAgICdTb3V0aCBBZnJpY2EnOiAnQWZyaWNhL0pvaGFubmVzYnVyZycsXG4gICAgICAnRWd5cHQnOiAnQWZyaWNhL0NhaXJvJyxcbiAgICAgICdNb3JvY2NvJzogJ0FmcmljYS9DYXNhYmxhbmNhJyxcbiAgICAgICdUYW56YW5pYSc6ICdBZnJpY2EvRGFyX2VzX1NhbGFhbScsXG4gICAgICAnVWdhbmRhJzogJ0FmcmljYS9LYW1wYWxhJyxcbiAgICAgICdSd2FuZGEnOiAnQWZyaWNhL0tpZ2FsaScsXG4gICAgICAnWmFtYmlhJzogJ0FmcmljYS9MdXNha2EnXG4gICAgfTtcbiAgICByZXR1cm4gdGltZXpvbmVNYXBbY291bnRyeV0gfHwgJ1VUQyc7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHZpc2l0b3IgYm91bmNlIHJhdGUgYWNyb3NzIHNlc3Npb25zXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZVZpc2l0b3JCb3VuY2VSYXRlKHNlc3Npb25zOiBhbnlbXSk6IG51bWJlciB7XG4gICAgaWYgKHNlc3Npb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDA7XG4gICAgY29uc3QgYm91bmNlZFNlc3Npb25zID0gc2Vzc2lvbnMuZmlsdGVyKHMgPT4gcy5ib3VuY2VSYXRlID4gMC41KS5sZW5ndGg7XG4gICAgcmV0dXJuIChib3VuY2VkU2Vzc2lvbnMgLyBzZXNzaW9ucy5sZW5ndGgpICogMTAwO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBlbmdhZ2VtZW50IHNjb3JlIGJhc2VkIG9uIHZpc2l0b3IgYmVoYXZpb3JcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlRW5nYWdlbWVudFNjb3JlKHNlc3Npb25zOiBhbnlbXSk6IG51bWJlciB7XG4gICAgaWYgKHNlc3Npb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDA7XG5cbiAgICBsZXQgc2NvcmUgPSAwO1xuICAgIGNvbnN0IHdlaWdodHMgPSB7XG4gICAgICBzZXNzaW9uRHVyYXRpb246IDAuMyxcbiAgICAgIHBhZ2VWaWV3czogMC4yNSxcbiAgICAgIGludGVyYWN0aW9uczogMC4yLFxuICAgICAgc2Nyb2xsRGVwdGg6IDAuMTUsXG4gICAgICBjb252ZXJzaW9uczogMC4xXG4gICAgfTtcblxuICAgIC8vIEF2ZXJhZ2Ugc2Vzc2lvbiBkdXJhdGlvbiAobm9ybWFsaXplZCB0byAwLTEwMClcbiAgICBjb25zdCBhdmdEdXJhdGlvbiA9IHNlc3Npb25zLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLmR1cmF0aW9uLCAwKSAvIHNlc3Npb25zLmxlbmd0aDtcbiAgICBzY29yZSArPSBNYXRoLm1pbihhdmdEdXJhdGlvbiAvIDMwMCwgMSkgKiAxMDAgKiB3ZWlnaHRzLnNlc3Npb25EdXJhdGlvbjsgLy8gNSBtaW51dGVzID0gMTAwJVxuXG4gICAgLy8gQXZlcmFnZSBwYWdlIHZpZXdzIHBlciBzZXNzaW9uXG4gICAgY29uc3QgYXZnUGFnZVZpZXdzID0gc2Vzc2lvbnMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMucGFnZVZpZXdzLCAwKSAvIHNlc3Npb25zLmxlbmd0aDtcbiAgICBzY29yZSArPSBNYXRoLm1pbihhdmdQYWdlVmlld3MgLyAxMCwgMSkgKiAxMDAgKiB3ZWlnaHRzLnBhZ2VWaWV3czsgLy8gMTAgcGFnZXMgPSAxMDAlXG5cbiAgICAvLyBBdmVyYWdlIGludGVyYWN0aW9uc1xuICAgIGNvbnN0IGF2Z0ludGVyYWN0aW9ucyA9IHNlc3Npb25zLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLmludGVyYWN0aW9ucywgMCkgLyBzZXNzaW9ucy5sZW5ndGg7XG4gICAgc2NvcmUgKz0gTWF0aC5taW4oYXZnSW50ZXJhY3Rpb25zIC8gMjAsIDEpICogMTAwICogd2VpZ2h0cy5pbnRlcmFjdGlvbnM7IC8vIDIwIGludGVyYWN0aW9ucyA9IDEwMCVcblxuICAgIC8vIEF2ZXJhZ2Ugc2Nyb2xsIGRlcHRoXG4gICAgY29uc3QgYXZnU2Nyb2xsRGVwdGggPSBzZXNzaW9ucy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy5zY3JvbGxEZXB0aCwgMCkgLyBzZXNzaW9ucy5sZW5ndGg7XG4gICAgc2NvcmUgKz0gYXZnU2Nyb2xsRGVwdGggKiAxMDAgKiB3ZWlnaHRzLnNjcm9sbERlcHRoO1xuXG4gICAgLy8gQ29udmVyc2lvbiBib251c1xuICAgIGNvbnN0IGNvbnZlcnNpb25zID0gc2Vzc2lvbnMuZmlsdGVyKHMgPT4gcy5jb252ZXJzaW9uVmFsdWUgPiAwKS5sZW5ndGg7XG4gICAgc2NvcmUgKz0gKGNvbnZlcnNpb25zIC8gc2Vzc2lvbnMubGVuZ3RoKSAqIDEwMCAqIHdlaWdodHMuY29udmVyc2lvbnM7XG5cbiAgICByZXR1cm4gTWF0aC5yb3VuZChzY29yZSAqIDEwMCkgLyAxMDA7XG4gIH1cblxuICAvKipcbiAgICogQnVpbGQgdmlzaXRvciBqb3VybmV5IGZyb20gc2Vzc2lvbnNcbiAgICovXG4gIHByaXZhdGUgYnVpbGRWaXNpdG9ySm91cm5leShzZXNzaW9uczogYW55W10pOiBhbnlbXSB7XG4gICAgY29uc3Qgam91cm5leTogYW55W10gPSBbXTtcblxuICAgIHNlc3Npb25zLnJldmVyc2UoKS5mb3JFYWNoKChzZXNzaW9uLCBzZXNzaW9uSW5kZXgpID0+IHtcbiAgICAgIC8vIEFkZCBzZXNzaW9uIHN0YXJ0XG4gICAgICBqb3VybmV5LnB1c2goe1xuICAgICAgICB0aW1lc3RhbXA6IHNlc3Npb24uc2Vzc2lvblN0YXJ0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGFjdGlvbjogJ3Nlc3Npb25fc3RhcnQnLFxuICAgICAgICBzZXNzaW9uSWQ6IHNlc3Npb24uc2Vzc2lvbklkLFxuICAgICAgICBwYWdlOiBzZXNzaW9uLmxhbmRpbmdQYWdlLFxuICAgICAgICBzb3VyY2U6IHNlc3Npb24uc291cmNlLFxuICAgICAgICBtZWRpdW06IHNlc3Npb24ubWVkaXVtLFxuICAgICAgICBjYW1wYWlnbjogc2Vzc2lvbi5jYW1wYWlnblxuICAgICAgfSk7XG5cbiAgICAgIC8vIFNpbXVsYXRlIHBhZ2Ugdmlld3MgYmFzZWQgb24gc2Vzc2lvbiBkYXRhXG4gICAgICBjb25zdCBwYWdlVmlld3MgPSBNYXRoLm1heCgxLCBzZXNzaW9uLnBhZ2VWaWV3cyk7XG4gICAgICBjb25zdCBzZXNzaW9uRHVyYXRpb24gPSBzZXNzaW9uLmR1cmF0aW9uO1xuICAgICAgY29uc3QgdGltZVBlclBhZ2UgPSBzZXNzaW9uRHVyYXRpb24gLyBwYWdlVmlld3M7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZVZpZXdzOyBpKyspIHtcbiAgICAgICAgY29uc3QgcGFnZVRpbWVzdGFtcCA9IG5ldyBEYXRlKHNlc3Npb24uc2Vzc2lvblN0YXJ0LmdldFRpbWUoKSArIChpICogdGltZVBlclBhZ2UgKiAxMDAwKSk7XG4gICAgICAgIGpvdXJuZXkucHVzaCh7XG4gICAgICAgICAgdGltZXN0YW1wOiBwYWdlVGltZXN0YW1wLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgYWN0aW9uOiAncGFnZV92aWV3JyxcbiAgICAgICAgICBwYWdlOiBpID09PSAwID8gc2Vzc2lvbi5sYW5kaW5nUGFnZSA6IChpID09PSBwYWdlVmlld3MgLSAxID8gc2Vzc2lvbi5leGl0UGFnZSA6IGAvcGFnZS0ke2kgKyAxfWApLFxuICAgICAgICAgIGR1cmF0aW9uOiBNYXRoLnJvdW5kKHRpbWVQZXJQYWdlKSxcbiAgICAgICAgICBzY3JvbGxEZXB0aDogc2Vzc2lvbi5zY3JvbGxEZXB0aCxcbiAgICAgICAgICBpbnRlcmFjdGlvbnM6IE1hdGgucm91bmQoc2Vzc2lvbi5pbnRlcmFjdGlvbnMgLyBwYWdlVmlld3MpXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBBZGQgY29udmVyc2lvbiBldmVudCBpZiBhcHBsaWNhYmxlXG4gICAgICBpZiAoc2Vzc2lvbi5jb252ZXJzaW9uVmFsdWUgPiAwKSB7XG4gICAgICAgIGpvdXJuZXkucHVzaCh7XG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZShzZXNzaW9uLnNlc3Npb25FbmQuZ2V0VGltZSgpIC0gMzAwMDApLnRvSVNPU3RyaW5nKCksIC8vIDMwIHNlY29uZHMgYmVmb3JlIHNlc3Npb24gZW5kXG4gICAgICAgICAgYWN0aW9uOiAnY29udmVyc2lvbicsXG4gICAgICAgICAgcGFnZTogc2Vzc2lvbi5leGl0UGFnZSxcbiAgICAgICAgICB2YWx1ZTogc2Vzc2lvbi5jb252ZXJzaW9uVmFsdWUsXG4gICAgICAgICAgY29udmVyc2lvblR5cGU6ICdwdXJjaGFzZScgLy8gQ291bGQgYmUgZGV0ZXJtaW5lZCBmcm9tIGRhdGFcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCBzZXNzaW9uIGVuZFxuICAgICAgam91cm5leS5wdXNoKHtcbiAgICAgICAgdGltZXN0YW1wOiBzZXNzaW9uLnNlc3Npb25FbmQudG9JU09TdHJpbmcoKSxcbiAgICAgICAgYWN0aW9uOiAnc2Vzc2lvbl9lbmQnLFxuICAgICAgICBzZXNzaW9uSWQ6IHNlc3Npb24uc2Vzc2lvbklkLFxuICAgICAgICBwYWdlOiBzZXNzaW9uLmV4aXRQYWdlLFxuICAgICAgICBkdXJhdGlvbjogc2Vzc2lvbi5kdXJhdGlvbixcbiAgICAgICAgYm91bmNlZDogc2Vzc2lvbi5ib3VuY2VSYXRlID4gMC41XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHJldHVybiBqb3VybmV5O1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGluc2lnaHRzIGZvciB2aXNpdG9yIGJlaGF2aW9yXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlVmlzaXRvckluc2lnaHRzKHZpc2l0b3JEYXRhOiBhbnksIHNlc3Npb25zOiBhbnlbXSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBpbnNpZ2h0czogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBwcm9maWxlID0gdmlzaXRvckRhdGEucHJvZmlsZTtcbiAgICBjb25zdCBjdXJyZW50ID0gdmlzaXRvckRhdGEuY3VycmVudFNlc3Npb247XG4gICAgY29uc3QgYmVoYXZpb3JhbCA9IHZpc2l0b3JEYXRhLmJlaGF2aW9yYWw7XG5cbiAgICAvLyBJbnRlbnQgc2NvcmUgaW5zaWdodHNcbiAgICBpZiAoY3VycmVudC5pbnRlbnRTY29yZSA+IDgwKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKGBIaWdoIGludGVudCB2aXNpdG9yIC0gJHtjdXJyZW50LmludGVudFNjb3JlfSUgaW50ZW50IHNjb3JlIGluZGljYXRlcyBzdHJvbmcgcHVyY2hhc2UgbGlrZWxpaG9vZGApO1xuICAgIH0gZWxzZSBpZiAoY3VycmVudC5pbnRlbnRTY29yZSA+IDYwKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKGBNb2RlcmF0ZSBpbnRlbnQgdmlzaXRvciAtICR7Y3VycmVudC5pbnRlbnRTY29yZX0lIGludGVudCBzY29yZSBzaG93cyBpbnRlcmVzdGApO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKGBMb3cgaW50ZW50IHZpc2l0b3IgLSAke2N1cnJlbnQuaW50ZW50U2NvcmV9JSBpbnRlbnQgc2NvcmUgc3VnZ2VzdHMgZWFybHkgc3RhZ2UgZXhwbG9yYXRpb25gKTtcbiAgICB9XG5cbiAgICAvLyBFbmdhZ2VtZW50IGluc2lnaHRzXG4gICAgaWYgKGJlaGF2aW9yYWwuZW5nYWdlbWVudFNjb3JlID4gNzApIHtcbiAgICAgIGluc2lnaHRzLnB1c2goYEhpZ2hseSBlbmdhZ2VkIHZpc2l0b3IgLSAke2JlaGF2aW9yYWwuZW5nYWdlbWVudFNjb3JlLnRvRml4ZWQoMSl9IGVuZ2FnZW1lbnQgc2NvcmVgKTtcbiAgICB9IGVsc2UgaWYgKGJlaGF2aW9yYWwuZW5nYWdlbWVudFNjb3JlID4gNDApIHtcbiAgICAgIGluc2lnaHRzLnB1c2goYE1vZGVyYXRlbHkgZW5nYWdlZCB2aXNpdG9yIC0gJHtiZWhhdmlvcmFsLmVuZ2FnZW1lbnRTY29yZS50b0ZpeGVkKDEpfSBlbmdhZ2VtZW50IHNjb3JlYCk7XG4gICAgfVxuXG4gICAgLy8gU2Vzc2lvbiBpbnNpZ2h0c1xuICAgIGlmIChjdXJyZW50LnBhZ2VWaWV3cyA+IDUpIHtcbiAgICAgIGluc2lnaHRzLnB1c2goYEVuZ2FnZWQgdXNlciAtICR7Y3VycmVudC5wYWdlVmlld3N9IHBhZ2Ugdmlld3MgaW4gY3VycmVudCBzZXNzaW9uIHNob3dzIHN0cm9uZyBpbnRlcmVzdGApO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50LmR1cmF0aW9uID4gMzAwKSB7IC8vIDUgbWludXRlc1xuICAgICAgaW5zaWdodHMucHVzaChgRXh0ZW5kZWQgc2Vzc2lvbiAtICR7TWF0aC5yb3VuZChjdXJyZW50LmR1cmF0aW9uIC8gNjApfSBtaW51dGVzIGluZGljYXRlcyBzZXJpb3VzIGNvbnNpZGVyYXRpb25gKTtcbiAgICB9XG5cbiAgICAvLyBSZXR1cm5pbmcgdmlzaXRvciBpbnNpZ2h0c1xuICAgIGlmIChwcm9maWxlLmlzUmV0dXJuaW5nKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKGBSZXR1cm5pbmcgdmlzaXRvciAtICR7cHJvZmlsZS50b3RhbFNlc3Npb25zfSB0b3RhbCBzZXNzaW9ucyBzaG93cyBjb250aW51ZWQgaW50ZXJlc3RgKTtcbiAgICAgIFxuICAgICAgaWYgKHByb2ZpbGUuZGF5c1NpbmNlRmlyc3RWaXNpdCA+IDcpIHtcbiAgICAgICAgaW5zaWdodHMucHVzaChgTG9uZy10ZXJtIGludGVyZXN0IC0gZmlyc3QgdmlzaXRlZCAke3Byb2ZpbGUuZGF5c1NpbmNlRmlyc3RWaXNpdH0gZGF5cyBhZ29gKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaW5zaWdodHMucHVzaChcIk5ldyB2aXNpdG9yIC0gZmlyc3QtdGltZSB2aXNpdCByZXByZXNlbnRzIGFjcXVpc2l0aW9uIG9wcG9ydHVuaXR5XCIpO1xuICAgIH1cblxuICAgIC8vIENvbnZlcnNpb24gaW5zaWdodHNcbiAgICBpZiAocHJvZmlsZS50b3RhbENvbnZlcnNpb25zID4gMCkge1xuICAgICAgaW5zaWdodHMucHVzaChgQ29udmVydGluZyB2aXNpdG9yIC0gJHtwcm9maWxlLnRvdGFsQ29udmVyc2lvbnN9IHByZXZpb3VzIGNvbnZlcnNpb25zYCk7XG4gICAgfSBlbHNlIGlmIChiZWhhdmlvcmFsLmNvbnZlcnNpb25SYXRlID4gMCkge1xuICAgICAgaW5zaWdodHMucHVzaChcIkNvbnZlcnNpb24gcG90ZW50aWFsIC0gYmVoYXZpb3JhbCBwYXR0ZXJucyBzdWdnZXN0IHJlYWRpbmVzcyB0byBjb252ZXJ0XCIpO1xuICAgIH1cblxuICAgIC8vIEdlb2dyYXBoaWMgaW5zaWdodHNcbiAgICBpZiAodmlzaXRvckRhdGEuZ2VvTG9jYXRpb24uY291bnRyeSA9PT0gJ05pZ2VyaWEnKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKFwiTmlnZXJpYW4gdmlzaXRvciAtIG9wdGltaXplIGZvciBtb2JpbGUgZXhwZXJpZW5jZSBhbmQgbG9jYWwgcGF5bWVudCBtZXRob2RzXCIpO1xuICAgIH1cblxuICAgIC8vIERldmljZSBpbnNpZ2h0c1xuICAgIGlmICh2aXNpdG9yRGF0YS5kZXZpY2UudHlwZSA9PT0gJ21vYmlsZScpIHtcbiAgICAgIGluc2lnaHRzLnB1c2goXCJNb2JpbGUgdmlzaXRvciAtIGVuc3VyZSBtb2JpbGUtb3B0aW1pemVkIGV4cGVyaWVuY2UgYW5kIFdoYXRzQXBwIGludGVncmF0aW9uXCIpO1xuICAgIH1cblxuICAgIC8vIEJvdW5jZSByYXRlIGluc2lnaHRzXG4gICAgaWYgKGJlaGF2aW9yYWwuYm91bmNlUmF0ZSA8IDIwKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKFwiTG93IGJvdW5jZSByYXRlIGluZGljYXRlcyBzdHJvbmcgY29udGVudCBlbmdhZ2VtZW50XCIpO1xuICAgIH0gZWxzZSBpZiAoYmVoYXZpb3JhbC5ib3VuY2VSYXRlID4gNjApIHtcbiAgICAgIGluc2lnaHRzLnB1c2goXCJIaWdoIGJvdW5jZSByYXRlIHN1Z2dlc3RzIG5lZWQgZm9yIGNvbnRlbnQgb3B0aW1pemF0aW9uXCIpO1xuICAgIH1cblxuICAgIHJldHVybiBpbnNpZ2h0cztcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiB2aXNpdG9yIGlzIHJldHVybmluZyBiYXNlZCBvbiB2aXNpdG9yIElEIG9jY3VycmVuY2VcbiAgICovXG4gIHByaXZhdGUgaXNSZXR1cm5pbmdWaXNpdG9yKHZpc2l0b3JJZDogc3RyaW5nLCBzZXNzaW9uczogYW55W10pOiBib29sZWFuIHtcbiAgICByZXR1cm4gc2Vzc2lvbnMuZmlsdGVyKHMgPT4gcy52aXNpdG9ySWQgPT09IHZpc2l0b3JJZCkubGVuZ3RoID4gMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSByZWFsLXRpbWUgaW5zaWdodHMgYmFzZWQgb24gY3VycmVudCBhY3Rpdml0eVxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVJlYWxUaW1lSW5zaWdodHMoYWN0aXZlU2Vzc2lvbnM6IGFueVtdLCB2aXNpdG9yczogYW55W10sIGN1cnJlbnRWaXNpdG9yczogbnVtYmVyKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGluc2lnaHRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaWYgKGN1cnJlbnRWaXNpdG9ycyA9PT0gMCkge1xuICAgICAgaW5zaWdodHMucHVzaChcIk5vIGFjdGl2ZSB2aXNpdG9ycyBjdXJyZW50bHkgb24gdGhlIHNpdGVcIik7XG4gICAgICByZXR1cm4gaW5zaWdodHM7XG4gICAgfVxuXG4gICAgLy8gVHJhZmZpYyBsZXZlbCBpbnNpZ2h0c1xuICAgIGlmIChjdXJyZW50VmlzaXRvcnMgPiAyMCkge1xuICAgICAgaW5zaWdodHMucHVzaChgSGlnaCB0cmFmZmljIHBlcmlvZCAtICR7Y3VycmVudFZpc2l0b3JzfSBhY3RpdmUgdmlzaXRvcnNgKTtcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnRWaXNpdG9ycyA+IDUpIHtcbiAgICAgIGluc2lnaHRzLnB1c2goYE1vZGVyYXRlIHRyYWZmaWMgLSAke2N1cnJlbnRWaXNpdG9yc30gYWN0aXZlIHZpc2l0b3JzYCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGluc2lnaHRzLnB1c2goYExvdyB0cmFmZmljIHBlcmlvZCAtICR7Y3VycmVudFZpc2l0b3JzfSBhY3RpdmUgdmlzaXRvcnNgKTtcbiAgICB9XG5cbiAgICAvLyBEZXZpY2UgZGlzdHJpYnV0aW9uIGluc2lnaHRzXG4gICAgY29uc3QgbW9iaWxlVmlzaXRvcnMgPSB2aXNpdG9ycy5maWx0ZXIodiA9PiB2LmRldmljZT8udHlwZSA9PT0gJ21vYmlsZScpLmxlbmd0aDtcbiAgICBjb25zdCBtb2JpbGVQZXJjZW50YWdlID0gdmlzaXRvcnMubGVuZ3RoID4gMCA/IChtb2JpbGVWaXNpdG9ycyAvIHZpc2l0b3JzLmxlbmd0aCkgKiAxMDAgOiAwO1xuICAgIFxuICAgIGlmIChtb2JpbGVQZXJjZW50YWdlID4gNzApIHtcbiAgICAgIGluc2lnaHRzLnB1c2goYCR7TWF0aC5yb3VuZChtb2JpbGVQZXJjZW50YWdlKX0lIG9mIHZpc2l0b3JzIGFyZSBvbiBtb2JpbGUgZGV2aWNlc2ApO1xuICAgIH1cblxuICAgIC8vIEdlb2dyYXBoaWMgaW5zaWdodHNcbiAgICBjb25zdCBjb3VudHJpZXMgPSBuZXcgU2V0KHZpc2l0b3JzLm1hcCh2ID0+IHYubG9jYXRpb24/LmNvdW50cnkpLmZpbHRlcihCb29sZWFuKSk7XG4gICAgaWYgKGNvdW50cmllcy5zaXplID4gMSkge1xuICAgICAgaW5zaWdodHMucHVzaChgVmlzaXRvcnMgZnJvbSAke2NvdW50cmllcy5zaXplfSBjb3VudHJpZXMgY3VycmVudGx5IGFjdGl2ZWApO1xuICAgIH1cblxuICAgIC8vIEhpZ2ggaW50ZW50IHZpc2l0b3JzXG4gICAgY29uc3QgaGlnaEludGVudFZpc2l0b3JzID0gdmlzaXRvcnMuZmlsdGVyKHYgPT4gdi5pbnRlbnRTY29yZSA+IDcwKS5sZW5ndGg7XG4gICAgaWYgKGhpZ2hJbnRlbnRWaXNpdG9ycyA+IDApIHtcbiAgICAgIGluc2lnaHRzLnB1c2goYCR7aGlnaEludGVudFZpc2l0b3JzfSBoaWdoLWludGVudCB2aXNpdG9ycyAoPjcwJSBpbnRlbnQgc2NvcmUpIGN1cnJlbnRseSBicm93c2luZ2ApO1xuICAgIH1cblxuICAgIC8vIFNlc3Npb24gZHVyYXRpb24gaW5zaWdodHNcbiAgICBjb25zdCBsb25nU2Vzc2lvbnMgPSB2aXNpdG9ycy5maWx0ZXIodiA9PiB2LnNlc3Npb25EdXJhdGlvbiA+IDMwMCkubGVuZ3RoOyAvLyA+IDUgbWludXRlc1xuICAgIGlmIChsb25nU2Vzc2lvbnMgPiAwKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKGAke2xvbmdTZXNzaW9uc30gdmlzaXRvcnMgaGF2ZSBiZWVuIGJyb3dzaW5nIGZvciBvdmVyIDUgbWludXRlc2ApO1xuICAgIH1cblxuICAgIC8vIFBhZ2UgcG9wdWxhcml0eVxuICAgIGNvbnN0IGF2Z1BhZ2VWaWV3cyA9IHZpc2l0b3JzLmxlbmd0aCA+IDAgXG4gICAgICA/IHZpc2l0b3JzLnJlZHVjZSgoc3VtLCB2KSA9PiBzdW0gKyB2LnBhZ2VWaWV3cywgMCkgLyB2aXNpdG9ycy5sZW5ndGggXG4gICAgICA6IDA7XG4gICAgXG4gICAgaWYgKGF2Z1BhZ2VWaWV3cyA+IDMpIHtcbiAgICAgIGluc2lnaHRzLnB1c2goYEhpZ2ggZW5nYWdlbWVudCAtIGF2ZXJhZ2UgJHtNYXRoLnJvdW5kKGF2Z1BhZ2VWaWV3cyAqIDEwKSAvIDEwfSBwYWdlcyBwZXIgc2Vzc2lvbmApO1xuICAgIH1cblxuICAgIC8vIFJldHVybmluZyB2aXNpdG9yc1xuICAgIGNvbnN0IHJldHVybmluZ1Zpc2l0b3JzID0gdmlzaXRvcnMuZmlsdGVyKHYgPT4gdi5pc1JldHVybmluZykubGVuZ3RoO1xuICAgIGlmIChyZXR1cm5pbmdWaXNpdG9ycyA+IDApIHtcbiAgICAgIGNvbnN0IHJldHVybmluZ1BlcmNlbnRhZ2UgPSAocmV0dXJuaW5nVmlzaXRvcnMgLyB2aXNpdG9ycy5sZW5ndGgpICogMTAwO1xuICAgICAgaW5zaWdodHMucHVzaChgJHtNYXRoLnJvdW5kKHJldHVybmluZ1BlcmNlbnRhZ2UpfSUgYXJlIHJldHVybmluZyB2aXNpdG9yc2ApO1xuICAgIH1cblxuICAgIC8vIENvbnZlcnNpb24gaW5zaWdodHNcbiAgICBjb25zdCBjb252ZXJ0ZWRWaXNpdG9ycyA9IHZpc2l0b3JzLmZpbHRlcih2ID0+IHYuaXNDb252ZXJ0ZWQpLmxlbmd0aDtcbiAgICBpZiAoY29udmVydGVkVmlzaXRvcnMgPiAwKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKGAke2NvbnZlcnRlZFZpc2l0b3JzfSB2aXNpdG9ycyBoYXZlIGNvbnZlcnRlZCBpbiB0aGVpciBjdXJyZW50IHNlc3Npb25gKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zaWdodHM7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIGRldmljZSBzdGF0aXN0aWNzIGZvciByZWFsLXRpbWUgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVEZXZpY2VTdGF0cyh2aXNpdG9yczogYW55W10pOiBhbnkge1xuICAgIGlmICh2aXNpdG9ycy5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgY29uc3QgZGV2aWNlVHlwZXMgPSB2aXNpdG9ycy5yZWR1Y2UoKGFjYzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiwgdikgPT4ge1xuICAgICAgaWYgKHYuZGV2aWNlPy50eXBlKSB7XG4gICAgICAgIGFjY1t2LmRldmljZS50eXBlXSA9IChhY2Nbdi5kZXZpY2UudHlwZV0gfHwgMCkgKyAxO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG5cbiAgICBjb25zdCBicm93c2VycyA9IHZpc2l0b3JzLnJlZHVjZSgoYWNjOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LCB2KSA9PiB7XG4gICAgICBpZiAodi5kZXZpY2U/LmJyb3dzZXIpIHtcbiAgICAgICAgYWNjW3YuZGV2aWNlLmJyb3dzZXJdID0gKGFjY1t2LmRldmljZS5icm93c2VyXSB8fCAwKSArIDE7XG4gICAgICB9XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcblxuICAgIGNvbnN0IG9wZXJhdGluZ1N5c3RlbXMgPSB2aXNpdG9ycy5yZWR1Y2UoKGFjYzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiwgdikgPT4ge1xuICAgICAgaWYgKHYuZGV2aWNlPy5vcykge1xuICAgICAgICBhY2Nbdi5kZXZpY2Uub3NdID0gKGFjY1t2LmRldmljZS5vc10gfHwgMCkgKyAxO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGV2aWNlVHlwZXMsXG4gICAgICBicm93c2VycyxcbiAgICAgIG9wZXJhdGluZ1N5c3RlbXMsXG4gICAgICBtb2JpbGVQZXJjZW50YWdlOiBkZXZpY2VUeXBlcy5tb2JpbGUgPyAoZGV2aWNlVHlwZXMubW9iaWxlIC8gdmlzaXRvcnMubGVuZ3RoKSAqIDEwMCA6IDBcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBsb2NhdGlvbiBzdGF0aXN0aWNzIGZvciByZWFsLXRpbWUgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVMb2NhdGlvblN0YXRzKHZpc2l0b3JzOiBhbnlbXSk6IGFueSB7XG4gICAgaWYgKHZpc2l0b3JzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBjb3VudHJpZXMgPSB2aXNpdG9ycy5yZWR1Y2UoKGFjYzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiwgdikgPT4ge1xuICAgICAgaWYgKHYubG9jYXRpb24/LmNvdW50cnkpIHtcbiAgICAgICAgYWNjW3YubG9jYXRpb24uY291bnRyeV0gPSAoYWNjW3YubG9jYXRpb24uY291bnRyeV0gfHwgMCkgKyAxO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG5cbiAgICBjb25zdCBjaXRpZXMgPSB2aXNpdG9ycy5yZWR1Y2UoKGFjYzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiwgdikgPT4ge1xuICAgICAgaWYgKHYubG9jYXRpb24/LmNpdHkpIHtcbiAgICAgICAgYWNjW3YubG9jYXRpb24uY2l0eV0gPSAoYWNjW3YubG9jYXRpb24uY2l0eV0gfHwgMCkgKyAxO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG5cbiAgICBjb25zdCByZWdpb25zID0gdmlzaXRvcnMucmVkdWNlKChhY2M6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4sIHYpID0+IHtcbiAgICAgIGlmICh2LmxvY2F0aW9uPy5yZWdpb24pIHtcbiAgICAgICAgYWNjW3YubG9jYXRpb24ucmVnaW9uXSA9IChhY2Nbdi5sb2NhdGlvbi5yZWdpb25dIHx8IDApICsgMTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNvdW50cmllcyxcbiAgICAgIGNpdGllcyxcbiAgICAgIHJlZ2lvbnMsXG4gICAgICB0b3BDb3VudHJ5OiBPYmplY3QuZW50cmllcyhjb3VudHJpZXMpLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKVswXT8uWzBdLFxuICAgICAgdG90YWxDb3VudHJpZXM6IE9iamVjdC5rZXlzKGNvdW50cmllcykubGVuZ3RoXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFseXplIHZpc2l0b3IgYmVoYXZpb3Igc2lnbmFscyBmb3IgaW50ZW50IHNjb3JpbmdcbiAgICovXG4gIHByaXZhdGUgYW5hbHl6ZVZpc2l0b3JTaWduYWxzKGN1cnJlbnRTZXNzaW9uOiBhbnksIHZpc2l0b3JTZXNzaW9uczogYW55W10pOiBhbnkge1xuICAgIGNvbnN0IHNpZ25hbHMgPSB7XG4gICAgICBlbmdhZ2VtZW50U2lnbmFsczogW10sXG4gICAgICBiZWhhdmlvcmFsU2lnbmFsczogW10sXG4gICAgICBpbnRlbnRTaWduYWxzOiBbXSxcbiAgICAgIHJpc2tTaWduYWxzOiBbXVxuICAgIH07XG5cbiAgICAvLyBFbmdhZ2VtZW50IHNpZ25hbHNcbiAgICBpZiAoY3VycmVudFNlc3Npb24uZHVyYXRpb24gPiAzMDApIHsgLy8gNSsgbWludXRlc1xuICAgICAgc2lnbmFscy5lbmdhZ2VtZW50U2lnbmFscy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2xvbmdfc2Vzc2lvbicsXG4gICAgICAgIHZhbHVlOiBjdXJyZW50U2Vzc2lvbi5kdXJhdGlvbixcbiAgICAgICAgd2VpZ2h0OiAwLjgsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgRXh0ZW5kZWQgc2Vzc2lvbiBkdXJhdGlvbiBvZiAke01hdGgucm91bmQoY3VycmVudFNlc3Npb24uZHVyYXRpb24gLyA2MCl9IG1pbnV0ZXNgXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudFNlc3Npb24ucGFnZVZpZXdzID4gNSkge1xuICAgICAgc2lnbmFscy5lbmdhZ2VtZW50U2lnbmFscy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2hpZ2hfcGFnZV92aWV3cycsXG4gICAgICAgIHZhbHVlOiBjdXJyZW50U2Vzc2lvbi5wYWdlVmlld3MsXG4gICAgICAgIHdlaWdodDogMC43LFxuICAgICAgICBkZXNjcmlwdGlvbjogYEhpZ2ggZW5nYWdlbWVudCB3aXRoICR7Y3VycmVudFNlc3Npb24ucGFnZVZpZXdzfSBwYWdlIHZpZXdzYFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGN1cnJlbnRTZXNzaW9uLmludGVyYWN0aW9ucyA+IDEwKSB7XG4gICAgICBzaWduYWxzLmVuZ2FnZW1lbnRTaWduYWxzLnB1c2goe1xuICAgICAgICB0eXBlOiAnaGlnaF9pbnRlcmFjdGlvbnMnLFxuICAgICAgICB2YWx1ZTogY3VycmVudFNlc3Npb24uaW50ZXJhY3Rpb25zLFxuICAgICAgICB3ZWlnaHQ6IDAuNixcbiAgICAgICAgZGVzY3JpcHRpb246IGBBY3RpdmUgdXNlciB3aXRoICR7Y3VycmVudFNlc3Npb24uaW50ZXJhY3Rpb25zfSBpbnRlcmFjdGlvbnNgXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudFNlc3Npb24uc2Nyb2xsRGVwdGggPiA3NSkge1xuICAgICAgc2lnbmFscy5lbmdhZ2VtZW50U2lnbmFscy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2RlZXBfc2Nyb2xsJyxcbiAgICAgICAgdmFsdWU6IGN1cnJlbnRTZXNzaW9uLnNjcm9sbERlcHRoLFxuICAgICAgICB3ZWlnaHQ6IDAuNSxcbiAgICAgICAgZGVzY3JpcHRpb246IGBEZWVwIGNvbnRlbnQgZW5nYWdlbWVudCB3aXRoICR7Y3VycmVudFNlc3Npb24uc2Nyb2xsRGVwdGh9JSBzY3JvbGwgZGVwdGhgXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBCZWhhdmlvcmFsIHNpZ25hbHNcbiAgICBjb25zdCBpc1JldHVybmluZyA9IHZpc2l0b3JTZXNzaW9ucy5sZW5ndGggPiAxO1xuICAgIGlmIChpc1JldHVybmluZykge1xuICAgICAgc2lnbmFscy5iZWhhdmlvcmFsU2lnbmFscy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3JldHVybmluZ192aXNpdG9yJyxcbiAgICAgICAgdmFsdWU6IHZpc2l0b3JTZXNzaW9ucy5sZW5ndGgsXG4gICAgICAgIHdlaWdodDogMC45LFxuICAgICAgICBkZXNjcmlwdGlvbjogYFJldHVybmluZyB2aXNpdG9yIHdpdGggJHt2aXNpdG9yU2Vzc2lvbnMubGVuZ3RofSB0b3RhbCBzZXNzaW9uc2BcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIENhbGN1bGF0ZSBhdmVyYWdlIHNlc3Npb24gZHVyYXRpb24gYWNyb3NzIGFsbCBzZXNzaW9uc1xuICAgIGNvbnN0IGF2Z1Nlc3Npb25EdXJhdGlvbiA9IHZpc2l0b3JTZXNzaW9ucy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy5kdXJhdGlvbiwgMCkgLyB2aXNpdG9yU2Vzc2lvbnMubGVuZ3RoO1xuICAgIGlmIChhdmdTZXNzaW9uRHVyYXRpb24gPiAxODApIHsgLy8gMysgbWludXRlcyBhdmVyYWdlXG4gICAgICBzaWduYWxzLmJlaGF2aW9yYWxTaWduYWxzLnB1c2goe1xuICAgICAgICB0eXBlOiAnY29uc2lzdGVudF9lbmdhZ2VtZW50JyxcbiAgICAgICAgdmFsdWU6IGF2Z1Nlc3Npb25EdXJhdGlvbixcbiAgICAgICAgd2VpZ2h0OiAwLjcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgQ29uc2lzdGVudCBlbmdhZ2VtZW50IHdpdGggJHtNYXRoLnJvdW5kKGF2Z1Nlc3Npb25EdXJhdGlvbiAvIDYwKX0gbWludXRlIGF2ZXJhZ2Ugc2Vzc2lvbnNgXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBJbnRlbnQgc2lnbmFscyBiYXNlZCBvbiBwYWdlcyB2aXNpdGVkXG4gICAgY29uc3QgbGFuZGluZ1BhZ2UgPSBjdXJyZW50U2Vzc2lvbi5sYW5kaW5nUGFnZT8udG9Mb3dlckNhc2UoKSB8fCAnJztcbiAgICBjb25zdCBleGl0UGFnZSA9IGN1cnJlbnRTZXNzaW9uLmV4aXRQYWdlPy50b0xvd2VyQ2FzZSgpIHx8ICcnO1xuXG4gICAgaWYgKGxhbmRpbmdQYWdlLmluY2x1ZGVzKCdwcmljaW5nJykgfHwgZXhpdFBhZ2UuaW5jbHVkZXMoJ3ByaWNpbmcnKSkge1xuICAgICAgc2lnbmFscy5pbnRlbnRTaWduYWxzLnB1c2goe1xuICAgICAgICB0eXBlOiAncHJpY2luZ19pbnRlcmVzdCcsXG4gICAgICAgIHZhbHVlOiAxLFxuICAgICAgICB3ZWlnaHQ6IDAuOSxcbiAgICAgICAgZGVzY3JpcHRpb246ICdWaXNpdGVkIHByaWNpbmcgcGFnZSBpbmRpY2F0aW5nIHB1cmNoYXNlIGludGVudCdcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChsYW5kaW5nUGFnZS5pbmNsdWRlcygnY29udGFjdCcpIHx8IGV4aXRQYWdlLmluY2x1ZGVzKCdjb250YWN0JykgfHwgbGFuZGluZ1BhZ2UuaW5jbHVkZXMoJ2RlbW8nKSkge1xuICAgICAgc2lnbmFscy5pbnRlbnRTaWduYWxzLnB1c2goe1xuICAgICAgICB0eXBlOiAnY29udGFjdF9pbnRlcmVzdCcsXG4gICAgICAgIHZhbHVlOiAxLFxuICAgICAgICB3ZWlnaHQ6IDAuOCxcbiAgICAgICAgZGVzY3JpcHRpb246ICdWaXNpdGVkIGNvbnRhY3QvZGVtbyBwYWdlIGluZGljYXRpbmcgaGlnaCBpbnRlbnQnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudFNlc3Npb24uY29udmVyc2lvblZhbHVlID4gMCkge1xuICAgICAgc2lnbmFscy5pbnRlbnRTaWduYWxzLnB1c2goe1xuICAgICAgICB0eXBlOiAnY29udmVyc2lvbl9jb21wbGV0ZWQnLFxuICAgICAgICB2YWx1ZTogY3VycmVudFNlc3Npb24uY29udmVyc2lvblZhbHVlLFxuICAgICAgICB3ZWlnaHQ6IDEuMCxcbiAgICAgICAgZGVzY3JpcHRpb246IGBDb21wbGV0ZWQgY29udmVyc2lvbiB3aXRoIHZhbHVlICR7Y3VycmVudFNlc3Npb24uY29udmVyc2lvblZhbHVlfWBcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFJpc2sgc2lnbmFsc1xuICAgIGlmIChjdXJyZW50U2Vzc2lvbi5ib3VuY2VSYXRlID4gMC44KSB7XG4gICAgICBzaWduYWxzLnJpc2tTaWduYWxzLnB1c2goe1xuICAgICAgICB0eXBlOiAnaGlnaF9ib3VuY2VfcmlzaycsXG4gICAgICAgIHZhbHVlOiBjdXJyZW50U2Vzc2lvbi5ib3VuY2VSYXRlLFxuICAgICAgICB3ZWlnaHQ6IC0wLjUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnSGlnaCBib3VuY2UgcmF0ZSBpbmRpY2F0ZXMgcG90ZW50aWFsIGRpc2VuZ2FnZW1lbnQnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudFNlc3Npb24uZHVyYXRpb24gPCAzMCkgeyAvLyBMZXNzIHRoYW4gMzAgc2Vjb25kc1xuICAgICAgc2lnbmFscy5yaXNrU2lnbmFscy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3F1aWNrX2V4aXQnLFxuICAgICAgICB2YWx1ZTogY3VycmVudFNlc3Npb24uZHVyYXRpb24sXG4gICAgICAgIHdlaWdodDogLTAuNixcbiAgICAgICAgZGVzY3JpcHRpb246ICdWZXJ5IHNob3J0IHNlc3Npb24gZHVyYXRpb24gc3VnZ2VzdHMgbG93IGludGVyZXN0J1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gVHJhZmZpYyBzb3VyY2UgaW5zaWdodHNcbiAgICBpZiAoY3VycmVudFNlc3Npb24uc291cmNlID09PSAnZGlyZWN0JyAmJiBpc1JldHVybmluZykge1xuICAgICAgc2lnbmFscy5iZWhhdmlvcmFsU2lnbmFscy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2RpcmVjdF9yZXR1cm4nLFxuICAgICAgICB2YWx1ZTogMSxcbiAgICAgICAgd2VpZ2h0OiAwLjgsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRGlyZWN0IHRyYWZmaWMgZnJvbSByZXR1cm5pbmcgdmlzaXRvciBzaG93cyBicmFuZCBhd2FyZW5lc3MnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudFNlc3Npb24uc291cmNlID09PSAnb3JnYW5pYycpIHtcbiAgICAgIHNpZ25hbHMuYmVoYXZpb3JhbFNpZ25hbHMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdvcmdhbmljX2Rpc2NvdmVyeScsXG4gICAgICAgIHZhbHVlOiAxLFxuICAgICAgICB3ZWlnaHQ6IDAuNixcbiAgICAgICAgZGVzY3JpcHRpb246ICdPcmdhbmljIHNlYXJjaCB0cmFmZmljIGluZGljYXRlcyBhY3RpdmUgcHJvYmxlbS1zb2x2aW5nJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNpZ25hbHM7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcGVyc29uYWxpemVkIHJlY29tbWVuZGF0aW9uIGJhc2VkIG9uIHZpc2l0b3Igc2lnbmFsc1xuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVJlY29tbWVuZGF0aW9uKGN1cnJlbnRTZXNzaW9uOiBhbnksIHNpZ25hbHM6IGFueSk6IGFueSB7XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gW107XG4gICAgbGV0IHVyZ2VuY3kgPSAnbG93JztcbiAgICBsZXQgcHJpb3JpdHkgPSAxO1xuXG4gICAgLy8gQ2FsY3VsYXRlIG92ZXJhbGwgaW50ZW50IHNjb3JlIGZyb20gc2lnbmFsc1xuICAgIGxldCBpbnRlbnRTY29yZSA9IGN1cnJlbnRTZXNzaW9uLmludGVudFNjb3JlIHx8IDA7XG4gICAgXG4gICAgLy8gQW5hbHl6ZSBlbmdhZ2VtZW50IHNpZ25hbHNcbiAgICBpZiAoc2lnbmFscy5lbmdhZ2VtZW50U2lnbmFscy5sZW5ndGggPiAyKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGFjdGlvbjogJ2ltbWVkaWF0ZV9lbmdhZ2VtZW50JyxcbiAgICAgICAgY2hhbm5lbDogJ2xpdmVfY2hhdCcsXG4gICAgICAgIG1lc3NhZ2U6ICdPZmZlciBsaXZlIGNoYXQgYXNzaXN0YW5jZSBkdWUgdG8gaGlnaCBlbmdhZ2VtZW50JyxcbiAgICAgICAgcmVhc29uOiAnTXVsdGlwbGUgc3Ryb25nIGVuZ2FnZW1lbnQgc2lnbmFscyBkZXRlY3RlZCdcbiAgICAgIH0pO1xuICAgICAgdXJnZW5jeSA9ICdoaWdoJztcbiAgICAgIHByaW9yaXR5ID0gMztcbiAgICB9XG5cbiAgICAvLyBBbmFseXplIGludGVudCBzaWduYWxzXG4gICAgY29uc3QgaGFzSGlnaEludGVudCA9IHNpZ25hbHMuaW50ZW50U2lnbmFscy5zb21lKHMgPT4gcy53ZWlnaHQgPiAwLjgpO1xuICAgIGlmIChoYXNIaWdoSW50ZW50KSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGFjdGlvbjogJ3NhbGVzX291dHJlYWNoJyxcbiAgICAgICAgY2hhbm5lbDogJ3Bob25lJyxcbiAgICAgICAgbWVzc2FnZTogJ1NjaGVkdWxlIGltbWVkaWF0ZSBzYWxlcyBjYWxsJyxcbiAgICAgICAgcmVhc29uOiAnSGlnaCBwdXJjaGFzZSBpbnRlbnQgZGV0ZWN0ZWQnLFxuICAgICAgICB0aW1pbmc6ICd3aXRoaW5fMV9ob3VyJ1xuICAgICAgfSk7XG4gICAgICB1cmdlbmN5ID0gJ2NyaXRpY2FsJztcbiAgICAgIHByaW9yaXR5ID0gNTtcbiAgICB9XG5cbiAgICAvLyBQcmljaW5nIHBhZ2UgdmlzaXRvcnNcbiAgICBjb25zdCB2aXNpdGVkUHJpY2luZyA9IHNpZ25hbHMuaW50ZW50U2lnbmFscy5zb21lKHMgPT4gcy50eXBlID09PSAncHJpY2luZ19pbnRlcmVzdCcpO1xuICAgIGlmICh2aXNpdGVkUHJpY2luZykge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgICBhY3Rpb246ICdwcmljaW5nX2Fzc2lzdGFuY2UnLFxuICAgICAgICBjaGFubmVsOiAnZW1haWwnLFxuICAgICAgICBtZXNzYWdlOiAnU2VuZCBwZXJzb25hbGl6ZWQgcHJpY2luZyBpbmZvcm1hdGlvbiBhbmQgY2FzZSBzdHVkaWVzJyxcbiAgICAgICAgcmVhc29uOiAnU2hvd2VkIGludGVyZXN0IGluIHByaWNpbmcnLFxuICAgICAgICB0aW1pbmc6ICd3aXRoaW5fMl9ob3VycydcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAoY3VycmVudFNlc3Npb24uZHVyYXRpb24gPiAxODApIHsgLy8gMysgbWludXRlcyBvbiBwcmljaW5nXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgICBhY3Rpb246ICdkaXNjb3VudF9vZmZlcicsXG4gICAgICAgICAgY2hhbm5lbDogJ3BvcHVwJyxcbiAgICAgICAgICBtZXNzYWdlOiAnT2ZmZXIgbGltaXRlZC10aW1lIGRpc2NvdW50IG9yIGNvbnN1bHRhdGlvbicsXG4gICAgICAgICAgcmVhc29uOiAnRXh0ZW5kZWQgdGltZSBvbiBwcmljaW5nIHBhZ2UnLFxuICAgICAgICAgIHRpbWluZzogJ2ltbWVkaWF0ZSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuaW5nIHZpc2l0b3IgcmVjb21tZW5kYXRpb25zXG4gICAgY29uc3QgaXNSZXR1cm5pbmcgPSBzaWduYWxzLmJlaGF2aW9yYWxTaWduYWxzLnNvbWUocyA9PiBzLnR5cGUgPT09ICdyZXR1cm5pbmdfdmlzaXRvcicpO1xuICAgIGlmIChpc1JldHVybmluZyAmJiAhaGFzSGlnaEludGVudCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgICBhY3Rpb246ICdudXJ0dXJlX2NhbXBhaWduJyxcbiAgICAgICAgY2hhbm5lbDogJ2VtYWlsJyxcbiAgICAgICAgbWVzc2FnZTogJ0FkZCB0byB0YXJnZXRlZCBudXJ0dXJlIGNhbXBhaWduIHdpdGggY2FzZSBzdHVkaWVzJyxcbiAgICAgICAgcmVhc29uOiAnUmV0dXJuaW5nIHZpc2l0b3Igc2hvd2luZyBjb250aW51ZWQgaW50ZXJlc3QnLFxuICAgICAgICB0aW1pbmc6ICd3aXRoaW5fMjRfaG91cnMnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBNb2JpbGUtc3BlY2lmaWMgcmVjb21tZW5kYXRpb25zXG4gICAgaWYgKGN1cnJlbnRTZXNzaW9uLmRldmljZVR5cGUgPT09ICdtb2JpbGUnKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGFjdGlvbjogJ21vYmlsZV9vcHRpbWl6YXRpb24nLFxuICAgICAgICBjaGFubmVsOiAnd2hhdHNhcHAnLFxuICAgICAgICBtZXNzYWdlOiAnT2ZmZXIgV2hhdHNBcHAgY29uc3VsdGF0aW9uIGZvciBtb2JpbGUgY29udmVuaWVuY2UnLFxuICAgICAgICByZWFzb246ICdNb2JpbGUgdXNlciBpbiBBZnJpY2FuIG1hcmtldCcsXG4gICAgICAgIHRpbWluZzogJ3dpdGhpbl80X2hvdXJzJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2VvZ3JhcGhpYyByZWNvbW1lbmRhdGlvbnNcbiAgICBpZiAoY3VycmVudFNlc3Npb24uY291bnRyeSA9PT0gJ05pZ2VyaWEnIHx8IGN1cnJlbnRTZXNzaW9uLmNvdW50cnkgPT09ICdTb3V0aCBBZnJpY2EnKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGFjdGlvbjogJ2xvY2FsX2FwcHJvYWNoJyxcbiAgICAgICAgY2hhbm5lbDogJ3NtcycsXG4gICAgICAgIG1lc3NhZ2U6ICdTZW5kIGxvY2FsaXplZCBtZXNzYWdlIHdpdGggcmVnaW9uYWwgY2FzZSBzdHVkaWVzJyxcbiAgICAgICAgcmVhc29uOiAnQWZyaWNhbiBtYXJrZXQgdmlzaXRvcicsXG4gICAgICAgIHRpbWluZzogJ3dpdGhpbl82X2hvdXJzJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUmlzayBtaXRpZ2F0aW9uXG4gICAgY29uc3QgaGFzUmlza1NpZ25hbHMgPSBzaWduYWxzLnJpc2tTaWduYWxzLmxlbmd0aCA+IDA7XG4gICAgaWYgKGhhc1Jpc2tTaWduYWxzICYmICFoYXNIaWdoSW50ZW50KSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGFjdGlvbjogJ3JldGVudGlvbl9lZmZvcnQnLFxuICAgICAgICBjaGFubmVsOiAncG9wdXAnLFxuICAgICAgICBtZXNzYWdlOiAnU2hvdyB2YWx1ZSBwcm9wb3NpdGlvbiBvciBvZmZlciBhc3Npc3RhbmNlJyxcbiAgICAgICAgcmVhc29uOiAnUmlzayBzaWduYWxzIGRldGVjdGVkIC0gcHJldmVudCBib3VuY2UnLFxuICAgICAgICB0aW1pbmc6ICdpbW1lZGlhdGUnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBEZWZhdWx0IHJlY29tbWVuZGF0aW9uIGZvciBuZXcgdmlzaXRvcnNcbiAgICBpZiAoIWlzUmV0dXJuaW5nICYmIGludGVudFNjb3JlIDwgNTApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgYWN0aW9uOiAnbGVhZF9tYWduZXQnLFxuICAgICAgICBjaGFubmVsOiAncG9wdXAnLFxuICAgICAgICBtZXNzYWdlOiAnT2ZmZXIgdmFsdWFibGUgY29udGVudCBkb3dubG9hZCBmb3IgZW1haWwgY2FwdHVyZScsXG4gICAgICAgIHJlYXNvbjogJ05ldyB2aXNpdG9yIC0gYnVpbGQgcmVsYXRpb25zaGlwJyxcbiAgICAgICAgdGltaW5nOiAnYWZ0ZXJfNjBfc2Vjb25kcydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMsXG4gICAgICB1cmdlbmN5LFxuICAgICAgcHJpb3JpdHksXG4gICAgICBuZXh0QmVzdEFjdGlvbjogcmVjb21tZW5kYXRpb25zLmxlbmd0aCA+IDAgPyByZWNvbW1lbmRhdGlvbnNbMF0gOiBudWxsLFxuICAgICAgY29uZmlkZW5jZTogTWF0aC5taW4oaW50ZW50U2NvcmUgLyAxMDAgKyAoc2lnbmFscy5lbmdhZ2VtZW50U2lnbmFscy5sZW5ndGggKiAwLjEpLCAxLjApLFxuICAgICAgcmVhc29uaW5nOiB7XG4gICAgICAgIGludGVudFNjb3JlLFxuICAgICAgICBlbmdhZ2VtZW50TGV2ZWw6IHNpZ25hbHMuZW5nYWdlbWVudFNpZ25hbHMubGVuZ3RoID4gMiA/ICdoaWdoJyA6IHNpZ25hbHMuZW5nYWdlbWVudFNpZ25hbHMubGVuZ3RoID4gMCA/ICdtZWRpdW0nIDogJ2xvdycsXG4gICAgICAgIHJpc2tMZXZlbDogc2lnbmFscy5yaXNrU2lnbmFscy5sZW5ndGggPiAxID8gJ2hpZ2gnIDogc2lnbmFscy5yaXNrU2lnbmFscy5sZW5ndGggPiAwID8gJ21lZGl1bScgOiAnbG93JyxcbiAgICAgICAgdmlzaXRvclR5cGU6IGlzUmV0dXJuaW5nID8gJ3JldHVybmluZycgOiAnbmV3J1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgZGF0ZSByYW5nZSBzdHJpbmcgdG8gbnVtYmVyIG9mIGRheXNcbiAgICovXG4gIHByaXZhdGUgcGFyc2VEYXRlUmFuZ2UoZGF0ZVJhbmdlOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IHJhbmdlTWFwOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge1xuICAgICAgJzFkJzogMSxcbiAgICAgICc3ZCc6IDcsXG4gICAgICAnMTRkJzogMTQsXG4gICAgICAnMzBkJzogMzAsXG4gICAgICAnNjBkJzogNjAsXG4gICAgICAnOTBkJzogOTAsXG4gICAgICAnMTgwZCc6IDE4MCxcbiAgICAgICczNjVkJzogMzY1XG4gICAgfTtcbiAgICByZXR1cm4gcmFuZ2VNYXBbZGF0ZVJhbmdlXSB8fCAzMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFseXplIHZpc2l0b3IgcHJvZ3Jlc3Npb24gdGhyb3VnaCBjb252ZXJzaW9uIGZ1bm5lbFxuICAgKi9cbiAgcHJpdmF0ZSBhbmFseXplRnVubmVsUHJvZ3Jlc3Npb24oc2Vzc2lvbnM6IGFueVtdLCBmdW5uZWxTdGVwczogYW55W10pOiBhbnkge1xuICAgIGNvbnN0IHN0ZXBBbmFseXNpcyA9IFtdO1xuICAgIGxldCBwcmV2aW91c1N0ZXBWaXNpdG9ycyA9IHNlc3Npb25zLmxlbmd0aDtcblxuICAgIC8vIEFuYWx5emUgZWFjaCBmdW5uZWwgc3RlcFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZnVubmVsU3RlcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHN0ZXAgPSBmdW5uZWxTdGVwc1tpXTtcbiAgICAgIGxldCBzdGVwVmlzaXRvcnMgPSAwO1xuICAgICAgbGV0IHN0ZXBSZXZlbnVlID0gMDtcblxuICAgICAgaWYgKHN0ZXAuY29udmVyc2lvblJlcXVpcmVkKSB7XG4gICAgICAgIC8vIEZpbmFsIGNvbnZlcnNpb24gc3RlcCAtIGNvdW50IHNlc3Npb25zIHdpdGggY29udmVyc2lvbnNcbiAgICAgICAgY29uc3QgY29udmVydGVkU2Vzc2lvbnMgPSBzZXNzaW9ucy5maWx0ZXIoc2Vzc2lvbiA9PiBzZXNzaW9uLmNvbnZlcnNpb25WYWx1ZSA+IDApO1xuICAgICAgICBzdGVwVmlzaXRvcnMgPSBjb252ZXJ0ZWRTZXNzaW9ucy5sZW5ndGg7XG4gICAgICAgIHN0ZXBSZXZlbnVlID0gY29udmVydGVkU2Vzc2lvbnMucmVkdWNlKChzdW0sIHNlc3Npb24pID0+IHN1bSArIHNlc3Npb24uY29udmVyc2lvblZhbHVlLCAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFBhZ2UgdmlzaXQgc3RlcCAtIGNvdW50IHNlc3Npb25zIHRoYXQgdmlzaXRlZCBtYXRjaGluZyBwYWdlc1xuICAgICAgICBzdGVwVmlzaXRvcnMgPSBzZXNzaW9ucy5maWx0ZXIoc2Vzc2lvbiA9PiB7XG4gICAgICAgICAgY29uc3QgbGFuZGluZ1BhZ2UgPSBzZXNzaW9uLmxhbmRpbmdQYWdlPy50b0xvd2VyQ2FzZSgpIHx8ICcnO1xuICAgICAgICAgIGNvbnN0IGV4aXRQYWdlID0gc2Vzc2lvbi5leGl0UGFnZT8udG9Mb3dlckNhc2UoKSB8fCAnJztcbiAgICAgICAgICBjb25zdCBwYXR0ZXJuID0gbmV3IFJlZ0V4cChzdGVwLnBhZ2VQYXR0ZXJuLCAnaScpO1xuICAgICAgICAgIHJldHVybiBwYXR0ZXJuLnRlc3QobGFuZGluZ1BhZ2UpIHx8IHBhdHRlcm4udGVzdChleGl0UGFnZSk7XG4gICAgICAgIH0pLmxlbmd0aDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY29udmVyc2lvblJhdGUgPSBwcmV2aW91c1N0ZXBWaXNpdG9ycyA+IDAgPyAoc3RlcFZpc2l0b3JzIC8gcHJldmlvdXNTdGVwVmlzaXRvcnMpICogMTAwIDogMDtcbiAgICAgIGNvbnN0IGRyb3BPZmZSYXRlID0gcHJldmlvdXNTdGVwVmlzaXRvcnMgPiAwID8gKChwcmV2aW91c1N0ZXBWaXNpdG9ycyAtIHN0ZXBWaXNpdG9ycykgLyBwcmV2aW91c1N0ZXBWaXNpdG9ycykgKiAxMDAgOiAwO1xuXG4gICAgICBzdGVwQW5hbHlzaXMucHVzaCh7XG4gICAgICAgIHN0ZXA6IGkgKyAxLFxuICAgICAgICBuYW1lOiBzdGVwLm5hbWUsXG4gICAgICAgIHZpc2l0b3JzOiBzdGVwVmlzaXRvcnMsXG4gICAgICAgIGNvbnZlcnNpb25SYXRlOiBNYXRoLnJvdW5kKGNvbnZlcnNpb25SYXRlICogMTAwKSAvIDEwMCxcbiAgICAgICAgZHJvcE9mZlJhdGU6IE1hdGgucm91bmQoZHJvcE9mZlJhdGUgKiAxMDApIC8gMTAwLFxuICAgICAgICByZXZlbnVlOiBzdGVwUmV2ZW51ZSxcbiAgICAgICAgcGF0dGVybjogc3RlcC5wYWdlUGF0dGVybiB8fCAnY29udmVyc2lvbidcbiAgICAgIH0pO1xuXG4gICAgICBwcmV2aW91c1N0ZXBWaXNpdG9ycyA9IHN0ZXBWaXNpdG9ycztcbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgb3ZlcmFsbCBtZXRyaWNzXG4gICAgY29uc3QgdG90YWxTZXNzaW9ucyA9IHNlc3Npb25zLmxlbmd0aDtcbiAgICBjb25zdCB0b3RhbENvbnZlcnNpb25zID0gc3RlcEFuYWx5c2lzW3N0ZXBBbmFseXNpcy5sZW5ndGggLSAxXT8udmlzaXRvcnMgfHwgMDtcbiAgICBjb25zdCB0b3RhbFJldmVudWUgPSBzdGVwQW5hbHlzaXNbc3RlcEFuYWx5c2lzLmxlbmd0aCAtIDFdPy5yZXZlbnVlIHx8IDA7XG4gICAgY29uc3Qgb3ZlcmFsbENvbnZlcnNpb24gPSB0b3RhbFNlc3Npb25zID4gMCA/ICh0b3RhbENvbnZlcnNpb25zIC8gdG90YWxTZXNzaW9ucykgKiAxMDAgOiAwO1xuICAgIGNvbnN0IGF2ZXJhZ2VPcmRlclZhbHVlID0gdG90YWxDb252ZXJzaW9ucyA+IDAgPyB0b3RhbFJldmVudWUgLyB0b3RhbENvbnZlcnNpb25zIDogMDtcblxuICAgIC8vIEZpbmQgYmVzdCBhbmQgd29yc3QgcGVyZm9ybWluZyBzdGVwc1xuICAgIGNvbnN0IHN0ZXBSYXRlcyA9IHN0ZXBBbmFseXNpcy5zbGljZSgxKS5tYXAoc3RlcCA9PiAoeyBuYW1lOiBzdGVwLm5hbWUsIHJhdGU6IHN0ZXAuY29udmVyc2lvblJhdGUgfSkpO1xuICAgIGNvbnN0IGJlc3RTdGVwID0gc3RlcFJhdGVzLnJlZHVjZSgobWF4LCBzdGVwKSA9PiBzdGVwLnJhdGUgPiBtYXgucmF0ZSA/IHN0ZXAgOiBtYXgsIHN0ZXBSYXRlc1swXSB8fCB7IG5hbWU6ICdOL0EnLCByYXRlOiAwIH0pO1xuICAgIGNvbnN0IHdvcnN0U3RlcCA9IHN0ZXBSYXRlcy5yZWR1Y2UoKG1pbiwgc3RlcCkgPT4gc3RlcC5yYXRlIDwgbWluLnJhdGUgPyBzdGVwIDogbWluLCBzdGVwUmF0ZXNbMF0gfHwgeyBuYW1lOiAnTi9BJywgcmF0ZTogMCB9KTtcbiAgICBcbiAgICAvLyBGaW5kIGJpZ2dlc3QgZHJvcC1vZmZcbiAgICBjb25zdCBkcm9wT2ZmcyA9IHN0ZXBBbmFseXNpcy5tYXAoc3RlcCA9PiAoeyBuYW1lOiBzdGVwLm5hbWUsIGRyb3BPZmY6IHN0ZXAuZHJvcE9mZlJhdGUgfSkpO1xuICAgIGNvbnN0IGJpZ2dlc3REcm9wT2ZmID0gZHJvcE9mZnMucmVkdWNlKChtYXgsIHN0ZXApID0+IHN0ZXAuZHJvcE9mZiA+IG1heC5kcm9wT2ZmID8gc3RlcCA6IG1heCwgZHJvcE9mZnNbMF0gfHwgeyBuYW1lOiAnTi9BJywgZHJvcE9mZjogMCB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdGVwczogc3RlcEFuYWx5c2lzLFxuICAgICAgb3ZlcmFsbENvbnZlcnNpb246IE1hdGgucm91bmQob3ZlcmFsbENvbnZlcnNpb24gKiAxMDApIC8gMTAwLFxuICAgICAgdG90YWxSZXZlbnVlOiBNYXRoLnJvdW5kKHRvdGFsUmV2ZW51ZSAqIDEwMCkgLyAxMDAsXG4gICAgICBhdmVyYWdlT3JkZXJWYWx1ZTogTWF0aC5yb3VuZChhdmVyYWdlT3JkZXJWYWx1ZSAqIDEwMCkgLyAxMDAsXG4gICAgICBiZXN0U3RlcDogYmVzdFN0ZXAubmFtZSxcbiAgICAgIHdvcnN0U3RlcDogd29yc3RTdGVwLm5hbWUsXG4gICAgICBiaWdnZXN0RHJvcE9mZjogYmlnZ2VzdERyb3BPZmYubmFtZVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQW5hbHl6ZSBmdW5uZWwgcGVyZm9ybWFuY2UgYnkgY3VzdG9tZXIgc2VnbWVudHNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZUZ1bm5lbEJ5U2VnbWVudHMoc2Vzc2lvbnM6IGFueVtdLCBmdW5uZWxTdGVwczogYW55W10sIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55W10+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IHNlZ21lbnRzIGZvciB0aGUgb3JnYW5pemF0aW9uXG4gICAgICBjb25zdCBzZWdtZW50cyA9IGF3YWl0IHByaXNtYS5zZWdtZW50LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBjcmVhdGVkQnk6IHtcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIG1lbWJlcnM6IHtcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgY29udGFjdDogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHNlZ21lbnRBbmFseXNpcyA9IFtdO1xuXG4gICAgICAvLyBBbmFseXplIG5ldyB2cyByZXR1cm5pbmcgdmlzaXRvcnNcbiAgICAgIGNvbnN0IG5ld1Zpc2l0b3JTZXNzaW9ucyA9IHNlc3Npb25zLmZpbHRlcihzZXNzaW9uID0+IHtcbiAgICAgICAgY29uc3QgdmlzaXRvclNlc3Npb25zID0gc2Vzc2lvbnMuZmlsdGVyKHMgPT4gcy52aXNpdG9ySWQgPT09IHNlc3Npb24udmlzaXRvcklkKTtcbiAgICAgICAgcmV0dXJuIHZpc2l0b3JTZXNzaW9ucy5sZW5ndGggPT09IDE7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmV0dXJuaW5nVmlzaXRvclNlc3Npb25zID0gc2Vzc2lvbnMuZmlsdGVyKHNlc3Npb24gPT4ge1xuICAgICAgICBjb25zdCB2aXNpdG9yU2Vzc2lvbnMgPSBzZXNzaW9ucy5maWx0ZXIocyA9PiBzLnZpc2l0b3JJZCA9PT0gc2Vzc2lvbi52aXNpdG9ySWQpO1xuICAgICAgICByZXR1cm4gdmlzaXRvclNlc3Npb25zLmxlbmd0aCA+IDE7XG4gICAgICB9KTtcblxuICAgICAgLy8gQW5hbHl6ZSBuZXcgdmlzaXRvcnNcbiAgICAgIGlmIChuZXdWaXNpdG9yU2Vzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBuZXdWaXNpdG9yRnVubmVsID0gdGhpcy5hbmFseXplRnVubmVsUHJvZ3Jlc3Npb24obmV3VmlzaXRvclNlc3Npb25zLCBmdW5uZWxTdGVwcyk7XG4gICAgICAgIHNlZ21lbnRBbmFseXNpcy5wdXNoKHtcbiAgICAgICAgICBuYW1lOiAnTmV3IFZpc2l0b3JzJyxcbiAgICAgICAgICB0b3RhbFNlc3Npb25zOiBuZXdWaXNpdG9yU2Vzc2lvbnMubGVuZ3RoLFxuICAgICAgICAgIG92ZXJhbGxDb252ZXJzaW9uOiBuZXdWaXNpdG9yRnVubmVsLm92ZXJhbGxDb252ZXJzaW9uLFxuICAgICAgICAgIHRvdGFsUmV2ZW51ZTogbmV3VmlzaXRvckZ1bm5lbC50b3RhbFJldmVudWUsXG4gICAgICAgICAgYXZlcmFnZU9yZGVyVmFsdWU6IG5ld1Zpc2l0b3JGdW5uZWwuYXZlcmFnZU9yZGVyVmFsdWUsXG4gICAgICAgICAgdG9wRHJvcE9mZlN0ZXA6IG5ld1Zpc2l0b3JGdW5uZWwuYmlnZ2VzdERyb3BPZmYsXG4gICAgICAgICAgc3RlcHM6IG5ld1Zpc2l0b3JGdW5uZWwuc3RlcHNcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFuYWx5emUgcmV0dXJuaW5nIHZpc2l0b3JzXG4gICAgICBpZiAocmV0dXJuaW5nVmlzaXRvclNlc3Npb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgcmV0dXJuaW5nVmlzaXRvckZ1bm5lbCA9IHRoaXMuYW5hbHl6ZUZ1bm5lbFByb2dyZXNzaW9uKHJldHVybmluZ1Zpc2l0b3JTZXNzaW9ucywgZnVubmVsU3RlcHMpO1xuICAgICAgICBzZWdtZW50QW5hbHlzaXMucHVzaCh7XG4gICAgICAgICAgbmFtZTogJ1JldHVybmluZyBWaXNpdG9ycycsXG4gICAgICAgICAgdG90YWxTZXNzaW9uczogcmV0dXJuaW5nVmlzaXRvclNlc3Npb25zLmxlbmd0aCxcbiAgICAgICAgICBvdmVyYWxsQ29udmVyc2lvbjogcmV0dXJuaW5nVmlzaXRvckZ1bm5lbC5vdmVyYWxsQ29udmVyc2lvbixcbiAgICAgICAgICB0b3RhbFJldmVudWU6IHJldHVybmluZ1Zpc2l0b3JGdW5uZWwudG90YWxSZXZlbnVlLFxuICAgICAgICAgIGF2ZXJhZ2VPcmRlclZhbHVlOiByZXR1cm5pbmdWaXNpdG9yRnVubmVsLmF2ZXJhZ2VPcmRlclZhbHVlLFxuICAgICAgICAgIHRvcERyb3BPZmZTdGVwOiByZXR1cm5pbmdWaXNpdG9yRnVubmVsLmJpZ2dlc3REcm9wT2ZmLFxuICAgICAgICAgIHN0ZXBzOiByZXR1cm5pbmdWaXNpdG9yRnVubmVsLnN0ZXBzXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBBbmFseXplIGJ5IGRldmljZSB0eXBlXG4gICAgICBjb25zdCBtb2JpbGVSZXFzID0gc2Vzc2lvbnMuZmlsdGVyKHMgPT4gcy5kZXZpY2VUeXBlID09PSAnbW9iaWxlJyk7XG4gICAgICBjb25zdCBkZXNrdG9wU2Vzc2lvbnMgPSBzZXNzaW9ucy5maWx0ZXIocyA9PiBzLmRldmljZVR5cGUgPT09ICdkZXNrdG9wJyk7XG5cbiAgICAgIGlmIChtb2JpbGVSZXFzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgbW9iaWxlRnVubmVsID0gdGhpcy5hbmFseXplRnVubmVsUHJvZ3Jlc3Npb24obW9iaWxlUmVxcywgZnVubmVsU3RlcHMpO1xuICAgICAgICBzZWdtZW50QW5hbHlzaXMucHVzaCh7XG4gICAgICAgICAgbmFtZTogJ01vYmlsZSBWaXNpdG9ycycsXG4gICAgICAgICAgdG90YWxTZXNzaW9uczogbW9iaWxlUmVxcy5sZW5ndGgsXG4gICAgICAgICAgb3ZlcmFsbENvbnZlcnNpb246IG1vYmlsZUZ1bm5lbC5vdmVyYWxsQ29udmVyc2lvbixcbiAgICAgICAgICB0b3RhbFJldmVudWU6IG1vYmlsZUZ1bm5lbC50b3RhbFJldmVudWUsXG4gICAgICAgICAgYXZlcmFnZU9yZGVyVmFsdWU6IG1vYmlsZUZ1bm5lbC5hdmVyYWdlT3JkZXJWYWx1ZSxcbiAgICAgICAgICB0b3BEcm9wT2ZmU3RlcDogbW9iaWxlRnVubmVsLmJpZ2dlc3REcm9wT2ZmLFxuICAgICAgICAgIHN0ZXBzOiBtb2JpbGVGdW5uZWwuc3RlcHNcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChkZXNrdG9wU2Vzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBkZXNrdG9wRnVubmVsID0gdGhpcy5hbmFseXplRnVubmVsUHJvZ3Jlc3Npb24oZGVza3RvcFNlc3Npb25zLCBmdW5uZWxTdGVwcyk7XG4gICAgICAgIHNlZ21lbnRBbmFseXNpcy5wdXNoKHtcbiAgICAgICAgICBuYW1lOiAnRGVza3RvcCBWaXNpdG9ycycsXG4gICAgICAgICAgdG90YWxTZXNzaW9uczogZGVza3RvcFNlc3Npb25zLmxlbmd0aCxcbiAgICAgICAgICBvdmVyYWxsQ29udmVyc2lvbjogZGVza3RvcEZ1bm5lbC5vdmVyYWxsQ29udmVyc2lvbixcbiAgICAgICAgICB0b3RhbFJldmVudWU6IGRlc2t0b3BGdW5uZWwudG90YWxSZXZlbnVlLFxuICAgICAgICAgIGF2ZXJhZ2VPcmRlclZhbHVlOiBkZXNrdG9wRnVubmVsLmF2ZXJhZ2VPcmRlclZhbHVlLFxuICAgICAgICAgIHRvcERyb3BPZmZTdGVwOiBkZXNrdG9wRnVubmVsLmJpZ2dlc3REcm9wT2ZmLFxuICAgICAgICAgIHN0ZXBzOiBkZXNrdG9wRnVubmVsLnN0ZXBzXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBBbmFseXplIGJ5IHRyYWZmaWMgc291cmNlXG4gICAgICBjb25zdCBvcmdhbmljU2Vzc2lvbnMgPSBzZXNzaW9ucy5maWx0ZXIocyA9PiBzLnNvdXJjZSA9PT0gJ29yZ2FuaWMnKTtcbiAgICAgIGNvbnN0IGRpcmVjdFNlc3Npb25zID0gc2Vzc2lvbnMuZmlsdGVyKHMgPT4gcy5zb3VyY2UgPT09ICdkaXJlY3QnKTtcbiAgICAgIGNvbnN0IHNvY2lhbFNlc3Npb25zID0gc2Vzc2lvbnMuZmlsdGVyKHMgPT4gcy5zb3VyY2UgPT09ICdzb2NpYWwnKTtcblxuICAgICAgaWYgKG9yZ2FuaWNTZXNzaW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IG9yZ2FuaWNGdW5uZWwgPSB0aGlzLmFuYWx5emVGdW5uZWxQcm9ncmVzc2lvbihvcmdhbmljU2Vzc2lvbnMsIGZ1bm5lbFN0ZXBzKTtcbiAgICAgICAgc2VnbWVudEFuYWx5c2lzLnB1c2goe1xuICAgICAgICAgIG5hbWU6ICdPcmdhbmljIFRyYWZmaWMnLFxuICAgICAgICAgIHRvdGFsU2Vzc2lvbnM6IG9yZ2FuaWNTZXNzaW9ucy5sZW5ndGgsXG4gICAgICAgICAgb3ZlcmFsbENvbnZlcnNpb246IG9yZ2FuaWNGdW5uZWwub3ZlcmFsbENvbnZlcnNpb24sXG4gICAgICAgICAgdG90YWxSZXZlbnVlOiBvcmdhbmljRnVubmVsLnRvdGFsUmV2ZW51ZSxcbiAgICAgICAgICBhdmVyYWdlT3JkZXJWYWx1ZTogb3JnYW5pY0Z1bm5lbC5hdmVyYWdlT3JkZXJWYWx1ZSxcbiAgICAgICAgICB0b3BEcm9wT2ZmU3RlcDogb3JnYW5pY0Z1bm5lbC5iaWdnZXN0RHJvcE9mZixcbiAgICAgICAgICBzdGVwczogb3JnYW5pY0Z1bm5lbC5zdGVwc1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHNlZ21lbnRBbmFseXNpcztcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhbmFseXppbmcgZnVubmVsIGJ5IHNlZ21lbnRzOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgYWN0aW9uYWJsZSBpbnNpZ2h0cyBmcm9tIGZ1bm5lbCBkYXRhXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlRnVubmVsSW5zaWdodHMoc3RlcHM6IGFueVtdLCBzZWdtZW50RGF0YT86IGFueVtdKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGluc2lnaHRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLy8gT3ZlcmFsbCBmdW5uZWwgaW5zaWdodHNcbiAgICBpZiAoc3RlcHMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgZmlyc3RTdGVwID0gc3RlcHNbMF07XG4gICAgICBjb25zdCBsYXN0U3RlcCA9IHN0ZXBzW3N0ZXBzLmxlbmd0aCAtIDFdO1xuICAgICAgXG4gICAgICBpbnNpZ2h0cy5wdXNoKGBGdW5uZWwgc3RhcnRzIHdpdGggJHtmaXJzdFN0ZXAudmlzaXRvcnMudG9Mb2NhbGVTdHJpbmcoKX0gdmlzaXRvcnMgYW5kIGNvbnZlcnRzICR7bGFzdFN0ZXAudmlzaXRvcnMudG9Mb2NhbGVTdHJpbmcoKX0gKCR7bGFzdFN0ZXAuY29udmVyc2lvblJhdGV9JSBvdmVyYWxsKWApO1xuXG4gICAgICAvLyBGaW5kIGJpZ2dlc3QgZHJvcC1vZmZcbiAgICAgIGNvbnN0IGJpZ2dlc3REcm9wT2ZmID0gc3RlcHMucmVkdWNlKChtYXgsIHN0ZXApID0+IHN0ZXAuZHJvcE9mZlJhdGUgPiBtYXguZHJvcE9mZlJhdGUgPyBzdGVwIDogbWF4LCBzdGVwc1swXSk7XG4gICAgICBpZiAoYmlnZ2VzdERyb3BPZmYuZHJvcE9mZlJhdGUgPiA1MCkge1xuICAgICAgICBpbnNpZ2h0cy5wdXNoKGDimqDvuI8gQ3JpdGljYWwgZHJvcC1vZmYgYXQgJHtiaWdnZXN0RHJvcE9mZi5uYW1lfSAoJHtiaWdnZXN0RHJvcE9mZi5kcm9wT2ZmUmF0ZX0lIGV4aXQgcmF0ZSkgLSByZXF1aXJlcyBpbW1lZGlhdGUgb3B0aW1pemF0aW9uYCk7XG4gICAgICB9IGVsc2UgaWYgKGJpZ2dlc3REcm9wT2ZmLmRyb3BPZmZSYXRlID4gMzApIHtcbiAgICAgICAgaW5zaWdodHMucHVzaChg8J+TiSBTaWduaWZpY2FudCBkcm9wLW9mZiBhdCAke2JpZ2dlc3REcm9wT2ZmLm5hbWV9ICgke2JpZ2dlc3REcm9wT2ZmLmRyb3BPZmZSYXRlfSUgZXhpdCByYXRlKSAtIG9wdGltaXphdGlvbiBvcHBvcnR1bml0eWApO1xuICAgICAgfVxuXG4gICAgICAvLyBSZXZlbnVlIGluc2lnaHRzXG4gICAgICBjb25zdCByZXZlbnVlU3RlcCA9IHN0ZXBzLmZpbmQoc3RlcCA9PiBzdGVwLnJldmVudWUgPiAwKTtcbiAgICAgIGlmIChyZXZlbnVlU3RlcCkge1xuICAgICAgICBpbnNpZ2h0cy5wdXNoKGDwn5KwIEdlbmVyYXRlZCAke3JldmVudWVTdGVwLnJldmVudWUudG9Mb2NhbGVTdHJpbmcoKX0gaW4gcmV2ZW51ZSBmcm9tICR7cmV2ZW51ZVN0ZXAudmlzaXRvcnN9IGNvbnZlcnNpb25zYCk7XG4gICAgICB9XG5cbiAgICAgIC8vIENvbnZlcnNpb24gcmF0ZSBpbnNpZ2h0c1xuICAgICAgY29uc3Qgb3ZlcmFsbFJhdGUgPSBsYXN0U3RlcC5jb252ZXJzaW9uUmF0ZTtcbiAgICAgIGlmIChvdmVyYWxsUmF0ZSA+IDUpIHtcbiAgICAgICAgaW5zaWdodHMucHVzaChg8J+OryBFeGNlbGxlbnQgY29udmVyc2lvbiByYXRlIG9mICR7b3ZlcmFsbFJhdGV9JSAtIGFib3ZlIGluZHVzdHJ5IGF2ZXJhZ2VgKTtcbiAgICAgIH0gZWxzZSBpZiAob3ZlcmFsbFJhdGUgPiAyKSB7XG4gICAgICAgIGluc2lnaHRzLnB1c2goYOKchSBHb29kIGNvbnZlcnNpb24gcmF0ZSBvZiAke292ZXJhbGxSYXRlfSUgLSByb29tIGZvciBpbXByb3ZlbWVudGApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5zaWdodHMucHVzaChg8J+TiiBDb252ZXJzaW9uIHJhdGUgb2YgJHtvdmVyYWxsUmF0ZX0lIGlzIGJlbG93IGF2ZXJhZ2UgLSBmdW5uZWwgb3B0aW1pemF0aW9uIG5lZWRlZGApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFNlZ21lbnQtc3BlY2lmaWMgaW5zaWdodHNcbiAgICBpZiAoc2VnbWVudERhdGEgJiYgc2VnbWVudERhdGEubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgbmV3VmlzaXRvcnMgPSBzZWdtZW50RGF0YS5maW5kKHMgPT4gcy5uYW1lID09PSAnTmV3IFZpc2l0b3JzJyk7XG4gICAgICBjb25zdCByZXR1cm5pbmdWaXNpdG9ycyA9IHNlZ21lbnREYXRhLmZpbmQocyA9PiBzLm5hbWUgPT09ICdSZXR1cm5pbmcgVmlzaXRvcnMnKTtcblxuICAgICAgaWYgKG5ld1Zpc2l0b3JzICYmIHJldHVybmluZ1Zpc2l0b3JzKSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNpb25EaWZmID0gcmV0dXJuaW5nVmlzaXRvcnMub3ZlcmFsbENvbnZlcnNpb24gLSBuZXdWaXNpdG9ycy5vdmVyYWxsQ29udmVyc2lvbjtcbiAgICAgICAgaWYgKGNvbnZlcnNpb25EaWZmID4gMikge1xuICAgICAgICAgIGluc2lnaHRzLnB1c2goYPCflIQgUmV0dXJuaW5nIHZpc2l0b3JzIGNvbnZlcnQgJHtjb252ZXJzaW9uRGlmZi50b0ZpeGVkKDEpfXggYmV0dGVyICgke3JldHVybmluZ1Zpc2l0b3JzLm92ZXJhbGxDb252ZXJzaW9ufSUgdnMgJHtuZXdWaXNpdG9ycy5vdmVyYWxsQ29udmVyc2lvbn0lKWApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG1vYmlsZVNlZ21lbnQgPSBzZWdtZW50RGF0YS5maW5kKHMgPT4gcy5uYW1lID09PSAnTW9iaWxlIFZpc2l0b3JzJyk7XG4gICAgICBjb25zdCBkZXNrdG9wU2VnbWVudCA9IHNlZ21lbnREYXRhLmZpbmQocyA9PiBzLm5hbWUgPT09ICdEZXNrdG9wIFZpc2l0b3JzJyk7XG5cbiAgICAgIGlmIChtb2JpbGVTZWdtZW50ICYmIGRlc2t0b3BTZWdtZW50KSB7XG4gICAgICAgIGlmIChtb2JpbGVTZWdtZW50Lm92ZXJhbGxDb252ZXJzaW9uIDwgZGVza3RvcFNlZ21lbnQub3ZlcmFsbENvbnZlcnNpb24gKiAwLjcpIHtcbiAgICAgICAgICBpbnNpZ2h0cy5wdXNoKGDwn5OxIE1vYmlsZSBjb252ZXJzaW9uICgke21vYmlsZVNlZ21lbnQub3ZlcmFsbENvbnZlcnNpb259JSkgc2lnbmlmaWNhbnRseSBsb3dlciB0aGFuIGRlc2t0b3AgKCR7ZGVza3RvcFNlZ21lbnQub3ZlcmFsbENvbnZlcnNpb259JSkgLSBtb2JpbGUgb3B0aW1pemF0aW9uIG5lZWRlZGApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRyYWZmaWMgc291cmNlIGluc2lnaHRzXG4gICAgICBjb25zdCBvcmdhbmljU2VnbWVudCA9IHNlZ21lbnREYXRhLmZpbmQocyA9PiBzLm5hbWUgPT09ICdPcmdhbmljIFRyYWZmaWMnKTtcbiAgICAgIGlmIChvcmdhbmljU2VnbWVudCAmJiBvcmdhbmljU2VnbWVudC5vdmVyYWxsQ29udmVyc2lvbiA+IDMpIHtcbiAgICAgICAgaW5zaWdodHMucHVzaChg8J+MsSBPcmdhbmljIHRyYWZmaWMgc2hvd3Mgc3Ryb25nIGludGVudCB3aXRoICR7b3JnYW5pY1NlZ21lbnQub3ZlcmFsbENvbnZlcnNpb259JSBjb252ZXJzaW9uIC0gaW52ZXN0IGluIFNFT2ApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFmcmljYW4gbWFya2V0IHNwZWNpZmljIGluc2lnaHRzXG4gICAgaW5zaWdodHMucHVzaChg8J+MjSBDb25zaWRlciBBZnJpY2FuIG1hcmtldCBvcHRpbWl6YXRpb246IG1vYmlsZS1maXJzdCBkZXNpZ24sIFdoYXRzQXBwIGludGVncmF0aW9uLCBhbmQgbG9jYWwgcGF5bWVudCBtZXRob2RzYCk7XG5cbiAgICByZXR1cm4gaW5zaWdodHM7XG4gIH1cbn0iXSwibmFtZXMiOlsiTGVhZFB1bHNlTUNQU2VydmVyIiwiSFRUUEJhc2VNQ1BTZXJ2ZXIiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsImRlZmF1bHRNQ1BDb25maWciLCJzZXJ2ZXJzIiwibGVhZHB1bHNlIiwibGlzdFJlc291cmNlcyIsImF1dGhDb250ZXh0IiwicmVzb3VyY2VzIiwidXJpIiwibmFtZSIsImRlc2NyaXB0aW9uIiwibWltZVR5cGUiLCJwZXJtaXNzaW9ucyIsImluY2x1ZGVzIiwiZmlsdGVyIiwiciIsInJlYWRSZXNvdXJjZSIsInVybCIsIlVSTCIsInBhdGgiLCJwYXRobmFtZSIsInNlYXJjaFBhcmFtcyIsInF1ZXJ5UGFyYW1zIiwiT2JqZWN0IiwiZnJvbUVudHJpZXMiLCJlbnRyaWVzIiwidmFsaWRhdGVkUXVlcnkiLCJMZWFkUHVsc2VRdWVyeVNjaGVtYSIsInBhcnNlIiwib3JnYW5pemF0aW9uSWQiLCJsaW1pdCIsIk51bWJlciIsInBhcnNlSW50Iiwib2Zmc2V0IiwiaW5jbHVkZUhlYXRtYXAiLCJpbmNsdWRlSm91cm5leSIsImdldFZpc2l0b3JEYXRhIiwiZ2V0U2Vzc2lvbkRhdGEiLCJnZXRIZWF0bWFwRGF0YSIsImdldEpvdXJuZXlEYXRhIiwiZ2V0Q29udmVyc2lvbkRhdGEiLCJnZXRBbmFseXRpY3NEYXRhIiwiTUNQVmFsaWRhdGlvbkVycm9yIiwibGlzdFRvb2xzIiwidG9vbHMiLCJpbnB1dFNjaGVtYSIsInR5cGUiLCJwcm9wZXJ0aWVzIiwidmlzaXRvcklkIiwiZGVmYXVsdCIsInJlcXVpcmVkIiwic2Vzc2lvbklkIiwidGltZVJhbmdlIiwiZW51bSIsImZ1bm5lbElkIiwiZGF0ZVJhbmdlIiwiaW5jbHVkZVNlZ21lbnRzIiwicGFnZVVybCIsImluY2x1ZGVMb2NhdGlvbiIsImluY2x1ZGVEZXZpY2UiLCJ0aHJlc2hvbGQiLCJtaW5pbXVtIiwibWF4aW11bSIsInQiLCJjYWxsVG9vbCIsImFyZ3MiLCJ0cmFja1Zpc2l0b3IiLCJhbmFseXplVmlzaXRvckJlaGF2aW9yIiwiZ2V0Q29udmVyc2lvbkZ1bm5lbCIsImdldFBhZ2VBbmFseXRpY3MiLCJnZXRSZWFsVGltZVZpc2l0b3JzIiwiaWRlbnRpZnlIaWdoSW50ZW50VmlzaXRvcnMiLCJxdWVyeSIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJ3aGVyZUNsYXVzZSIsImRhdGVGcm9tIiwiZGF0ZVRvIiwic2Vzc2lvblN0YXJ0IiwiZ3RlIiwibHRlIiwidmlzaXRvclNlc3Npb25zIiwicHJpc21hIiwibUNQVmlzaXRvclNlc3Npb25zIiwiZmluZE1hbnkiLCJ3aGVyZSIsInRha2UiLCJza2lwIiwiaW5jbHVkZSIsIm9yZ2FuaXphdGlvbiIsInNlbGVjdCIsImlkIiwib3JkZXJCeSIsInZpc2l0b3JzIiwibWFwIiwic2Vzc2lvbiIsInRvSVNPU3RyaW5nIiwiZW5kVGltZSIsInNlc3Npb25FbmQiLCJwYWdlVmlld3MiLCJkdXJhdGlvbiIsImJvdW5jZSIsImJvdW5jZVJhdGUiLCJjb252ZXJ0ZWQiLCJjb252ZXJzaW9uVmFsdWUiLCJpbnRlbnRTY29yZSIsImdlb0xvY2F0aW9uIiwiY291bnRyeSIsImNpdHkiLCJyZWdpb24iLCJkZXZpY2UiLCJkZXZpY2VUeXBlIiwiYnJvd3NlciIsIm9zIiwib3BlcmF0aW5nU3lzdGVtIiwidHJhZmZpYyIsInNvdXJjZSIsIm1lZGl1bSIsImNhbXBhaWduIiwicmVmZXJyZXIiLCJlbmdhZ2VtZW50Iiwic2Nyb2xsRGVwdGgiLCJ0aW1lT25QYWdlIiwiYXZnVGltZU9uUGFnZSIsImludGVyYWN0aW9ucyIsImV4aXRQYWdlIiwiaW5zaWdodHMiLCJKU09OIiwidG90YWxTZXNzaW9ucyIsImxlbmd0aCIsInRvdGFsUGFnZVZpZXdzIiwicmVkdWNlIiwic3VtIiwidiIsImF2Z0R1cmF0aW9uIiwiY29udmVyc2lvblJhdGUiLCJhdmdJbnRlbnRTY29yZSIsImRldmljZURpc3RyaWJ1dGlvbiIsImFjYyIsImNvdW50cnlEaXN0cmlidXRpb24iLCJsb2dNQ1BSZXNvdXJjZUFjY2VzcyIsImRhdGFTaXplIiwidGV4dCIsInN0cmluZ2lmeSIsInN1bW1hcnkiLCJhdmVyYWdlRHVyYXRpb24iLCJNYXRoIiwicm91bmQiLCJtZXRhIiwidG90YWwiLCJ0aW1lc3RhbXAiLCJlcnJvciIsImVycm9yTWVzc2FnZSIsIkVycm9yIiwibWVzc2FnZSIsImNyZWF0ZUZhbGxiYWNrUmVzcG9uc2UiLCJnZXRWaXNpdG9yRGF0YUZhbGxiYWNrIiwibG9nTUNQVG9vbEV4ZWN1dGlvbiIsInJpc2tMZXZlbCIsImNvbnRlbnQiLCJzdWNjZXNzIiwiaXNFcnJvciIsImN1cnJlbnRTZXNzaW9uIiwicyIsImF2Z1Nlc3Npb25EdXJhdGlvbiIsInRvdGFsQ29udmVyc2lvbnMiLCJpc1JldHVybmluZyIsImZpcnN0U2Vzc2lvbkRhdGUiLCJsYXN0U2Vzc2lvbkRhdGUiLCJ2aXNpdG9yRGF0YSIsImN1cnJlbnRQYWdlIiwibGFuZGluZ1BhZ2UiLCJib3VuY2VkIiwicHJvZmlsZSIsImF2ZXJhZ2VTZXNzaW9uRHVyYXRpb24iLCJhdmVyYWdlSW50ZW50U2NvcmUiLCJmaXJzdFNlZW4iLCJsYXN0U2VlbiIsImRheXNTaW5jZUZpcnN0VmlzaXQiLCJmbG9vciIsImdldFRpbWUiLCJ0aW1lem9uZSIsImdldFRpbWV6b25lRnJvbUNvdW50cnkiLCJ0cmFmZmljU291cmNlIiwiYmVoYXZpb3JhbCIsImNhbGN1bGF0ZVZpc2l0b3JCb3VuY2VSYXRlIiwiZW5nYWdlbWVudFNjb3JlIiwiY2FsY3VsYXRlRW5nYWdlbWVudFNjb3JlIiwiam91cm5leSIsImJ1aWxkVmlzaXRvckpvdXJuZXkiLCJnZW5lcmF0ZVZpc2l0b3JJbnNpZ2h0cyIsIm91dHB1dFNpemUiLCJkYXRhIiwiZGV0YWlscyIsImJlaGF2aW9yQW5hbHlzaXMiLCJiZWhhdmlvclBhdHRlcm4iLCJwYWdlVmlld3NQZXJTZXNzaW9uIiwiaW50ZXJlc3RzIiwiY2F0ZWdvcnkiLCJzY29yZSIsImFjdGlvbnMiLCJ0b3RhbENsaWNrcyIsImZvcm1TdWJtaXNzaW9ucyIsImRvd25sb2FkUmVxdWVzdHMiLCJzb2NpYWxTaGFyZXMiLCJwcmVkaWN0aW9ucyIsImxpa2VsaWhvb2RUb0NvbnZlcnQiLCJ0aW1lVG9Db252ZXJzaW9uIiwicHJlZmVycmVkQ2hhbm5lbCIsIm5leHRCZXN0QWN0aW9uIiwiYW5hbHlzaXNUeXBlIiwiZmFsbGJhY2tVc2VkIiwiZGF5c0JhY2siLCJwYXJzZURhdGVSYW5nZSIsInN0YXJ0RGF0ZSIsInNlc3Npb25zIiwiZnVubmVsU3RlcHMiLCJwYWdlUGF0dGVybiIsImNvbnZlcnNpb25SZXF1aXJlZCIsImZ1bm5lbERhdGEiLCJhbmFseXplRnVubmVsUHJvZ3Jlc3Npb24iLCJzZWdtZW50RGF0YSIsInVuZGVmaW5lZCIsImFuYWx5emVGdW5uZWxCeVNlZ21lbnRzIiwiZ2VuZXJhdGVGdW5uZWxJbnNpZ2h0cyIsInN0ZXBzIiwicmVzdWx0IiwidGltZWZyYW1lIiwiZW5kRGF0ZSIsImRheXNBbmFseXplZCIsIm92ZXJhbGxDb252ZXJzaW9uIiwidG90YWxSZXZlbnVlIiwiYXZlcmFnZU9yZGVyVmFsdWUiLCJzZWdtZW50cyIsInBlcmZvcm1hbmNlIiwiYmVzdFBlcmZvcm1pbmdTdGVwIiwiYmVzdFN0ZXAiLCJ3b3JzdFBlcmZvcm1pbmdTdGVwIiwid29yc3RTdGVwIiwiYmlnZ2VzdERyb3BPZmYiLCJwYWdlQW5hbHl0aWNzIiwibWV0cmljcyIsInVuaXF1ZVZpc2l0b3JzIiwiYXZlcmFnZVRpbWVPblBhZ2UiLCJleGl0UmF0ZSIsImNsaWNrVGhyb3VnaFJhdGUiLCJoZWF0bWFwRGF0YSIsImNsaWNrTWFwIiwiaGVhZGVyTmF2IiwicHJpbWFyeUNUQSIsInNlY29uZGFyeUNUQSIsImZvb3RlciIsInNjcm9sbE1hcCIsImF0dGVudGlvbk1hcCIsImhlcm8iLCJmZWF0dXJlcyIsInByaWNpbmciLCJ0ZXN0aW1vbmlhbHMiLCJ0aGlydHlNaW51dGVzQWdvIiwiYWN0aXZlU2Vzc2lvbnMiLCJTZXQiLCJjdXJyZW50VmlzaXRvcnMiLCJzaXplIiwicGFnZUFjdGl2aXR5IiwiYWN0aXZlUGFnZXMiLCJwYWdlIiwic29ydCIsImEiLCJiIiwic2xpY2UiLCJzZXNzaW9uRHVyYXRpb25NcyIsInRpbWVPbkN1cnJlbnRQYWdlIiwibWF4Iiwic2Vzc2lvbkR1cmF0aW9uIiwiaXNSZXR1cm5pbmdWaXNpdG9yIiwiaXNDb252ZXJ0ZWQiLCJsb2NhdGlvbiIsImdlbmVyYXRlUmVhbFRpbWVJbnNpZ2h0cyIsInByZXZpb3VzUGVyaW9kU3RhcnQiLCJwcmV2aW91c1Nlc3Npb25zIiwiY291bnQiLCJsdCIsInRyYWZmaWNDaGFuZ2UiLCJkZXZpY2VTdGF0cyIsImNhbGN1bGF0ZURldmljZVN0YXRzIiwibG9jYXRpb25TdGF0cyIsImNhbGN1bGF0ZUxvY2F0aW9uU3RhdHMiLCJyZWFsVGltZURhdGEiLCJ0cmFmZmljVHJlbmQiLCJjaGFuZ2UiLCJkaXJlY3Rpb24iLCJwcmV2aW91c1BlcmlvZFZpc2l0b3JzIiwic2Vzc2lvblN0YXRzIiwidG90YWxBY3RpdmVTZXNzaW9ucyIsImF2Z1BhZ2VWaWV3cyIsInRpbWVXaW5kb3ciLCJoaWdoSW50ZW50U2Vzc2lvbnMiLCJoaWdoSW50ZW50VmlzaXRvcnMiLCJQcm9taXNlIiwiYWxsIiwic2lnbmFscyIsImFuYWx5emVWaXNpdG9yU2lnbmFscyIsInJlY29tbWVuZGF0aW9uIiwiZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbiIsInRvdGFsQ291bnQiLCJyZXR1cm5pbmdWaXNpdG9ycyIsImNvbnZlcnRlZFZpc2l0b3JzIiwibW9iaWxlVmlzaXRvcnMiLCJzdGF0aXN0aWNzIiwicmV0dXJuaW5nUGVyY2VudGFnZSIsIm1vYmlsZVBlcmNlbnRhZ2UiLCJ0aW1lem9uZU1hcCIsImJvdW5jZWRTZXNzaW9ucyIsIndlaWdodHMiLCJjb252ZXJzaW9ucyIsIm1pbiIsImF2Z0ludGVyYWN0aW9ucyIsImF2Z1Njcm9sbERlcHRoIiwicmV2ZXJzZSIsImZvckVhY2giLCJzZXNzaW9uSW5kZXgiLCJwdXNoIiwiYWN0aW9uIiwidGltZVBlclBhZ2UiLCJpIiwicGFnZVRpbWVzdGFtcCIsInZhbHVlIiwiY29udmVyc2lvblR5cGUiLCJjdXJyZW50IiwidG9GaXhlZCIsImNvdW50cmllcyIsIkJvb2xlYW4iLCJsb25nU2Vzc2lvbnMiLCJkZXZpY2VUeXBlcyIsImJyb3dzZXJzIiwib3BlcmF0aW5nU3lzdGVtcyIsIm1vYmlsZSIsImNpdGllcyIsInJlZ2lvbnMiLCJ0b3BDb3VudHJ5IiwidG90YWxDb3VudHJpZXMiLCJrZXlzIiwiZW5nYWdlbWVudFNpZ25hbHMiLCJiZWhhdmlvcmFsU2lnbmFscyIsImludGVudFNpZ25hbHMiLCJyaXNrU2lnbmFscyIsIndlaWdodCIsInRvTG93ZXJDYXNlIiwicmVjb21tZW5kYXRpb25zIiwidXJnZW5jeSIsInByaW9yaXR5IiwiY2hhbm5lbCIsInJlYXNvbiIsImhhc0hpZ2hJbnRlbnQiLCJzb21lIiwidGltaW5nIiwidmlzaXRlZFByaWNpbmciLCJoYXNSaXNrU2lnbmFscyIsImNvbmZpZGVuY2UiLCJyZWFzb25pbmciLCJlbmdhZ2VtZW50TGV2ZWwiLCJ2aXNpdG9yVHlwZSIsInJhbmdlTWFwIiwic3RlcEFuYWx5c2lzIiwicHJldmlvdXNTdGVwVmlzaXRvcnMiLCJzdGVwIiwic3RlcFZpc2l0b3JzIiwic3RlcFJldmVudWUiLCJjb252ZXJ0ZWRTZXNzaW9ucyIsInBhdHRlcm4iLCJSZWdFeHAiLCJ0ZXN0IiwiZHJvcE9mZlJhdGUiLCJyZXZlbnVlIiwic3RlcFJhdGVzIiwicmF0ZSIsImRyb3BPZmZzIiwiZHJvcE9mZiIsInNlZ21lbnQiLCJjcmVhdGVkQnkiLCJtZW1iZXJzIiwiY29udGFjdCIsInNlZ21lbnRBbmFseXNpcyIsIm5ld1Zpc2l0b3JTZXNzaW9ucyIsInJldHVybmluZ1Zpc2l0b3JTZXNzaW9ucyIsIm5ld1Zpc2l0b3JGdW5uZWwiLCJ0b3BEcm9wT2ZmU3RlcCIsInJldHVybmluZ1Zpc2l0b3JGdW5uZWwiLCJtb2JpbGVSZXFzIiwiZGVza3RvcFNlc3Npb25zIiwibW9iaWxlRnVubmVsIiwiZGVza3RvcEZ1bm5lbCIsIm9yZ2FuaWNTZXNzaW9ucyIsImRpcmVjdFNlc3Npb25zIiwic29jaWFsU2Vzc2lvbnMiLCJvcmdhbmljRnVubmVsIiwiY29uc29sZSIsImZpcnN0U3RlcCIsImxhc3RTdGVwIiwidG9Mb2NhbGVTdHJpbmciLCJyZXZlbnVlU3RlcCIsImZpbmQiLCJvdmVyYWxsUmF0ZSIsIm5ld1Zpc2l0b3JzIiwiY29udmVyc2lvbkRpZmYiLCJtb2JpbGVTZWdtZW50IiwiZGVza3RvcFNlZ21lbnQiLCJvcmdhbmljU2VnbWVudCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0NBS0M7Ozs7K0JBaUJZQTs7O2VBQUFBOzs7bUNBZHFCOzBCQVMzQjt3QkFFZ0I7MkJBQ1U7QUFFMUIsTUFBTUEsMkJBQTJCQyxvQ0FBaUI7SUFDdkRDLFlBQVlDLE1BQWlDLENBQUU7UUFDN0MsS0FBSyxDQUFDO1lBQ0osR0FBR0MsMkJBQWdCLENBQUNDLE9BQU8sQ0FBQ0MsU0FBUztZQUNyQyxHQUFHSCxNQUFNO1FBQ1g7SUFDRjtJQUVBOztHQUVDLEdBQ0QsTUFBZ0JJLGNBQWNDLFdBQTJCLEVBQWtCO1FBQ3pFLE1BQU1DLFlBQVk7WUFDaEI7Z0JBQ0VDLEtBQUs7Z0JBQ0xDLE1BQU07Z0JBQ05DLGFBQWE7Z0JBQ2JDLFVBQVU7WUFDWjtZQUNBO2dCQUNFSCxLQUFLO2dCQUNMQyxNQUFNO2dCQUNOQyxhQUFhO2dCQUNiQyxVQUFVO1lBQ1o7WUFDQTtnQkFDRUgsS0FBSztnQkFDTEMsTUFBTTtnQkFDTkMsYUFBYTtnQkFDYkMsVUFBVTtZQUNaO1lBQ0E7Z0JBQ0VILEtBQUs7Z0JBQ0xDLE1BQU07Z0JBQ05DLGFBQWE7Z0JBQ2JDLFVBQVU7WUFDWjtZQUNBO2dCQUNFSCxLQUFLO2dCQUNMQyxNQUFNO2dC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