{"version":3,"sources":["/Users/supreme/Desktop/marketsage/src/__tests__/e2e/global-setup.ts"],"sourcesContent":["import { chromium, FullConfig } from '@playwright/test';\nimport { exec } from 'child_process';\nimport { promisify } from 'util';\n\nconst execAsync = promisify(exec);\n\n/**\n * Global setup for MarketSage E2E tests\n * Prepares database, starts MCP servers, and sets up test data\n */\nasync function globalSetup(config: FullConfig) {\n  console.log('üöÄ Setting up MarketSage E2E test environment...');\n\n  try {\n    // 1. Reset and seed database with MCP test data\n    console.log('üìä Setting up test database...');\n    await execAsync('npm run db:reset');\n    await execAsync('npm run db:migrate');\n    await execAsync('npm run db:seed');\n    await execAsync('npm run seed-mcp-all');\n\n    // 2. Start MCP servers for testing\n    console.log('üîó Starting MCP servers...');\n    await execAsync('npm run test:mcp');\n\n    // 3. Create test user and authenticate\n    console.log('üë§ Creating test user...');\n    const browser = await chromium.launch();\n    const context = await browser.newContext();\n    const page = await context.newPage();\n\n    // Navigate to login and create test account\n    await page.goto('/auth/login');\n    await page.fill('[data-testid=\"email\"]', 'test@marketsage.com');\n    await page.fill('[data-testid=\"password\"]', 'TestPassword123!');\n    \n    // Save authentication state\n    await context.storageState({ path: 'src/__tests__/e2e/auth.json' });\n    \n    await browser.close();\n\n    console.log('‚úÖ E2E test environment ready!');\n  } catch (error) {\n    console.error('‚ùå Failed to setup E2E environment:', error);\n    throw error;\n  }\n}\n\nexport default globalSetup;"],"names":["execAsync","promisify","exec","globalSetup","config","console","log","browser","chromium","launch","context","newContext","page","newPage","goto","fill","storageState","path","close","error"],"mappings":";;;;+BAgDA;;;eAAA;;;sBAhDqC;+BAChB;sBACK;AAE1B,MAAMA,YAAYC,IAAAA,eAAS,EAACC,mBAAI;AAEhC;;;CAGC,GACD,eAAeC,YAAYC,MAAkB;IAC3CC,QAAQC,GAAG,CAAC;IAEZ,IAAI;QACF,gDAAgD;QAChDD,QAAQC,GAAG,CAAC;QACZ,MAAMN,UAAU;QAChB,MAAMA,UAAU;QAChB,MAAMA,UAAU;QAChB,MAAMA,UAAU;QAEhB,mCAAmC;QACnCK,QAAQC,GAAG,CAAC;QACZ,MAAMN,UAAU;QAEhB,uCAAuC;QACvCK,QAAQC,GAAG,CAAC;QACZ,MAAMC,UAAU,MAAMC,cAAQ,CAACC,MAAM;QACrC,MAAMC,UAAU,MAAMH,QAAQI,UAAU;QACxC,MAAMC,OAAO,MAAMF,QAAQG,OAAO;QAElC,4CAA4C;QAC5C,MAAMD,KAAKE,IAAI,CAAC;QAChB,MAAMF,KAAKG,IAAI,CAAC,yBAAyB;QACzC,MAAMH,KAAKG,IAAI,CAAC,4BAA4B;QAE5C,4BAA4B;QAC5B,MAAML,QAAQM,YAAY,CAAC;YAAEC,MAAM;QAA8B;QAEjE,MAAMV,QAAQW,KAAK;QAEnBb,QAAQC,GAAG,CAAC;IACd,EAAE,OAAOa,OAAO;QACdd,QAAQc,KAAK,CAAC,sCAAsCA;QACpD,MAAMA;IACR;AACF;MAEA,WAAehB"}