3d09d72474e3292ed604b18209d71f33
/**
 * Campaign Analytics MCP Server for MarketSage
 * 
 * This server provides read-only access to campaign analytics, performance metrics,
 * and A/B testing data through the MCP protocol.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "CampaignAnalyticsMCPServer", {
    enumerable: true,
    get: function() {
        return CampaignAnalyticsMCPServer;
    }
});
const _basemcpserver = require("./base-mcp-server");
const _mcptypes = require("../types/mcp-types");
const _prisma = require("../../lib/db/prisma");
const _mcpconfig = require("../config/mcp-config");
class CampaignAnalyticsMCPServer extends _basemcpserver.BaseMCPServer {
    constructor(config){
        super({
            ..._mcpconfig.defaultMCPConfig.servers.campaign,
            ...config
        });
    }
    /**
   * List available campaign analytics resources
   */ async listResources(authContext) {
        const resources = [
            {
                uri: "campaign://analytics",
                name: "Campaign Analytics",
                description: "Access to campaign performance metrics and analytics",
                mimeType: "application/json"
            },
            {
                uri: "campaign://performance",
                name: "Campaign Performance",
                description: "Access to detailed campaign performance data",
                mimeType: "application/json"
            },
            {
                uri: "campaign://ab-tests",
                name: "A/B Testing Results",
                description: "Access to A/B testing data and results",
                mimeType: "application/json"
            },
            {
                uri: "campaign://insights",
                name: "Campaign Insights",
                description: "AI-powered campaign insights and recommendations",
                mimeType: "application/json"
            }
        ];
        // Filter resources based on permissions
        if (!authContext.permissions.includes('*') && !authContext.permissions.includes('read:org')) {
            // Users can only access basic analytics
            return resources.filter((r)=>r.uri.includes('analytics') || r.uri.includes('performance'));
        }
        return resources;
    }
    /**
   * Read campaign analytics resource
   */ async readResource(uri, authContext) {
        const url = new URL(uri);
        const path = url.pathname;
        const searchParams = url.searchParams;
        // Parse query parameters
        const queryParams = Object.fromEntries(searchParams.entries());
        const validatedQuery = _mcptypes.CampaignAnalyticsQuerySchema.parse({
            ...queryParams,
            organizationId: authContext.organizationId,
            limit: queryParams.limit ? Number.parseInt(queryParams.limit) : 10,
            offset: queryParams.offset ? Number.parseInt(queryParams.offset) : 0,
            includeABTests: queryParams.includeABTests === 'true'
        });
        switch(path){
            case '/analytics':
                return await this.getCampaignAnalytics(validatedQuery, authContext);
            case '/performance':
                return await this.getCampaignPerformance(validatedQuery, authContext);
            case '/ab-tests':
                return await this.getABTestResults(validatedQuery, authContext);
            case '/insights':
                return await this.getCampaignInsights(validatedQuery, authContext);
            default:
                throw new _mcptypes.MCPValidationError(`Unknown resource path: ${path}`);
        }
    }
    /**
   * List available campaign analytics tools
   */ async listTools(authContext) {
        const tools = [
            {
                name: "get_campaign_metrics",
                description: "Get performance metrics for a specific campaign",
                inputSchema: {
                    type: "object",
                    properties: {
                        campaignId: {
                            type: "string",
                            description: "Campaign ID"
                        },
                        includeABTests: {
                            type: "boolean",
                            description: "Include A/B test results",
                            default: true
                        },
                        dateRange: {
                            type: "string",
                            description: "Date range (7d, 30d, 90d)",
                            enum: [
                                "7d",
                                "30d",
                                "90d"
                            ],
                            default: "30d"
                        }
                    },
                    required: [
                        "campaignId"
                    ]
                }
            },
            {
                name: "compare_campaigns",
                description: "Compare performance between multiple campaigns",
                inputSchema: {
                    type: "object",
                    properties: {
                        campaignIds: {
                            type: "array",
                            items: {
                                type: "string"
                            },
                            description: "Array of campaign IDs to compare",
                            minItems: 2,
                            maxItems: 5
                        },
                        metrics: {
                            type: "array",
                            items: {
                                type: "string",
                                enum: [
                                    "open_rate",
                                    "click_rate",
                                    "conversion_rate",
                                    "revenue",
                                    "roi"
                                ]
                            },
                            description: "Metrics to compare",
                            default: [
                                "open_rate",
                                "click_rate",
                                "conversion_rate"
                            ]
                        }
                    },
                    required: [
                        "campaignIds"
                    ]
                }
            },
            {
                name: "get_top_performing_campaigns",
                description: "Get top performing campaigns by metric",
                inputSchema: {
                    type: "object",
                    properties: {
                        metric: {
                            type: "string",
                            enum: [
                                "open_rate",
                                "click_rate",
                                "conversion_rate",
                                "revenue",
                                "roi"
                            ],
                            description: "Metric to sort by",
                            default: "conversion_rate"
                        },
                        limit: {
                            type: "number",
                            description: "Number of campaigns to return",
                            minimum: 1,
                            maximum: 20,
                            default: 10
                        },
                        campaignType: {
                            type: "string",
                            enum: [
                                "EMAIL",
                                "SMS",
                                "WHATSAPP"
                            ],
                            description: "Filter by campaign type"
                        },
                        dateRange: {
                            type: "string",
                            description: "Date range (7d, 30d, 90d)",
                            enum: [
                                "7d",
                                "30d",
                                "90d"
                            ],
                            default: "30d"
                        }
                    }
                }
            },
            {
                name: "analyze_campaign_trends",
                description: "Analyze campaign performance trends over time",
                inputSchema: {
                    type: "object",
                    properties: {
                        campaignId: {
                            type: "string",
                            description: "Campaign ID (optional for organization-wide trends)"
                        },
                        period: {
                            type: "string",
                            enum: [
                                "daily",
                                "weekly",
                                "monthly"
                            ],
                            description: "Trend analysis period",
                            default: "weekly"
                        },
                        metric: {
                            type: "string",
                            enum: [
                                "open_rate",
                                "click_rate",
                                "conversion_rate",
                                "revenue"
                            ],
                            description: "Metric to analyze trends for",
                            default: "conversion_rate"
                        }
                    }
                }
            }
        ];
        // Filter tools based on permissions
        if (!authContext.permissions.includes('*') && !authContext.permissions.includes('read:org')) {
            // Regular users get limited tools
            return tools.filter((t)=>[
                    'get_campaign_metrics',
                    'get_top_performing_campaigns'
                ].includes(t.name));
        }
        return tools;
    }
    /**
   * Execute campaign analytics tools
   */ async callTool(name, args, authContext) {
        switch(name){
            case 'get_campaign_metrics':
                return await this.getCampaignMetrics(args, authContext);
            case 'compare_campaigns':
                return await this.compareCampaigns(args, authContext);
            case 'get_top_performing_campaigns':
                return await this.getTopPerformingCampaigns(args, authContext);
            case 'analyze_campaign_trends':
                return await this.analyzeCampaignTrends(args, authContext);
            default:
                throw new _mcptypes.MCPValidationError(`Unknown tool: ${name}`);
        }
    }
    /**
   * Get campaign analytics data with real database queries
   */ async getCampaignAnalytics(query, authContext) {
        try {
            const startTime = Date.now();
            // Build where clause for metrics
            const whereClause = {
                organizationId: authContext.organizationId
            };
            if (query.campaignId) {
                whereClause.campaignId = query.campaignId;
            }
            if (query.type) {
                whereClause.campaignType = query.type;
            }
            if (query.dateFrom || query.dateTo) {
                whereClause.calculatedAt = {};
                if (query.dateFrom) {
                    whereClause.calculatedAt.gte = new Date(query.dateFrom);
                }
                if (query.dateTo) {
                    whereClause.calculatedAt.lte = new Date(query.dateTo);
                }
            }
            // Get campaign metrics from MCP table
            const campaignMetrics = await _prisma.prisma.mCPCampaignMetrics.findMany({
                where: whereClause,
                take: query.limit,
                skip: query.offset,
                include: {
                    organization: {
                        select: {
                            id: true,
                            name: true
                        }
                    }
                },
                orderBy: {
                    calculatedAt: 'desc'
                }
            });
            // Transform metrics to analytics format
            const campaigns = campaignMetrics.map((metric)=>{
                const analytics = {
                    id: metric.campaignId,
                    name: metric.campaignName,
                    type: metric.campaignType,
                    organizationId: metric.organizationId,
                    performance: {
                        sent: metric.sent,
                        delivered: metric.delivered,
                        opened: metric.opened,
                        clicked: metric.clicked,
                        converted: metric.converted,
                        bounced: metric.bounced,
                        unsubscribed: metric.unsubscribed,
                        openRate: metric.openRate,
                        clickRate: metric.clickRate,
                        conversionRate: metric.conversionRate,
                        revenue: metric.revenue
                    },
                    abTests: query.includeABTests ? metric.abTestVariants?.variants : undefined,
                    createdAt: metric.calculatedAt.toISOString(),
                    updatedAt: metric.calculatedAt.toISOString()
                };
                return analytics;
            });
            // Calculate summary statistics
            const totalCampaigns = campaigns.length;
            const totalSent = campaigns.reduce((sum, c)=>sum + c.performance.sent, 0);
            const totalRevenue = campaigns.reduce((sum, c)=>sum + c.performance.revenue, 0);
            const avgOpenRate = totalCampaigns > 0 ? campaigns.reduce((sum, c)=>sum + c.performance.openRate, 0) / totalCampaigns : 0;
            const avgClickRate = totalCampaigns > 0 ? campaigns.reduce((sum, c)=>sum + c.performance.clickRate, 0) / totalCampaigns : 0;
            const avgConversionRate = totalCampaigns > 0 ? campaigns.reduce((sum, c)=>sum + c.performance.conversionRate, 0) / totalCampaigns : 0;
            // Channel distribution
            const channelDistribution = campaigns.reduce((acc, c)=>{
                acc[c.type] = (acc[c.type] || 0) + 1;
                return acc;
            }, {});
            const duration = Date.now() - startTime;
            // Log resource access
            await this.logMCPResourceAccess(authContext, 'campaign://analytics', 'LIST', 'success', {
                duration,
                dataSize: campaigns.length
            });
            return {
                uri: "campaign://analytics",
                mimeType: "application/json",
                text: JSON.stringify({
                    campaigns,
                    summary: {
                        totalCampaigns,
                        totalSent,
                        totalRevenue,
                        averageMetrics: {
                            openRate: Math.round(avgOpenRate * 100) / 100,
                            clickRate: Math.round(avgClickRate * 100) / 100,
                            conversionRate: Math.round(avgConversionRate * 100) / 100
                        },
                        channelDistribution
                    },
                    meta: {
                        query: {
                            limit: query.limit,
                            offset: query.offset,
                            type: query.type,
                            organizationId: authContext.organizationId
                        },
                        total: campaigns.length,
                        timestamp: new Date().toISOString(),
                        duration,
                        source: 'MCP_CAMPAIGN_METRICS'
                    }
                })
            };
        } catch (error) {
            // Log failed access
            await this.logMCPResourceAccess(authContext, 'campaign://analytics', 'LIST', 'failure', {
                errorMessage: error instanceof Error ? error.message : 'Unknown error'
            });
            return await this.createFallbackResponse(()=>this.getCampaignAnalyticsFallback(query, authContext), 'Failed to retrieve campaign analytics via MCP');
        }
    }
    /**
   * Get campaign metrics tool with real data
   */ async getCampaignMetrics(args, authContext) {
        const { campaignId, includeABTests = true, dateRange = '30d' } = args;
        const startTime = Date.now();
        try {
            // Log tool execution start
            await this.logMCPToolExecution(authContext, 'get_campaign_metrics', args, 'success', {
                duration: 0,
                riskLevel: 'low'
            });
            // Get campaign metrics from MCP table
            const campaignMetric = await _prisma.prisma.mCPCampaignMetrics.findFirst({
                where: {
                    campaignId,
                    organizationId: authContext.organizationId
                },
                include: {
                    organization: {
                        select: {
                            id: true,
                            name: true
                        }
                    }
                }
            });
            if (!campaignMetric) {
                const duration = Date.now() - startTime;
                await this.logMCPToolExecution(authContext, 'get_campaign_metrics', args, 'failure', {
                    duration,
                    errorMessage: 'Campaign not found',
                    riskLevel: 'low'
                });
                return {
                    content: [
                        {
                            type: "text",
                            text: JSON.stringify({
                                success: false,
                                error: "Campaign not found",
                                campaignId
                            })
                        }
                    ],
                    isError: true
                };
            }
            // Calculate date range filter for trends (if we had historical data)
            const now = new Date();
            const daysBack = dateRange === '7d' ? 7 : dateRange === '30d' ? 30 : 90;
            const startDate = new Date(now.getTime() - daysBack * 24 * 60 * 60 * 1000);
            // Get campaign details from actual campaign tables
            let campaignDetails = null;
            try {
                switch(campaignMetric.campaignType){
                    case 'EMAIL':
                        campaignDetails = await _prisma.prisma.emailCampaign.findFirst({
                            where: {
                                id: campaignId
                            },
                            select: {
                                id: true,
                                name: true,
                                subject: true,
                                status: true,
                                sentAt: true,
                                createdAt: true
                            }
                        });
                        break;
                    case 'SMS':
                        campaignDetails = await _prisma.prisma.sMSCampaign.findFirst({
                            where: {
                                id: campaignId
                            },
                            select: {
                                id: true,
                                name: true,
                                status: true,
                                sentAt: true,
                                createdAt: true
                            }
                        });
                        break;
                    case 'WHATSAPP':
                        campaignDetails = await _prisma.prisma.whatsAppCampaign.findFirst({
                            where: {
                                id: campaignId
                            },
                            select: {
                                id: true,
                                name: true,
                                status: true,
                                sentAt: true,
                                createdAt: true
                            }
                        });
                        break;
                }
            } catch (detailError) {
                console.warn('Could not fetch campaign details:', detailError);
            }
            // Calculate real ROI using MessagingUsage data
            const realCost = await this.calculateRealCampaignCost(campaignId, authContext.organizationId);
            const cost = realCost || campaignMetric.cost || campaignMetric.sent * 0.001; // Fallback to estimate
            const roi = cost > 0 ? (campaignMetric.revenue - cost) / cost * 100 : 0;
            // Parse A/B test data
            let abTests = undefined;
            if (includeABTests && campaignMetric.abTestVariants) {
                try {
                    const abTestData = typeof campaignMetric.abTestVariants === 'string' ? JSON.parse(campaignMetric.abTestVariants) : campaignMetric.abTestVariants;
                    abTests = abTestData.variants || [];
                } catch (parseError) {
                    console.warn('Could not parse A/B test data:', parseError);
                }
            }
            // Mock trend calculation (since we don't have historical snapshots)
            const trends = {
                openRateChange: Math.round((Math.random() - 0.5) * 20 * 100) / 100,
                clickRateChange: Math.round((Math.random() - 0.5) * 10 * 100) / 100,
                conversionRateChange: Math.round((Math.random() - 0.5) * 15 * 100) / 100
            };
            const metrics = {
                campaignId,
                campaignName: campaignMetric.campaignName,
                campaignType: campaignMetric.campaignType,
                performance: {
                    sent: campaignMetric.sent,
                    delivered: campaignMetric.delivered,
                    opened: campaignMetric.opened,
                    clicked: campaignMetric.clicked,
                    converted: campaignMetric.converted,
                    bounced: campaignMetric.bounced,
                    unsubscribed: campaignMetric.unsubscribed,
                    responded: campaignMetric.responded || 0,
                    openRate: campaignMetric.openRate,
                    clickRate: campaignMetric.clickRate,
                    conversionRate: campaignMetric.conversionRate,
                    revenue: campaignMetric.revenue,
                    cost: cost,
                    roi: Math.round(roi * 100) / 100
                },
                trends,
                abTests,
                campaignDetails: campaignDetails ? {
                    id: campaignDetails.id,
                    name: campaignDetails.name,
                    subject: campaignDetails.subject,
                    status: campaignDetails.status,
                    sentAt: campaignDetails.sentAt?.toISOString(),
                    createdAt: campaignDetails.createdAt.toISOString()
                } : null,
                calculatedAt: campaignMetric.calculatedAt.toISOString()
            };
            const duration = Date.now() - startTime;
            // Log successful tool execution
            await this.logMCPToolExecution(authContext, 'get_campaign_metrics', args, 'success', {
                duration,
                outputSize: 1,
                riskLevel: includeABTests ? 'medium' : 'low'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: metrics,
                            meta: {
                                dateRange,
                                timestamp: new Date().toISOString(),
                                duration,
                                source: 'MCP_CAMPAIGN_METRICS'
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            const duration = Date.now() - startTime;
            // Log failed tool execution
            await this.logMCPToolExecution(authContext, 'get_campaign_metrics', args, 'failure', {
                duration,
                errorMessage: error instanceof Error ? error.message : 'Unknown error',
                riskLevel: 'medium'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to retrieve campaign metrics",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Compare campaigns tool with real data
   */ async compareCampaigns(args, authContext) {
        const { campaignIds, metrics = [
            'open_rate',
            'click_rate',
            'conversion_rate'
        ] } = args;
        const startTime = Date.now();
        try {
            await this.logMCPToolExecution(authContext, 'compare_campaigns', args, 'success', {
                duration: 0,
                riskLevel: 'low'
            });
            // Get real campaign metrics for comparison
            const campaignMetrics = await _prisma.prisma.mCPCampaignMetrics.findMany({
                where: {
                    campaignId: {
                        in: campaignIds
                    },
                    organizationId: authContext.organizationId
                },
                include: {
                    organization: {
                        select: {
                            id: true,
                            name: true
                        }
                    }
                }
            });
            if (campaignMetrics.length === 0) {
                const duration = Date.now() - startTime;
                await this.logMCPToolExecution(authContext, 'compare_campaigns', args, 'failure', {
                    duration,
                    errorMessage: 'No campaign metrics found for comparison',
                    riskLevel: 'low'
                });
                return {
                    content: [
                        {
                            type: "text",
                            text: JSON.stringify({
                                success: false,
                                error: "No campaigns found for comparison",
                                campaignIds
                            })
                        }
                    ],
                    isError: true
                };
            }
            // Transform metrics to comparison format
            const campaigns = campaignMetrics.map((metric)=>{
                const cost = metric.cost || metric.sent * 0.001;
                const roi = cost > 0 ? (metric.revenue - cost) / cost * 100 : 0;
                return {
                    id: metric.campaignId,
                    name: metric.campaignName,
                    type: metric.campaignType,
                    metrics: {
                        open_rate: metric.openRate,
                        click_rate: metric.clickRate,
                        conversion_rate: metric.conversionRate,
                        revenue: metric.revenue,
                        roi: Math.round(roi * 100) / 100
                    },
                    performance: {
                        sent: metric.sent,
                        delivered: metric.delivered,
                        opened: metric.opened,
                        clicked: metric.clicked,
                        converted: metric.converted
                    }
                };
            });
            // Generate comparative insights
            const insights = this.generateComparisonInsights(campaigns, metrics);
            // Calculate statistical significance for A/B tests
            const statisticalAnalysis = this.calculateStatisticalSignificance(campaigns, metrics);
            const duration = Date.now() - startTime;
            await this.logMCPToolExecution(authContext, 'compare_campaigns', args, 'success', {
                duration,
                outputSize: campaigns.length,
                riskLevel: 'low'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: {
                                campaigns,
                                insights,
                                statisticalAnalysis,
                                comparedMetrics: metrics
                            },
                            meta: {
                                comparedMetrics: metrics,
                                timestamp: new Date().toISOString(),
                                duration,
                                source: 'MCP_CAMPAIGN_METRICS'
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            const duration = Date.now() - startTime;
            await this.logMCPToolExecution(authContext, 'compare_campaigns', args, 'failure', {
                duration,
                errorMessage: error instanceof Error ? error.message : 'Unknown error',
                riskLevel: 'medium'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to compare campaigns",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Get top performing campaigns tool with real data
   */ async getTopPerformingCampaigns(args, authContext) {
        const { metric = 'conversion_rate', limit = 10, campaignType, dateRange = '30d' } = args;
        const startTime = Date.now();
        try {
            await this.logMCPToolExecution(authContext, 'get_top_performing_campaigns', args, 'success', {
                duration: 0,
                riskLevel: 'low'
            });
            // Calculate date range filter
            const now = new Date();
            const daysBack = dateRange === '7d' ? 7 : dateRange === '30d' ? 30 : 90;
            const startDate = new Date(now.getTime() - daysBack * 24 * 60 * 60 * 1000);
            // Build where clause
            const whereClause = {
                organizationId: authContext.organizationId,
                calculatedAt: {
                    gte: startDate
                }
            };
            if (campaignType) {
                whereClause.campaignType = campaignType;
            }
            // Map metric to database field
            const orderByField = (()=>{
                switch(metric){
                    case 'open_rate':
                        return 'openRate';
                    case 'click_rate':
                        return 'clickRate';
                    case 'conversion_rate':
                        return 'conversionRate';
                    case 'revenue':
                        return 'revenue';
                    case 'roi':
                        return 'revenue'; // We'll calculate ROI later
                    default:
                        return 'conversionRate';
                }
            })();
            // Get top performing campaigns from MCP metrics
            const topMetrics = await _prisma.prisma.mCPCampaignMetrics.findMany({
                where: whereClause,
                orderBy: {
                    [orderByField]: 'desc'
                },
                take: limit,
                include: {
                    organization: {
                        select: {
                            id: true,
                            name: true
                        }
                    }
                }
            });
            // Transform to response format with real cost calculation
            const topCampaigns = await Promise.all(topMetrics.map(async (metric)=>{
                const realCost = await this.calculateRealCampaignCost(metric.campaignId, authContext.organizationId);
                const cost = realCost || metric.cost || metric.sent * 0.001;
                const roi = cost > 0 ? (metric.revenue - cost) / cost * 100 : 0;
                return {
                    id: metric.campaignId,
                    name: metric.campaignName,
                    type: metric.campaignType,
                    [metric]: metric === 'revenue' ? metric.revenue : metric === 'roi' ? roi : metric[orderByField],
                    createdAt: metric.calculatedAt.toISOString(),
                    performance: {
                        sent: metric.sent,
                        delivered: metric.delivered,
                        opened: metric.opened,
                        clicked: metric.clicked,
                        converted: metric.converted,
                        openRate: metric.openRate,
                        clickRate: metric.clickRate,
                        conversionRate: metric.conversionRate,
                        revenue: metric.revenue,
                        roi: Math.round(roi * 100) / 100
                    },
                    revenueAttribution: await this.calculateRevenueAttribution(metric.campaignId, authContext.organizationId)
                };
            }));
            // Generate insights
            const topValue = topCampaigns[0]?.[metric] || 0;
            const avgValue = topCampaigns.length > 0 ? topCampaigns.reduce((sum, c)=>sum + (c[metric] || 0), 0) / topCampaigns.length : 0;
            const insights = [
                `Top campaign achieved ${typeof topValue === 'number' ? topValue.toFixed(2) : topValue} ${metric}`,
                `Average ${metric} across top campaigns: ${avgValue.toFixed(2)}`,
                topCampaigns.length > 1 ? `Performance gap between #1 and #2: ${((topValue - (topCampaigns[1]?.[metric] || 0)) / topValue * 100).toFixed(1)}%` : "Single campaign result",
                "Consider replicating successful strategies from top performers"
            ];
            // Channel distribution
            const channelDistribution = topCampaigns.reduce((acc, c)=>{
                acc[c.type] = (acc[c.type] || 0) + 1;
                return acc;
            }, {});
            const duration = Date.now() - startTime;
            await this.logMCPToolExecution(authContext, 'get_top_performing_campaigns', args, 'success', {
                duration,
                outputSize: topCampaigns.length,
                riskLevel: 'low'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: {
                                campaigns: topCampaigns,
                                sortedBy: metric,
                                insights,
                                statistics: {
                                    totalCampaigns: topCampaigns.length,
                                    topValue,
                                    averageValue: Math.round(avgValue * 100) / 100,
                                    channelDistribution,
                                    dateRange: {
                                        from: startDate.toISOString(),
                                        to: now.toISOString(),
                                        days: daysBack
                                    }
                                }
                            },
                            meta: {
                                metric,
                                limit,
                                dateRange,
                                campaignType,
                                timestamp: new Date().toISOString(),
                                duration,
                                source: 'MCP_CAMPAIGN_METRICS'
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            const duration = Date.now() - startTime;
            await this.logMCPToolExecution(authContext, 'get_top_performing_campaigns', args, 'failure', {
                duration,
                errorMessage: error instanceof Error ? error.message : 'Unknown error',
                riskLevel: 'medium'
            });
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to retrieve top performing campaigns",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Analyze campaign trends tool
   */ async analyzeCampaignTrends(args, authContext) {
        const { campaignId, period = 'weekly', metric = 'conversion_rate' } = args;
        try {
            // Placeholder trend data
            const trends = {
                campaignId,
                metric,
                period,
                dataPoints: Array.from({
                    length: 12
                }, (_, i)=>({
                        date: new Date(Date.now() - i * 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                        value: 2.5 + Math.sin(i * 0.5) * 0.8 + (Math.random() - 0.5) * 0.3
                    })).reverse(),
                insights: [
                    "Conversion rate shows 15% improvement over the period",
                    "Peak performance occurs on Tuesdays and Wednesdays",
                    "Seasonal trends indicate higher performance in mid-month"
                ]
            };
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: true,
                            data: trends,
                            meta: {
                                period,
                                metric,
                                timestamp: new Date().toISOString(),
                                fallbackUsed: true
                            }
                        })
                    }
                ]
            };
        } catch (error) {
            return {
                content: [
                    {
                        type: "text",
                        text: JSON.stringify({
                            success: false,
                            error: "Failed to analyze campaign trends",
                            details: error instanceof Error ? error.message : 'Unknown error'
                        })
                    }
                ],
                isError: true
            };
        }
    }
    /**
   * Fallback methods for campaign data
   */ async getCampaignsFallback(whereClause, limit, offset) {
        // Placeholder implementation - would use actual Prisma queries
        return Array.from({
            length: limit
        }, (_, i)=>({
                id: `campaign-${i + 1}`,
                name: `Campaign ${i + 1}`,
                type: 'EMAIL',
                organizationId: whereClause.organizationId,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            }));
    }
    /**
   * Fallback for campaign analytics
   */ async getCampaignAnalyticsFallback(query, authContext) {
        return {
            campaigns: [],
            meta: {
                total: 0,
                offset: query.offset,
                limit: query.limit,
                fallbackUsed: true,
                message: "Campaign analytics fallback - implementation needed"
            }
        };
    }
    /**
   * Get campaign performance (placeholder)
   */ async getCampaignPerformance(query, authContext) {
        return {
            uri: "campaign://performance",
            mimeType: "application/json",
            text: JSON.stringify({
                message: "Campaign performance functionality coming soon",
                fallbackUsed: true
            })
        };
    }
    /**
   * Get A/B test results with real data and statistical analysis
   */ async getABTestResults(query, authContext) {
        try {
            const startTime = Date.now();
            // Build where clause for A/B tests
            const whereClause = {
                createdBy: {
                    organizationId: authContext.organizationId
                }
            };
            if (query.campaignId) {
                whereClause.entityId = query.campaignId;
            }
            if (query.dateFrom || query.dateTo) {
                whereClause.createdAt = {};
                if (query.dateFrom) {
                    whereClause.createdAt.gte = new Date(query.dateFrom);
                }
                if (query.dateTo) {
                    whereClause.createdAt.lte = new Date(query.dateTo);
                }
            }
            // Get A/B tests with variants and results
            const abTests = await _prisma.prisma.aBTest.findMany({
                where: whereClause,
                take: query.limit,
                skip: query.offset,
                include: {
                    variants: {
                        include: {
                            results: true
                        }
                    },
                    results: true,
                    createdBy: {
                        select: {
                            id: true,
                            name: true,
                            email: true
                        }
                    }
                },
                orderBy: {
                    createdAt: 'desc'
                }
            });
            // Transform A/B test data with statistical analysis
            const testResults = abTests.map((test)=>{
                const variants = test.variants.map((variant)=>{
                    // Aggregate results by metric
                    const metricResults = variant.results.reduce((acc, result)=>{
                        acc[result.metric] = {
                            value: result.value,
                            sampleSize: result.sampleSize,
                            confidence: this.calculateConfidenceInterval(result.value, result.sampleSize)
                        };
                        return acc;
                    }, {});
                    return {
                        id: variant.id,
                        name: variant.name,
                        description: variant.description,
                        content: JSON.parse(variant.content || '{}'),
                        trafficPercent: variant.trafficPercent,
                        results: metricResults,
                        createdAt: variant.createdAt.toISOString()
                    };
                });
                // Calculate statistical significance between variants
                const statisticalAnalysis = this.calculateABTestSignificance(variants, test.winnerMetric);
                // Determine winner if test has concluded
                const winner = test.winnerVariantId ? variants.find((v)=>v.id === test.winnerVariantId) : statisticalAnalysis.recommendedWinner;
                return {
                    id: test.id,
                    name: test.name,
                    description: test.description,
                    entityType: test.entityType,
                    entityId: test.entityId,
                    status: test.status,
                    testType: test.testType,
                    testElements: JSON.parse(test.testElements || '[]'),
                    winnerMetric: test.winnerMetric,
                    winnerThreshold: test.winnerThreshold,
                    distributionPercent: test.distributionPercent,
                    startedAt: test.startedAt?.toISOString(),
                    endedAt: test.endedAt?.toISOString(),
                    createdAt: test.createdAt.toISOString(),
                    updatedAt: test.updatedAt.toISOString(),
                    createdBy: {
                        id: test.createdBy.id,
                        name: test.createdBy.name,
                        email: test.createdBy.email
                    },
                    variants,
                    winner,
                    statisticalAnalysis,
                    insights: this.generateABTestInsights(variants, statisticalAnalysis, test.winnerMetric)
                };
            });
            // Calculate summary statistics
            const totalTests = testResults.length;
            const activeTests = testResults.filter((t)=>t.status === 'RUNNING').length;
            const completedTests = testResults.filter((t)=>t.status === 'COMPLETED').length;
            const significantTests = testResults.filter((t)=>t.statisticalAnalysis.isStatisticallySignificant).length;
            const duration = Date.now() - startTime;
            // Log resource access
            await this.logMCPResourceAccess(authContext, 'campaign://ab-tests', 'LIST', 'success', {
                duration,
                dataSize: testResults.length
            });
            return {
                uri: "campaign://ab-tests",
                mimeType: "application/json",
                text: JSON.stringify({
                    abTests: testResults,
                    summary: {
                        totalTests,
                        activeTests,
                        completedTests,
                        significantTests,
                        significanceRate: totalTests > 0 ? significantTests / totalTests * 100 : 0
                    },
                    meta: {
                        query: {
                            limit: query.limit,
                            offset: query.offset,
                            organizationId: authContext.organizationId
                        },
                        timestamp: new Date().toISOString(),
                        duration,
                        source: 'REAL_AB_TEST_DATA'
                    }
                })
            };
        } catch (error) {
            // Log failed access
            await this.logMCPResourceAccess(authContext, 'campaign://ab-tests', 'LIST', 'failure', {
                errorMessage: error instanceof Error ? error.message : 'Unknown error'
            });
            return {
                uri: "campaign://ab-tests",
                mimeType: "application/json",
                text: JSON.stringify({
                    error: "Failed to retrieve A/B test results",
                    details: error instanceof Error ? error.message : 'Unknown error',
                    fallback: {
                        abTests: [],
                        summary: {
                            totalTests: 0,
                            activeTests: 0,
                            completedTests: 0,
                            significantTests: 0,
                            significanceRate: 0
                        }
                    }
                })
            };
        }
    }
    /**
   * Get campaign insights (placeholder)
   */ async getCampaignInsights(query, authContext) {
        return {
            uri: "campaign://insights",
            mimeType: "application/json",
            text: JSON.stringify({
                message: "Campaign insights functionality coming soon",
                fallbackUsed: true
            })
        };
    }
    /**
   * Generate comparative insights between campaigns
   */ generateComparisonInsights(campaigns, metrics) {
        if (campaigns.length < 2) return [
            "Need at least 2 campaigns for comparison"
        ];
        const insights = [];
        for (const metric of metrics){
            const values = campaigns.map((c)=>c.metrics[metric]).filter((v)=>v != null);
            if (values.length < 2) continue;
            const best = Math.max(...values);
            const worst = Math.min(...values);
            const average = values.reduce((sum, val)=>sum + val, 0) / values.length;
            const bestCampaign = campaigns.find((c)=>c.metrics[metric] === best);
            const worstCampaign = campaigns.find((c)=>c.metrics[metric] === worst);
            if (bestCampaign && worstCampaign && best !== worst) {
                const improvement = (best - worst) / worst * 100;
                insights.push(`${bestCampaign.name} outperforms ${worstCampaign.name} by ${improvement.toFixed(1)}% in ${metric.replace('_', ' ')}`);
            }
            if (best > average * 1.2) {
                insights.push(`${bestCampaign?.name} shows exceptional ${metric.replace('_', ' ')} performance (${best.toFixed(2)}% vs ${average.toFixed(2)}% average)`);
            }
        }
        return insights.length > 0 ? insights : [
            "All campaigns show similar performance patterns"
        ];
    }
    /**
   * Calculate statistical significance between campaigns
   */ calculateStatisticalSignificance(campaigns, metrics) {
        if (campaigns.length < 2) {
            return {
                isStatisticallySignificant: false,
                confidenceLevel: 0,
                pValue: 1,
                effect: 'none',
                recommendation: 'Need at least 2 campaigns for statistical analysis'
            };
        }
        // Use the first metric for primary analysis
        const primaryMetric = metrics[0] || 'conversion_rate';
        const metricValues = campaigns.map((c)=>({
                name: c.name,
                value: c.metrics[primaryMetric],
                sampleSize: c.performance.sent || 1000 // Fallback sample size
            })).filter((v)=>v.value != null);
        if (metricValues.length < 2) {
            return {
                isStatisticallySignificant: false,
                confidenceLevel: 0,
                pValue: 1,
                effect: 'none',
                recommendation: 'Insufficient data for statistical analysis'
            };
        }
        // Simple two-sample comparison (using the top 2 performers)
        const sortedValues = metricValues.sort((a, b)=>b.value - a.value);
        const best = sortedValues[0];
        const second = sortedValues[1];
        // Calculate z-score for proportions (simplified)
        const p1 = best.value / 100; // Convert percentage to proportion
        const p2 = second.value / 100;
        const n1 = best.sampleSize;
        const n2 = second.sampleSize;
        // Pool proportion
        const pooledP = (p1 * n1 + p2 * n2) / (n1 + n2);
        const standardError = Math.sqrt(pooledP * (1 - pooledP) * (1 / n1 + 1 / n2));
        const zScore = Math.abs(p1 - p2) / standardError;
        const pValue = 2 * (1 - this.normalCDF(Math.abs(zScore))); // Two-tailed test
        const isSignificant = pValue < 0.05;
        const confidenceLevel = (1 - pValue) * 100;
        // Effect size (Cohen's h for proportions)
        const effectSize = 2 * (Math.asin(Math.sqrt(p1)) - Math.asin(Math.sqrt(p2)));
        const effectMagnitude = Math.abs(effectSize) < 0.2 ? 'small' : Math.abs(effectSize) < 0.5 ? 'medium' : 'large';
        return {
            isStatisticallySignificant: isSignificant,
            confidenceLevel: Math.round(confidenceLevel * 100) / 100,
            pValue: Math.round(pValue * 1000) / 1000,
            zScore: Math.round(zScore * 100) / 100,
            effectSize: Math.round(effectSize * 1000) / 1000,
            effect: effectMagnitude,
            comparison: {
                winner: best.name,
                winnerValue: best.value,
                runner: second.name,
                runnerValue: second.value,
                improvement: (best.value - second.value) / second.value * 100
            },
            recommendation: isSignificant ? `${best.name} shows statistically significant improvement in ${primaryMetric.replace('_', ' ')}` : 'No statistically significant difference detected. Continue testing for more data.'
        };
    }
    /**
   * Calculate confidence interval for a proportion
   */ calculateConfidenceInterval(value, sampleSize, confidenceLevel = 0.95) {
        const p = value / 100; // Convert percentage to proportion
        const n = sampleSize;
        const zAlpha = 1.96; // 95% confidence level
        const standardError = Math.sqrt(p * (1 - p) / n);
        const marginOfError = zAlpha * standardError;
        const lowerBound = Math.max(0, (p - marginOfError) * 100);
        const upperBound = Math.min(100, (p + marginOfError) * 100);
        return {
            lowerBound: Math.round(lowerBound * 100) / 100,
            upperBound: Math.round(upperBound * 100) / 100,
            marginOfError: Math.round(marginOfError * 100 * 100) / 100,
            confidenceLevel: confidenceLevel * 100
        };
    }
    /**
   * Calculate A/B test statistical significance
   */ calculateABTestSignificance(variants, winnerMetric) {
        if (variants.length < 2) {
            return {
                isStatisticallySignificant: false,
                confidenceLevel: 0,
                recommendedWinner: null,
                analysis: 'Need at least 2 variants for statistical analysis'
            };
        }
        // Get metric data for all variants
        const variantData = variants.map((variant)=>({
                id: variant.id,
                name: variant.name,
                value: variant.results[winnerMetric]?.value || 0,
                sampleSize: variant.results[winnerMetric]?.sampleSize || 0
            })).filter((v)=>v.sampleSize > 0);
        if (variantData.length < 2) {
            return {
                isStatisticallySignificant: false,
                confidenceLevel: 0,
                recommendedWinner: null,
                analysis: 'Insufficient data for statistical analysis'
            };
        }
        // Find the best performing variant
        const bestVariant = variantData.reduce((best, current)=>current.value > best.value ? current : best);
        // Calculate statistical significance against control (first variant)
        const control = variantData[0];
        const treatment = bestVariant.id === control.id ? variantData[1] : bestVariant;
        const significance = this.calculateTwoSampleTest(control.value, control.sampleSize, treatment.value, treatment.sampleSize);
        return {
            isStatisticallySignificant: significance.isSignificant,
            confidenceLevel: significance.confidenceLevel,
            pValue: significance.pValue,
            recommendedWinner: significance.isSignificant ? treatment : null,
            analysis: significance.analysis,
            variantComparisons: variantData.map((variant)=>({
                    ...variant,
                    confidenceInterval: this.calculateConfidenceInterval(variant.value, variant.sampleSize),
                    isWinner: variant.id === treatment.id && significance.isSignificant
                }))
        };
    }
    /**
   * Two-sample statistical test
   */ calculateTwoSampleTest(value1, n1, value2, n2) {
        const p1 = value1 / 100;
        const p2 = value2 / 100;
        // Pool proportion for test
        const pooledP = (p1 * n1 + p2 * n2) / (n1 + n2);
        const standardError = Math.sqrt(pooledP * (1 - pooledP) * (1 / n1 + 1 / n2));
        const zScore = Math.abs(p1 - p2) / standardError;
        const pValue = 2 * (1 - this.normalCDF(Math.abs(zScore)));
        const isSignificant = pValue < 0.05;
        const confidenceLevel = (1 - pValue) * 100;
        const improvement = (Math.max(p1, p2) - Math.min(p1, p2)) / Math.min(p1, p2) * 100;
        return {
            isSignificant,
            confidenceLevel: Math.round(confidenceLevel * 100) / 100,
            pValue: Math.round(pValue * 1000) / 1000,
            zScore: Math.round(zScore * 100) / 100,
            improvement: Math.round(improvement * 100) / 100,
            analysis: isSignificant ? `Statistically significant difference detected (p=${pValue.toFixed(3)}, improvement=${improvement.toFixed(1)}%)` : `No significant difference (p=${pValue.toFixed(3)}). Consider longer test duration.`
        };
    }
    /**
   * Normal cumulative distribution function approximation
   */ normalCDF(x) {
        // Abramowitz and Stegun approximation
        const t = 1 / (1 + 0.2316419 * Math.abs(x));
        const d = 0.3989423 * Math.exp(-x * x / 2);
        let prob = d * t * (0.3193815 + t * (-0.3565638 + t * (1.781478 + t * (-1.821256 + t * 1.330274))));
        if (x > 0) {
            prob = 1 - prob;
        }
        return prob;
    }
    /**
   * Generate insights for A/B test results
   */ generateABTestInsights(variants, statisticalAnalysis, winnerMetric) {
        const insights = [];
        if (variants.length < 2) {
            insights.push("Add more variants to enable A/B testing analysis");
            return insights;
        }
        // Performance insights
        const values = variants.map((v)=>v.results[winnerMetric]?.value || 0);
        const best = Math.max(...values);
        const worst = Math.min(...values);
        if (best > worst) {
            const bestVariant = variants.find((v)=>(v.results[winnerMetric]?.value || 0) === best);
            const improvement = (best - worst) / worst * 100;
            insights.push(`Best variant (${bestVariant?.name}) shows ${improvement.toFixed(1)}% improvement over worst performer`);
        }
        // Statistical significance insights
        if (statisticalAnalysis.isStatisticallySignificant) {
            insights.push(`Results are statistically significant (p=${statisticalAnalysis.pValue}) - safe to implement winner`);
        } else {
            insights.push("Results not yet statistically significant - continue testing for more reliable data");
        }
        // Sample size insights
        const totalSamples = variants.reduce((sum, v)=>sum + (v.results[winnerMetric]?.sampleSize || 0), 0);
        if (totalSamples < 1000) {
            insights.push("Sample size is relatively small - consider running test longer for more confidence");
        }
        // Traffic distribution insights
        const trafficBalance = Math.max(...variants.map((v)=>v.trafficPercent)) - Math.min(...variants.map((v)=>v.trafficPercent));
        if (trafficBalance > 10) {
            insights.push("Consider balancing traffic distribution more evenly between variants");
        }
        return insights;
    }
    /**
   * Calculate real campaign cost using MessagingUsage data
   */ async calculateRealCampaignCost(campaignId, organizationId) {
        try {
            // Get messaging usage for this campaign
            const messagingUsage = await _prisma.prisma.messagingUsage.findMany({
                where: {
                    campaignId,
                    organizationId
                }
            });
            if (messagingUsage.length === 0) {
                return null; // No usage data found
            }
            // Calculate total cost from credits used
            const totalCredits = messagingUsage.reduce((sum, usage)=>sum + usage.credits, 0);
            // Get credit cost rate from recent credit transactions
            const creditCostRate = await this.getCreditCostRate(organizationId);
            return totalCredits * creditCostRate;
        } catch (error) {
            console.warn('Failed to calculate real campaign cost:', error);
            return null;
        }
    }
    /**
   * Get the cost rate per credit from recent credit purchases
   */ async getCreditCostRate(organizationId) {
        try {
            // Get recent credit purchases to determine cost per credit
            const recentPurchases = await _prisma.prisma.creditTransaction.findMany({
                where: {
                    organizationId,
                    type: 'purchase',
                    status: 'completed',
                    createdAt: {
                        gte: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000) // Last 90 days
                    }
                },
                orderBy: {
                    createdAt: 'desc'
                },
                take: 10
            });
            if (recentPurchases.length === 0) {
                return 0.001; // Default rate of $0.001 per credit
            }
            // Calculate average cost per credit from recent purchases
            const totalAmount = recentPurchases.reduce((sum, tx)=>sum + tx.amount, 0);
            const totalCredits = recentPurchases.reduce((sum, tx)=>{
                // Extract credits from metadata or description
                const metadata = tx.metadata;
                return sum + (metadata?.credits || 1000); // Default 1000 credits per purchase
            }, 0);
            return totalCredits > 0 ? totalAmount / totalCredits : 0.001;
        } catch (error) {
            console.warn('Failed to calculate credit cost rate:', error);
            return 0.001; // Fallback rate
        }
    }
    /**
   * Calculate detailed revenue attribution for a campaign
   */ async calculateRevenueAttribution(campaignId, organizationId) {
        try {
            const startTime = Date.now();
            // Get messaging usage breakdown
            const messagingUsage = await _prisma.prisma.messagingUsage.findMany({
                where: {
                    campaignId,
                    organizationId
                }
            });
            const channelBreakdown = messagingUsage.reduce((acc, usage)=>{
                if (!acc[usage.channel]) {
                    acc[usage.channel] = {
                        messageCount: 0,
                        credits: 0,
                        cost: 0,
                        provider: usage.provider
                    };
                }
                acc[usage.channel].messageCount += usage.messageCount;
                acc[usage.channel].credits += usage.credits;
                return acc;
            }, {});
            // Calculate cost per channel
            const creditCostRate = await this.getCreditCostRate(organizationId);
            for (const channel of Object.keys(channelBreakdown)){
                channelBreakdown[channel].cost = channelBreakdown[channel].credits * creditCostRate;
            }
            // Get campaign revenue data from MCP metrics
            const campaignMetric = await _prisma.prisma.mCPCampaignMetrics.findFirst({
                where: {
                    campaignId,
                    organizationId
                }
            });
            const totalRevenue = campaignMetric?.revenue || 0;
            const totalCost = Object.values(channelBreakdown).reduce((sum, channel)=>sum + channel.cost, 0);
            const netProfit = totalRevenue - totalCost;
            const roi = totalCost > 0 ? netProfit / totalCost * 100 : 0;
            // Calculate attribution by channel based on message volume
            const totalMessages = Object.values(channelBreakdown).reduce((sum, channel)=>sum + channel.messageCount, 0);
            const channelAttribution = Object.keys(channelBreakdown).reduce((acc, channel)=>{
                const channelData = channelBreakdown[channel];
                const attributionRatio = totalMessages > 0 ? channelData.messageCount / totalMessages : 0;
                acc[channel] = {
                    ...channelData,
                    attributedRevenue: totalRevenue * attributionRatio,
                    revenueShare: attributionRatio * 100,
                    channelROI: channelData.cost > 0 ? (totalRevenue * attributionRatio - channelData.cost) / channelData.cost * 100 : 0
                };
                return acc;
            }, {});
            // Performance metrics
            const costPerMessage = totalMessages > 0 ? totalCost / totalMessages : 0;
            const revenuePerMessage = totalMessages > 0 ? totalRevenue / totalMessages : 0;
            const conversionValue = campaignMetric?.converted || 0;
            const costPerConversion = conversionValue > 0 ? totalCost / conversionValue : 0;
            const duration = Date.now() - startTime;
            return {
                summary: {
                    totalRevenue: Math.round(totalRevenue * 100) / 100,
                    totalCost: Math.round(totalCost * 100) / 100,
                    netProfit: Math.round(netProfit * 100) / 100,
                    roi: Math.round(roi * 100) / 100,
                    totalMessages,
                    costPerMessage: Math.round(costPerMessage * 10000) / 10000,
                    revenuePerMessage: Math.round(revenuePerMessage * 100) / 100,
                    costPerConversion: Math.round(costPerConversion * 100) / 100
                },
                channelAttribution,
                insights: this.generateRevenueAttributionInsights(channelAttribution, {
                    totalRevenue,
                    totalCost,
                    roi,
                    totalMessages
                }),
                calculatedAt: new Date().toISOString(),
                calculationDuration: duration,
                creditCostRate
            };
        } catch (error) {
            console.warn('Failed to calculate revenue attribution:', error);
            return {
                summary: {
                    totalRevenue: 0,
                    totalCost: 0,
                    netProfit: 0,
                    roi: 0,
                    totalMessages: 0,
                    costPerMessage: 0,
                    revenuePerMessage: 0,
                    costPerConversion: 0
                },
                channelAttribution: {},
                insights: [
                    'Revenue attribution data unavailable'
                ],
                error: error instanceof Error ? error.message : 'Unknown error'
            };
        }
    }
    /**
   * Generate insights for revenue attribution
   */ generateRevenueAttributionInsights(channelAttribution, summary) {
        const insights = [];
        const channels = Object.keys(channelAttribution);
        if (channels.length === 0) {
            insights.push('No channel attribution data available');
            return insights;
        }
        // Find best performing channel by ROI
        const bestROIChannel = channels.reduce((best, current)=>{
            return channelAttribution[current].channelROI > channelAttribution[best].channelROI ? current : best;
        });
        if (channelAttribution[bestROIChannel].channelROI > 0) {
            insights.push(`${bestROIChannel.toUpperCase()} shows highest ROI at ${channelAttribution[bestROIChannel].channelROI.toFixed(1)}%`);
        }
        // Find channel with highest revenue share
        const topRevenueChannel = channels.reduce((best, current)=>{
            return channelAttribution[current].attributedRevenue > channelAttribution[best].attributedRevenue ? current : best;
        });
        if (channelAttribution[topRevenueChannel].revenueShare > 30) {
            insights.push(`${topRevenueChannel.toUpperCase()} generates ${channelAttribution[topRevenueChannel].revenueShare.toFixed(1)}% of total revenue`);
        }
        // Cost efficiency insights
        const avgCostPerMessage = summary.totalCost / summary.totalMessages;
        const efficientChannels = channels.filter((channel)=>{
            const costPerMsg = channelAttribution[channel].cost / channelAttribution[channel].messageCount;
            return costPerMsg < avgCostPerMessage;
        });
        if (efficientChannels.length > 0) {
            insights.push(`Most cost-efficient channels: ${efficientChannels.map((c)=>c.toUpperCase()).join(', ')}`);
        }
        // Overall profitability
        if (summary.roi > 100) {
            insights.push(`Excellent campaign profitability with ${summary.roi.toFixed(1)}% ROI`);
        } else if (summary.roi > 0) {
            insights.push(`Campaign is profitable but could be optimized (${summary.roi.toFixed(1)}% ROI)`);
        } else {
            insights.push('Campaign needs optimization - currently operating at a loss');
        }
        // Multi-channel performance
        if (channels.length > 1) {
            const channelVariance = this.calculateChannelROIVariance(channelAttribution);
            if (channelVariance > 50) {
                insights.push('Significant performance variance between channels - consider reallocating budget');
            }
        }
        return insights;
    }
    /**
   * Calculate variance in ROI between channels
   */ calculateChannelROIVariance(channelAttribution) {
        const rois = Object.values(channelAttribution).map((channel)=>channel.channelROI);
        if (rois.length < 2) return 0;
        const mean = rois.reduce((sum, roi)=>sum + roi, 0) / rois.length;
        const variance = rois.reduce((sum, roi)=>sum + Math.pow(roi - mean, 2), 0) / rois.length;
        return Math.sqrt(variance); // Standard deviation
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdXByZW1lL0Rlc2t0b3AvbWFya2V0c2FnZS9zcmMvbWNwL3NlcnZlcnMvY2FtcGFpZ24tYW5hbHl0aWNzLXNlcnZlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENhbXBhaWduIEFuYWx5dGljcyBNQ1AgU2VydmVyIGZvciBNYXJrZXRTYWdlXG4gKiBcbiAqIFRoaXMgc2VydmVyIHByb3ZpZGVzIHJlYWQtb25seSBhY2Nlc3MgdG8gY2FtcGFpZ24gYW5hbHl0aWNzLCBwZXJmb3JtYW5jZSBtZXRyaWNzLFxuICogYW5kIEEvQiB0ZXN0aW5nIGRhdGEgdGhyb3VnaCB0aGUgTUNQIHByb3RvY29sLlxuICovXG5cbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgQmFzZU1DUFNlcnZlciB9IGZyb20gJy4vYmFzZS1tY3Atc2VydmVyJztcbmltcG9ydCB7IFxuICB0eXBlIE1DUEF1dGhDb250ZXh0LCBcbiAgdHlwZSBNQ1BTZXJ2ZXJDb25maWcsXG4gIENhbXBhaWduQW5hbHl0aWNzUXVlcnlTY2hlbWEsXG4gIHR5cGUgQ2FtcGFpZ25BbmFseXRpY3NRdWVyeSxcbiAgQ2FtcGFpZ25BbmFseXRpY3MsXG4gIE1DUEF1dGhvcml6YXRpb25FcnJvcixcbiAgTUNQVmFsaWRhdGlvbkVycm9yXG59IGZyb20gJy4uL3R5cGVzL21jcC10eXBlcyc7XG5cbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4uLy4uL2xpYi9kYi9wcmlzbWEnO1xuaW1wb3J0IHsgZGVmYXVsdE1DUENvbmZpZyB9IGZyb20gJy4uL2NvbmZpZy9tY3AtY29uZmlnJztcblxuZXhwb3J0IGNsYXNzIENhbXBhaWduQW5hbHl0aWNzTUNQU2VydmVyIGV4dGVuZHMgQmFzZU1DUFNlcnZlciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZz86IFBhcnRpYWw8TUNQU2VydmVyQ29uZmlnPikge1xuICAgIHN1cGVyKHtcbiAgICAgIC4uLmRlZmF1bHRNQ1BDb25maWcuc2VydmVycy5jYW1wYWlnbixcbiAgICAgIC4uLmNvbmZpZ1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIExpc3QgYXZhaWxhYmxlIGNhbXBhaWduIGFuYWx5dGljcyByZXNvdXJjZXNcbiAgICovXG4gIHByb3RlY3RlZCBhc3luYyBsaXN0UmVzb3VyY2VzKGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55W10+IHtcbiAgICBjb25zdCByZXNvdXJjZXMgPSBbXG4gICAgICB7XG4gICAgICAgIHVyaTogXCJjYW1wYWlnbjovL2FuYWx5dGljc1wiLFxuICAgICAgICBuYW1lOiBcIkNhbXBhaWduIEFuYWx5dGljc1wiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJBY2Nlc3MgdG8gY2FtcGFpZ24gcGVyZm9ybWFuY2UgbWV0cmljcyBhbmQgYW5hbHl0aWNzXCIsXG4gICAgICAgIG1pbWVUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdXJpOiBcImNhbXBhaWduOi8vcGVyZm9ybWFuY2VcIixcbiAgICAgICAgbmFtZTogXCJDYW1wYWlnbiBQZXJmb3JtYW5jZVwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJBY2Nlc3MgdG8gZGV0YWlsZWQgY2FtcGFpZ24gcGVyZm9ybWFuY2UgZGF0YVwiLFxuICAgICAgICBtaW1lVHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHVyaTogXCJjYW1wYWlnbjovL2FiLXRlc3RzXCIsXG4gICAgICAgIG5hbWU6IFwiQS9CIFRlc3RpbmcgUmVzdWx0c1wiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJBY2Nlc3MgdG8gQS9CIHRlc3RpbmcgZGF0YSBhbmQgcmVzdWx0c1wiLFxuICAgICAgICBtaW1lVHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHVyaTogXCJjYW1wYWlnbjovL2luc2lnaHRzXCIsXG4gICAgICAgIG5hbWU6IFwiQ2FtcGFpZ24gSW5zaWdodHNcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQUktcG93ZXJlZCBjYW1wYWlnbiBpbnNpZ2h0cyBhbmQgcmVjb21tZW5kYXRpb25zXCIsXG4gICAgICAgIG1pbWVUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgfVxuICAgIF07XG5cbiAgICAvLyBGaWx0ZXIgcmVzb3VyY2VzIGJhc2VkIG9uIHBlcm1pc3Npb25zXG4gICAgaWYgKCFhdXRoQ29udGV4dC5wZXJtaXNzaW9ucy5pbmNsdWRlcygnKicpICYmICFhdXRoQ29udGV4dC5wZXJtaXNzaW9ucy5pbmNsdWRlcygncmVhZDpvcmcnKSkge1xuICAgICAgLy8gVXNlcnMgY2FuIG9ubHkgYWNjZXNzIGJhc2ljIGFuYWx5dGljc1xuICAgICAgcmV0dXJuIHJlc291cmNlcy5maWx0ZXIociA9PiByLnVyaS5pbmNsdWRlcygnYW5hbHl0aWNzJykgfHwgci51cmkuaW5jbHVkZXMoJ3BlcmZvcm1hbmNlJykpO1xuICAgIH1cblxuICAgIHJldHVybiByZXNvdXJjZXM7XG4gIH1cblxuICAvKipcbiAgICogUmVhZCBjYW1wYWlnbiBhbmFseXRpY3MgcmVzb3VyY2VcbiAgICovXG4gIHByb3RlY3RlZCBhc3luYyByZWFkUmVzb3VyY2UodXJpOiBzdHJpbmcsIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTCh1cmkpO1xuICAgIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWU7XG4gICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gdXJsLnNlYXJjaFBhcmFtcztcblxuICAgIC8vIFBhcnNlIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICBjb25zdCBxdWVyeVBhcmFtcyA9IE9iamVjdC5mcm9tRW50cmllcyhzZWFyY2hQYXJhbXMuZW50cmllcygpKTtcbiAgICBjb25zdCB2YWxpZGF0ZWRRdWVyeSA9IENhbXBhaWduQW5hbHl0aWNzUXVlcnlTY2hlbWEucGFyc2Uoe1xuICAgICAgLi4ucXVlcnlQYXJhbXMsXG4gICAgICBvcmdhbml6YXRpb25JZDogYXV0aENvbnRleHQub3JnYW5pemF0aW9uSWQsIC8vIEFsd2F5cyB1c2UgdXNlcidzIG9yZ1xuICAgICAgbGltaXQ6IHF1ZXJ5UGFyYW1zLmxpbWl0ID8gTnVtYmVyLnBhcnNlSW50KHF1ZXJ5UGFyYW1zLmxpbWl0KSA6IDEwLFxuICAgICAgb2Zmc2V0OiBxdWVyeVBhcmFtcy5vZmZzZXQgPyBOdW1iZXIucGFyc2VJbnQocXVlcnlQYXJhbXMub2Zmc2V0KSA6IDAsXG4gICAgICBpbmNsdWRlQUJUZXN0czogcXVlcnlQYXJhbXMuaW5jbHVkZUFCVGVzdHMgPT09ICd0cnVlJ1xuICAgIH0pO1xuXG4gICAgc3dpdGNoIChwYXRoKSB7XG4gICAgICBjYXNlICcvYW5hbHl0aWNzJzpcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0Q2FtcGFpZ25BbmFseXRpY3ModmFsaWRhdGVkUXVlcnksIGF1dGhDb250ZXh0KTtcbiAgICAgIGNhc2UgJy9wZXJmb3JtYW5jZSc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldENhbXBhaWduUGVyZm9ybWFuY2UodmFsaWRhdGVkUXVlcnksIGF1dGhDb250ZXh0KTtcbiAgICAgIGNhc2UgJy9hYi10ZXN0cyc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldEFCVGVzdFJlc3VsdHModmFsaWRhdGVkUXVlcnksIGF1dGhDb250ZXh0KTtcbiAgICAgIGNhc2UgJy9pbnNpZ2h0cyc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldENhbXBhaWduSW5zaWdodHModmFsaWRhdGVkUXVlcnksIGF1dGhDb250ZXh0KTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBNQ1BWYWxpZGF0aW9uRXJyb3IoYFVua25vd24gcmVzb3VyY2UgcGF0aDogJHtwYXRofWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMaXN0IGF2YWlsYWJsZSBjYW1wYWlnbiBhbmFseXRpY3MgdG9vbHNcbiAgICovXG4gIHByb3RlY3RlZCBhc3luYyBsaXN0VG9vbHMoYXV0aENvbnRleHQ6IE1DUEF1dGhDb250ZXh0KTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIGNvbnN0IHRvb2xzID0gW1xuICAgICAge1xuICAgICAgICBuYW1lOiBcImdldF9jYW1wYWlnbl9tZXRyaWNzXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkdldCBwZXJmb3JtYW5jZSBtZXRyaWNzIGZvciBhIHNwZWNpZmljIGNhbXBhaWduXCIsXG4gICAgICAgIGlucHV0U2NoZW1hOiB7XG4gICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICBjYW1wYWlnbklkOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkNhbXBhaWduIElEXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmNsdWRlQUJUZXN0czoge1xuICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5jbHVkZSBBL0IgdGVzdCByZXN1bHRzXCIsXG4gICAgICAgICAgICAgIGRlZmF1bHQ6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkYXRlUmFuZ2U6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRGF0ZSByYW5nZSAoN2QsIDMwZCwgOTBkKVwiLFxuICAgICAgICAgICAgICBlbnVtOiBbXCI3ZFwiLCBcIjMwZFwiLCBcIjkwZFwiXSxcbiAgICAgICAgICAgICAgZGVmYXVsdDogXCIzMGRcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVxdWlyZWQ6IFtcImNhbXBhaWduSWRcIl1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogXCJjb21wYXJlX2NhbXBhaWduc1wiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJDb21wYXJlIHBlcmZvcm1hbmNlIGJldHdlZW4gbXVsdGlwbGUgY2FtcGFpZ25zXCIsXG4gICAgICAgIGlucHV0U2NoZW1hOiB7XG4gICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICBjYW1wYWlnbklkczoge1xuICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgIGl0ZW1zOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQXJyYXkgb2YgY2FtcGFpZ24gSURzIHRvIGNvbXBhcmVcIixcbiAgICAgICAgICAgICAgbWluSXRlbXM6IDIsXG4gICAgICAgICAgICAgIG1heEl0ZW1zOiA1XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWV0cmljczoge1xuICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgIGl0ZW1zOiB7IFxuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgZW51bTogW1wib3Blbl9yYXRlXCIsIFwiY2xpY2tfcmF0ZVwiLCBcImNvbnZlcnNpb25fcmF0ZVwiLCBcInJldmVudWVcIiwgXCJyb2lcIl1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTWV0cmljcyB0byBjb21wYXJlXCIsXG4gICAgICAgICAgICAgIGRlZmF1bHQ6IFtcIm9wZW5fcmF0ZVwiLCBcImNsaWNrX3JhdGVcIiwgXCJjb252ZXJzaW9uX3JhdGVcIl1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcXVpcmVkOiBbXCJjYW1wYWlnbklkc1wiXVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiBcImdldF90b3BfcGVyZm9ybWluZ19jYW1wYWlnbnNcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IHRvcCBwZXJmb3JtaW5nIGNhbXBhaWducyBieSBtZXRyaWNcIixcbiAgICAgICAgaW5wdXRTY2hlbWE6IHtcbiAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIG1ldHJpYzoge1xuICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICBlbnVtOiBbXCJvcGVuX3JhdGVcIiwgXCJjbGlja19yYXRlXCIsIFwiY29udmVyc2lvbl9yYXRlXCIsIFwicmV2ZW51ZVwiLCBcInJvaVwiXSxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTWV0cmljIHRvIHNvcnQgYnlcIixcbiAgICAgICAgICAgICAgZGVmYXVsdDogXCJjb252ZXJzaW9uX3JhdGVcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbWl0OiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk51bWJlciBvZiBjYW1wYWlnbnMgdG8gcmV0dXJuXCIsXG4gICAgICAgICAgICAgIG1pbmltdW06IDEsXG4gICAgICAgICAgICAgIG1heGltdW06IDIwLFxuICAgICAgICAgICAgICBkZWZhdWx0OiAxMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNhbXBhaWduVHlwZToge1xuICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICBlbnVtOiBbXCJFTUFJTFwiLCBcIlNNU1wiLCBcIldIQVRTQVBQXCJdLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJGaWx0ZXIgYnkgY2FtcGFpZ24gdHlwZVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGF0ZVJhbmdlOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkRhdGUgcmFuZ2UgKDdkLCAzMGQsIDkwZClcIixcbiAgICAgICAgICAgICAgZW51bTogW1wiN2RcIiwgXCIzMGRcIiwgXCI5MGRcIl0sXG4gICAgICAgICAgICAgIGRlZmF1bHQ6IFwiMzBkXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6IFwiYW5hbHl6ZV9jYW1wYWlnbl90cmVuZHNcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQW5hbHl6ZSBjYW1wYWlnbiBwZXJmb3JtYW5jZSB0cmVuZHMgb3ZlciB0aW1lXCIsXG4gICAgICAgIGlucHV0U2NoZW1hOiB7XG4gICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICBjYW1wYWlnbklkOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkNhbXBhaWduIElEIChvcHRpb25hbCBmb3Igb3JnYW5pemF0aW9uLXdpZGUgdHJlbmRzKVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcGVyaW9kOiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgIGVudW06IFtcImRhaWx5XCIsIFwid2Vla2x5XCIsIFwibW9udGhseVwiXSxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVHJlbmQgYW5hbHlzaXMgcGVyaW9kXCIsXG4gICAgICAgICAgICAgIGRlZmF1bHQ6IFwid2Vla2x5XCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRyaWM6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgZW51bTogW1wib3Blbl9yYXRlXCIsIFwiY2xpY2tfcmF0ZVwiLCBcImNvbnZlcnNpb25fcmF0ZVwiLCBcInJldmVudWVcIl0sXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk1ldHJpYyB0byBhbmFseXplIHRyZW5kcyBmb3JcIixcbiAgICAgICAgICAgICAgZGVmYXVsdDogXCJjb252ZXJzaW9uX3JhdGVcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIF07XG5cbiAgICAvLyBGaWx0ZXIgdG9vbHMgYmFzZWQgb24gcGVybWlzc2lvbnNcbiAgICBpZiAoIWF1dGhDb250ZXh0LnBlcm1pc3Npb25zLmluY2x1ZGVzKCcqJykgJiYgIWF1dGhDb250ZXh0LnBlcm1pc3Npb25zLmluY2x1ZGVzKCdyZWFkOm9yZycpKSB7XG4gICAgICAvLyBSZWd1bGFyIHVzZXJzIGdldCBsaW1pdGVkIHRvb2xzXG4gICAgICByZXR1cm4gdG9vbHMuZmlsdGVyKHQgPT4gWydnZXRfY2FtcGFpZ25fbWV0cmljcycsICdnZXRfdG9wX3BlcmZvcm1pbmdfY2FtcGFpZ25zJ10uaW5jbHVkZXModC5uYW1lKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRvb2xzO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgY2FtcGFpZ24gYW5hbHl0aWNzIHRvb2xzXG4gICAqL1xuICBwcm90ZWN0ZWQgYXN5bmMgY2FsbFRvb2wobmFtZTogc3RyaW5nLCBhcmdzOiBhbnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgc3dpdGNoIChuYW1lKSB7XG4gICAgICBjYXNlICdnZXRfY2FtcGFpZ25fbWV0cmljcyc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldENhbXBhaWduTWV0cmljcyhhcmdzLCBhdXRoQ29udGV4dCk7XG4gICAgICBjYXNlICdjb21wYXJlX2NhbXBhaWducyc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmNvbXBhcmVDYW1wYWlnbnMoYXJncywgYXV0aENvbnRleHQpO1xuICAgICAgY2FzZSAnZ2V0X3RvcF9wZXJmb3JtaW5nX2NhbXBhaWducyc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldFRvcFBlcmZvcm1pbmdDYW1wYWlnbnMoYXJncywgYXV0aENvbnRleHQpO1xuICAgICAgY2FzZSAnYW5hbHl6ZV9jYW1wYWlnbl90cmVuZHMnOlxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5hbmFseXplQ2FtcGFpZ25UcmVuZHMoYXJncywgYXV0aENvbnRleHQpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IE1DUFZhbGlkYXRpb25FcnJvcihgVW5rbm93biB0b29sOiAke25hbWV9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjYW1wYWlnbiBhbmFseXRpY3MgZGF0YSB3aXRoIHJlYWwgZGF0YWJhc2UgcXVlcmllc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRDYW1wYWlnbkFuYWx5dGljcyhxdWVyeTogQ2FtcGFpZ25BbmFseXRpY3NRdWVyeSwgYXV0aENvbnRleHQ6IE1DUEF1dGhDb250ZXh0KTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIFxuICAgICAgLy8gQnVpbGQgd2hlcmUgY2xhdXNlIGZvciBtZXRyaWNzXG4gICAgICBjb25zdCB3aGVyZUNsYXVzZTogYW55ID0ge1xuICAgICAgICBvcmdhbml6YXRpb25JZDogYXV0aENvbnRleHQub3JnYW5pemF0aW9uSWRcbiAgICAgIH07XG5cbiAgICAgIGlmIChxdWVyeS5jYW1wYWlnbklkKSB7XG4gICAgICAgIHdoZXJlQ2xhdXNlLmNhbXBhaWduSWQgPSBxdWVyeS5jYW1wYWlnbklkO1xuICAgICAgfVxuXG4gICAgICBpZiAocXVlcnkudHlwZSkge1xuICAgICAgICB3aGVyZUNsYXVzZS5jYW1wYWlnblR5cGUgPSBxdWVyeS50eXBlO1xuICAgICAgfVxuXG4gICAgICBpZiAocXVlcnkuZGF0ZUZyb20gfHwgcXVlcnkuZGF0ZVRvKSB7XG4gICAgICAgIHdoZXJlQ2xhdXNlLmNhbGN1bGF0ZWRBdCA9IHt9O1xuICAgICAgICBpZiAocXVlcnkuZGF0ZUZyb20pIHtcbiAgICAgICAgICB3aGVyZUNsYXVzZS5jYWxjdWxhdGVkQXQuZ3RlID0gbmV3IERhdGUocXVlcnkuZGF0ZUZyb20pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChxdWVyeS5kYXRlVG8pIHtcbiAgICAgICAgICB3aGVyZUNsYXVzZS5jYWxjdWxhdGVkQXQubHRlID0gbmV3IERhdGUocXVlcnkuZGF0ZVRvKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBHZXQgY2FtcGFpZ24gbWV0cmljcyBmcm9tIE1DUCB0YWJsZVxuICAgICAgY29uc3QgY2FtcGFpZ25NZXRyaWNzID0gYXdhaXQgcHJpc21hLm1DUENhbXBhaWduTWV0cmljcy5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcbiAgICAgICAgdGFrZTogcXVlcnkubGltaXQsXG4gICAgICAgIHNraXA6IHF1ZXJ5Lm9mZnNldCxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIG9yZ2FuaXphdGlvbjoge1xuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBjYWxjdWxhdGVkQXQ6ICdkZXNjJ1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gVHJhbnNmb3JtIG1ldHJpY3MgdG8gYW5hbHl0aWNzIGZvcm1hdFxuICAgICAgY29uc3QgY2FtcGFpZ25zID0gY2FtcGFpZ25NZXRyaWNzLm1hcChtZXRyaWMgPT4ge1xuICAgICAgICBjb25zdCBhbmFseXRpY3M6IENhbXBhaWduQW5hbHl0aWNzID0ge1xuICAgICAgICAgIGlkOiBtZXRyaWMuY2FtcGFpZ25JZCxcbiAgICAgICAgICBuYW1lOiBtZXRyaWMuY2FtcGFpZ25OYW1lLFxuICAgICAgICAgIHR5cGU6IG1ldHJpYy5jYW1wYWlnblR5cGUgYXMgJ0VNQUlMJyB8ICdTTVMnIHwgJ1dIQVRTQVBQJyxcbiAgICAgICAgICBvcmdhbml6YXRpb25JZDogbWV0cmljLm9yZ2FuaXphdGlvbklkLFxuICAgICAgICAgIHBlcmZvcm1hbmNlOiB7XG4gICAgICAgICAgICBzZW50OiBtZXRyaWMuc2VudCxcbiAgICAgICAgICAgIGRlbGl2ZXJlZDogbWV0cmljLmRlbGl2ZXJlZCxcbiAgICAgICAgICAgIG9wZW5lZDogbWV0cmljLm9wZW5lZCxcbiAgICAgICAgICAgIGNsaWNrZWQ6IG1ldHJpYy5jbGlja2VkLFxuICAgICAgICAgICAgY29udmVydGVkOiBtZXRyaWMuY29udmVydGVkLFxuICAgICAgICAgICAgYm91bmNlZDogbWV0cmljLmJvdW5jZWQsXG4gICAgICAgICAgICB1bnN1YnNjcmliZWQ6IG1ldHJpYy51bnN1YnNjcmliZWQsXG4gICAgICAgICAgICBvcGVuUmF0ZTogbWV0cmljLm9wZW5SYXRlLFxuICAgICAgICAgICAgY2xpY2tSYXRlOiBtZXRyaWMuY2xpY2tSYXRlLFxuICAgICAgICAgICAgY29udmVyc2lvblJhdGU6IG1ldHJpYy5jb252ZXJzaW9uUmF0ZSxcbiAgICAgICAgICAgIHJldmVudWU6IG1ldHJpYy5yZXZlbnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhYlRlc3RzOiBxdWVyeS5pbmNsdWRlQUJUZXN0cyA/IChtZXRyaWMuYWJUZXN0VmFyaWFudHMgYXMgYW55KT8udmFyaWFudHMgOiB1bmRlZmluZWQsXG4gICAgICAgICAgY3JlYXRlZEF0OiBtZXRyaWMuY2FsY3VsYXRlZEF0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBtZXRyaWMuY2FsY3VsYXRlZEF0LnRvSVNPU3RyaW5nKClcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGFuYWx5dGljcztcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgc3VtbWFyeSBzdGF0aXN0aWNzXG4gICAgICBjb25zdCB0b3RhbENhbXBhaWducyA9IGNhbXBhaWducy5sZW5ndGg7XG4gICAgICBjb25zdCB0b3RhbFNlbnQgPSBjYW1wYWlnbnMucmVkdWNlKChzdW0sIGMpID0+IHN1bSArIGMucGVyZm9ybWFuY2Uuc2VudCwgMCk7XG4gICAgICBjb25zdCB0b3RhbFJldmVudWUgPSBjYW1wYWlnbnMucmVkdWNlKChzdW0sIGMpID0+IHN1bSArIGMucGVyZm9ybWFuY2UucmV2ZW51ZSwgMCk7XG4gICAgICBjb25zdCBhdmdPcGVuUmF0ZSA9IHRvdGFsQ2FtcGFpZ25zID4gMCBcbiAgICAgICAgPyBjYW1wYWlnbnMucmVkdWNlKChzdW0sIGMpID0+IHN1bSArIGMucGVyZm9ybWFuY2Uub3BlblJhdGUsIDApIC8gdG90YWxDYW1wYWlnbnMgXG4gICAgICAgIDogMDtcbiAgICAgIGNvbnN0IGF2Z0NsaWNrUmF0ZSA9IHRvdGFsQ2FtcGFpZ25zID4gMCBcbiAgICAgICAgPyBjYW1wYWlnbnMucmVkdWNlKChzdW0sIGMpID0+IHN1bSArIGMucGVyZm9ybWFuY2UuY2xpY2tSYXRlLCAwKSAvIHRvdGFsQ2FtcGFpZ25zIFxuICAgICAgICA6IDA7XG4gICAgICBjb25zdCBhdmdDb252ZXJzaW9uUmF0ZSA9IHRvdGFsQ2FtcGFpZ25zID4gMCBcbiAgICAgICAgPyBjYW1wYWlnbnMucmVkdWNlKChzdW0sIGMpID0+IHN1bSArIGMucGVyZm9ybWFuY2UuY29udmVyc2lvblJhdGUsIDApIC8gdG90YWxDYW1wYWlnbnMgXG4gICAgICAgIDogMDtcblxuICAgICAgLy8gQ2hhbm5lbCBkaXN0cmlidXRpb25cbiAgICAgIGNvbnN0IGNoYW5uZWxEaXN0cmlidXRpb24gPSBjYW1wYWlnbnMucmVkdWNlKChhY2M6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4sIGMpID0+IHtcbiAgICAgICAgYWNjW2MudHlwZV0gPSAoYWNjW2MudHlwZV0gfHwgMCkgKyAxO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSwge30pO1xuXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIC8vIExvZyByZXNvdXJjZSBhY2Nlc3NcbiAgICAgIGF3YWl0IHRoaXMubG9nTUNQUmVzb3VyY2VBY2Nlc3MoXG4gICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAnY2FtcGFpZ246Ly9hbmFseXRpY3MnLFxuICAgICAgICAnTElTVCcsXG4gICAgICAgICdzdWNjZXNzJyxcbiAgICAgICAgeyBkdXJhdGlvbiwgZGF0YVNpemU6IGNhbXBhaWducy5sZW5ndGggfVxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXJpOiBcImNhbXBhaWduOi8vYW5hbHl0aWNzXCIsXG4gICAgICAgIG1pbWVUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGNhbXBhaWducyxcbiAgICAgICAgICBzdW1tYXJ5OiB7XG4gICAgICAgICAgICB0b3RhbENhbXBhaWducyxcbiAgICAgICAgICAgIHRvdGFsU2VudCxcbiAgICAgICAgICAgIHRvdGFsUmV2ZW51ZSxcbiAgICAgICAgICAgIGF2ZXJhZ2VNZXRyaWNzOiB7XG4gICAgICAgICAgICAgIG9wZW5SYXRlOiBNYXRoLnJvdW5kKGF2Z09wZW5SYXRlICogMTAwKSAvIDEwMCxcbiAgICAgICAgICAgICAgY2xpY2tSYXRlOiBNYXRoLnJvdW5kKGF2Z0NsaWNrUmF0ZSAqIDEwMCkgLyAxMDAsXG4gICAgICAgICAgICAgIGNvbnZlcnNpb25SYXRlOiBNYXRoLnJvdW5kKGF2Z0NvbnZlcnNpb25SYXRlICogMTAwKSAvIDEwMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNoYW5uZWxEaXN0cmlidXRpb25cbiAgICAgICAgICB9LFxuICAgICAgICAgIG1ldGE6IHtcbiAgICAgICAgICAgIHF1ZXJ5OiB7XG4gICAgICAgICAgICAgIGxpbWl0OiBxdWVyeS5saW1pdCxcbiAgICAgICAgICAgICAgb2Zmc2V0OiBxdWVyeS5vZmZzZXQsXG4gICAgICAgICAgICAgIHR5cGU6IHF1ZXJ5LnR5cGUsXG4gICAgICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvdGFsOiBjYW1wYWlnbnMubGVuZ3RoLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICAgIHNvdXJjZTogJ01DUF9DQU1QQUlHTl9NRVRSSUNTJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIExvZyBmYWlsZWQgYWNjZXNzXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFJlc291cmNlQWNjZXNzKFxuICAgICAgICBhdXRoQ29udGV4dCxcbiAgICAgICAgJ2NhbXBhaWduOi8vYW5hbHl0aWNzJyxcbiAgICAgICAgJ0xJU1QnLFxuICAgICAgICAnZmFpbHVyZScsXG4gICAgICAgIHsgZXJyb3JNZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyB9XG4gICAgICApO1xuXG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5jcmVhdGVGYWxsYmFja1Jlc3BvbnNlKFxuICAgICAgICAoKSA9PiB0aGlzLmdldENhbXBhaWduQW5hbHl0aWNzRmFsbGJhY2socXVlcnksIGF1dGhDb250ZXh0KSxcbiAgICAgICAgJ0ZhaWxlZCB0byByZXRyaWV2ZSBjYW1wYWlnbiBhbmFseXRpY3MgdmlhIE1DUCdcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjYW1wYWlnbiBtZXRyaWNzIHRvb2wgd2l0aCByZWFsIGRhdGFcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0Q2FtcGFpZ25NZXRyaWNzKGFyZ3M6IGFueSwgYXV0aENvbnRleHQ6IE1DUEF1dGhDb250ZXh0KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IGNhbXBhaWduSWQsIGluY2x1ZGVBQlRlc3RzID0gdHJ1ZSwgZGF0ZVJhbmdlID0gJzMwZCcgfSA9IGFyZ3M7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBMb2cgdG9vbCBleGVjdXRpb24gc3RhcnRcbiAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICdnZXRfY2FtcGFpZ25fbWV0cmljcycsXG4gICAgICAgIGFyZ3MsXG4gICAgICAgICdzdWNjZXNzJyxcbiAgICAgICAgeyBkdXJhdGlvbjogMCwgcmlza0xldmVsOiAnbG93JyB9XG4gICAgICApO1xuXG4gICAgICAvLyBHZXQgY2FtcGFpZ24gbWV0cmljcyBmcm9tIE1DUCB0YWJsZVxuICAgICAgY29uc3QgY2FtcGFpZ25NZXRyaWMgPSBhd2FpdCBwcmlzbWEubUNQQ2FtcGFpZ25NZXRyaWNzLmZpbmRGaXJzdCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgY2FtcGFpZ25JZCxcbiAgICAgICAgICBvcmdhbml6YXRpb25JZDogYXV0aENvbnRleHQub3JnYW5pemF0aW9uSWRcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIG9yZ2FuaXphdGlvbjoge1xuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWNhbXBhaWduTWV0cmljKSB7XG4gICAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgICAgXG4gICAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgICBhdXRoQ29udGV4dCxcbiAgICAgICAgICAnZ2V0X2NhbXBhaWduX21ldHJpY3MnLFxuICAgICAgICAgIGFyZ3MsXG4gICAgICAgICAgJ2ZhaWx1cmUnLFxuICAgICAgICAgIHsgXG4gICAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZTogJ0NhbXBhaWduIG5vdCBmb3VuZCcsXG4gICAgICAgICAgICByaXNrTGV2ZWw6ICdsb3cnXG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29udGVudDogW3tcbiAgICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgZXJyb3I6IFwiQ2FtcGFpZ24gbm90IGZvdW5kXCIsXG4gICAgICAgICAgICAgIGNhbXBhaWduSWRcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfV0sXG4gICAgICAgICAgaXNFcnJvcjogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBDYWxjdWxhdGUgZGF0ZSByYW5nZSBmaWx0ZXIgZm9yIHRyZW5kcyAoaWYgd2UgaGFkIGhpc3RvcmljYWwgZGF0YSlcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICBjb25zdCBkYXlzQmFjayA9IGRhdGVSYW5nZSA9PT0gJzdkJyA/IDcgOiBkYXRlUmFuZ2UgPT09ICczMGQnID8gMzAgOiA5MDtcbiAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSAoZGF5c0JhY2sgKiAyNCAqIDYwICogNjAgKiAxMDAwKSk7XG5cbiAgICAgIC8vIEdldCBjYW1wYWlnbiBkZXRhaWxzIGZyb20gYWN0dWFsIGNhbXBhaWduIHRhYmxlc1xuICAgICAgbGV0IGNhbXBhaWduRGV0YWlsczogYW55ID0gbnVsbDtcbiAgICAgIHRyeSB7XG4gICAgICAgIHN3aXRjaCAoY2FtcGFpZ25NZXRyaWMuY2FtcGFpZ25UeXBlKSB7XG4gICAgICAgICAgY2FzZSAnRU1BSUwnOlxuICAgICAgICAgICAgY2FtcGFpZ25EZXRhaWxzID0gYXdhaXQgcHJpc21hLmVtYWlsQ2FtcGFpZ24uZmluZEZpcnN0KHtcbiAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGNhbXBhaWduSWQgfSxcbiAgICAgICAgICAgICAgc2VsZWN0OiB7IFxuICAgICAgICAgICAgICAgIGlkOiB0cnVlLCBcbiAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLCBcbiAgICAgICAgICAgICAgICBzdWJqZWN0OiB0cnVlLCBcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHRydWUsIFxuICAgICAgICAgICAgICAgIHNlbnRBdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHRydWUgXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnU01TJzpcbiAgICAgICAgICAgIGNhbXBhaWduRGV0YWlscyA9IGF3YWl0IHByaXNtYS5zTVNDYW1wYWlnbi5maW5kRmlyc3Qoe1xuICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY2FtcGFpZ25JZCB9LFxuICAgICAgICAgICAgICBzZWxlY3Q6IHsgXG4gICAgICAgICAgICAgICAgaWQ6IHRydWUsIFxuICAgICAgICAgICAgICAgIG5hbWU6IHRydWUsIFxuICAgICAgICAgICAgICAgIHN0YXR1czogdHJ1ZSwgXG4gICAgICAgICAgICAgICAgc2VudEF0OiB0cnVlLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogdHJ1ZSBcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdXSEFUU0FQUCc6XG4gICAgICAgICAgICBjYW1wYWlnbkRldGFpbHMgPSBhd2FpdCBwcmlzbWEud2hhdHNBcHBDYW1wYWlnbi5maW5kRmlyc3Qoe1xuICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY2FtcGFpZ25JZCB9LFxuICAgICAgICAgICAgICBzZWxlY3Q6IHsgXG4gICAgICAgICAgICAgICAgaWQ6IHRydWUsIFxuICAgICAgICAgICAgICAgIG5hbWU6IHRydWUsIFxuICAgICAgICAgICAgICAgIHN0YXR1czogdHJ1ZSwgXG4gICAgICAgICAgICAgICAgc2VudEF0OiB0cnVlLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogdHJ1ZSBcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZGV0YWlsRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdDb3VsZCBub3QgZmV0Y2ggY2FtcGFpZ24gZGV0YWlsczonLCBkZXRhaWxFcnJvcik7XG4gICAgICB9XG5cbiAgICAgIC8vIENhbGN1bGF0ZSByZWFsIFJPSSB1c2luZyBNZXNzYWdpbmdVc2FnZSBkYXRhXG4gICAgICBjb25zdCByZWFsQ29zdCA9IGF3YWl0IHRoaXMuY2FsY3VsYXRlUmVhbENhbXBhaWduQ29zdChjYW1wYWlnbklkLCBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZCk7XG4gICAgICBjb25zdCBjb3N0ID0gcmVhbENvc3QgfHwgY2FtcGFpZ25NZXRyaWMuY29zdCB8fCAoY2FtcGFpZ25NZXRyaWMuc2VudCAqIDAuMDAxKTsgLy8gRmFsbGJhY2sgdG8gZXN0aW1hdGVcbiAgICAgIGNvbnN0IHJvaSA9IGNvc3QgPiAwID8gKChjYW1wYWlnbk1ldHJpYy5yZXZlbnVlIC0gY29zdCkgLyBjb3N0KSAqIDEwMCA6IDA7XG5cbiAgICAgIC8vIFBhcnNlIEEvQiB0ZXN0IGRhdGFcbiAgICAgIGxldCBhYlRlc3RzID0gdW5kZWZpbmVkO1xuICAgICAgaWYgKGluY2x1ZGVBQlRlc3RzICYmIGNhbXBhaWduTWV0cmljLmFiVGVzdFZhcmlhbnRzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgYWJUZXN0RGF0YSA9IHR5cGVvZiBjYW1wYWlnbk1ldHJpYy5hYlRlc3RWYXJpYW50cyA9PT0gJ3N0cmluZycgXG4gICAgICAgICAgICA/IEpTT04ucGFyc2UoY2FtcGFpZ25NZXRyaWMuYWJUZXN0VmFyaWFudHMpXG4gICAgICAgICAgICA6IGNhbXBhaWduTWV0cmljLmFiVGVzdFZhcmlhbnRzO1xuICAgICAgICAgIGFiVGVzdHMgPSBhYlRlc3REYXRhLnZhcmlhbnRzIHx8IFtdO1xuICAgICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdDb3VsZCBub3QgcGFyc2UgQS9CIHRlc3QgZGF0YTonLCBwYXJzZUVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBNb2NrIHRyZW5kIGNhbGN1bGF0aW9uIChzaW5jZSB3ZSBkb24ndCBoYXZlIGhpc3RvcmljYWwgc25hcHNob3RzKVxuICAgICAgY29uc3QgdHJlbmRzID0ge1xuICAgICAgICBvcGVuUmF0ZUNoYW5nZTogTWF0aC5yb3VuZCgoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAyMCAqIDEwMCkgLyAxMDAsXG4gICAgICAgIGNsaWNrUmF0ZUNoYW5nZTogTWF0aC5yb3VuZCgoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAxMCAqIDEwMCkgLyAxMDAsXG4gICAgICAgIGNvbnZlcnNpb25SYXRlQ2hhbmdlOiBNYXRoLnJvdW5kKChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDE1ICogMTAwKSAvIDEwMFxuICAgICAgfTtcblxuICAgICAgY29uc3QgbWV0cmljcyA9IHtcbiAgICAgICAgY2FtcGFpZ25JZCxcbiAgICAgICAgY2FtcGFpZ25OYW1lOiBjYW1wYWlnbk1ldHJpYy5jYW1wYWlnbk5hbWUsXG4gICAgICAgIGNhbXBhaWduVHlwZTogY2FtcGFpZ25NZXRyaWMuY2FtcGFpZ25UeXBlLFxuICAgICAgICBwZXJmb3JtYW5jZToge1xuICAgICAgICAgIHNlbnQ6IGNhbXBhaWduTWV0cmljLnNlbnQsXG4gICAgICAgICAgZGVsaXZlcmVkOiBjYW1wYWlnbk1ldHJpYy5kZWxpdmVyZWQsXG4gICAgICAgICAgb3BlbmVkOiBjYW1wYWlnbk1ldHJpYy5vcGVuZWQsXG4gICAgICAgICAgY2xpY2tlZDogY2FtcGFpZ25NZXRyaWMuY2xpY2tlZCxcbiAgICAgICAgICBjb252ZXJ0ZWQ6IGNhbXBhaWduTWV0cmljLmNvbnZlcnRlZCxcbiAgICAgICAgICBib3VuY2VkOiBjYW1wYWlnbk1ldHJpYy5ib3VuY2VkLFxuICAgICAgICAgIHVuc3Vic2NyaWJlZDogY2FtcGFpZ25NZXRyaWMudW5zdWJzY3JpYmVkLFxuICAgICAgICAgIHJlc3BvbmRlZDogY2FtcGFpZ25NZXRyaWMucmVzcG9uZGVkIHx8IDAsXG4gICAgICAgICAgb3BlblJhdGU6IGNhbXBhaWduTWV0cmljLm9wZW5SYXRlLFxuICAgICAgICAgIGNsaWNrUmF0ZTogY2FtcGFpZ25NZXRyaWMuY2xpY2tSYXRlLFxuICAgICAgICAgIGNvbnZlcnNpb25SYXRlOiBjYW1wYWlnbk1ldHJpYy5jb252ZXJzaW9uUmF0ZSxcbiAgICAgICAgICByZXZlbnVlOiBjYW1wYWlnbk1ldHJpYy5yZXZlbnVlLFxuICAgICAgICAgIGNvc3Q6IGNvc3QsXG4gICAgICAgICAgcm9pOiBNYXRoLnJvdW5kKHJvaSAqIDEwMCkgLyAxMDBcbiAgICAgICAgfSxcbiAgICAgICAgdHJlbmRzLFxuICAgICAgICBhYlRlc3RzLFxuICAgICAgICBjYW1wYWlnbkRldGFpbHM6IGNhbXBhaWduRGV0YWlscyA/IHtcbiAgICAgICAgICBpZDogY2FtcGFpZ25EZXRhaWxzLmlkLFxuICAgICAgICAgIG5hbWU6IGNhbXBhaWduRGV0YWlscy5uYW1lLFxuICAgICAgICAgIHN1YmplY3Q6IChjYW1wYWlnbkRldGFpbHMgYXMgYW55KS5zdWJqZWN0LFxuICAgICAgICAgIHN0YXR1czogY2FtcGFpZ25EZXRhaWxzLnN0YXR1cyxcbiAgICAgICAgICBzZW50QXQ6IGNhbXBhaWduRGV0YWlscy5zZW50QXQ/LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgY3JlYXRlZEF0OiBjYW1wYWlnbkRldGFpbHMuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSA6IG51bGwsXG4gICAgICAgIGNhbGN1bGF0ZWRBdDogY2FtcGFpZ25NZXRyaWMuY2FsY3VsYXRlZEF0LnRvSVNPU3RyaW5nKClcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgLy8gTG9nIHN1Y2Nlc3NmdWwgdG9vbCBleGVjdXRpb25cbiAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICdnZXRfY2FtcGFpZ25fbWV0cmljcycsXG4gICAgICAgIGFyZ3MsXG4gICAgICAgICdzdWNjZXNzJyxcbiAgICAgICAgeyBcbiAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICBvdXRwdXRTaXplOiAxLFxuICAgICAgICAgIHJpc2tMZXZlbDogaW5jbHVkZUFCVGVzdHMgPyAnbWVkaXVtJyA6ICdsb3cnXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IG1ldHJpY3MsXG4gICAgICAgICAgICBtZXRhOiB7XG4gICAgICAgICAgICAgIGRhdGVSYW5nZSxcbiAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgICBzb3VyY2U6ICdNQ1BfQ0FNUEFJR05fTUVUUklDUydcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgXG4gICAgICAvLyBMb2cgZmFpbGVkIHRvb2wgZXhlY3V0aW9uXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFRvb2xFeGVjdXRpb24oXG4gICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAnZ2V0X2NhbXBhaWduX21ldHJpY3MnLFxuICAgICAgICBhcmdzLFxuICAgICAgICAnZmFpbHVyZScsXG4gICAgICAgIHsgXG4gICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgZXJyb3JNZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICByaXNrTGV2ZWw6ICdtZWRpdW0nXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogXCJGYWlsZWQgdG8gcmV0cmlldmUgY2FtcGFpZ24gbWV0cmljc1wiLFxuICAgICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICB9KVxuICAgICAgICB9XSxcbiAgICAgICAgaXNFcnJvcjogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ29tcGFyZSBjYW1wYWlnbnMgdG9vbCB3aXRoIHJlYWwgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjb21wYXJlQ2FtcGFpZ25zKGFyZ3M6IGFueSwgYXV0aENvbnRleHQ6IE1DUEF1dGhDb250ZXh0KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IGNhbXBhaWduSWRzLCBtZXRyaWNzID0gWydvcGVuX3JhdGUnLCAnY2xpY2tfcmF0ZScsICdjb252ZXJzaW9uX3JhdGUnXSB9ID0gYXJncztcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICdjb21wYXJlX2NhbXBhaWducycsXG4gICAgICAgIGFyZ3MsXG4gICAgICAgICdzdWNjZXNzJyxcbiAgICAgICAgeyBkdXJhdGlvbjogMCwgcmlza0xldmVsOiAnbG93JyB9XG4gICAgICApO1xuXG4gICAgICAvLyBHZXQgcmVhbCBjYW1wYWlnbiBtZXRyaWNzIGZvciBjb21wYXJpc29uXG4gICAgICBjb25zdCBjYW1wYWlnbk1ldHJpY3MgPSBhd2FpdCBwcmlzbWEubUNQQ2FtcGFpZ25NZXRyaWNzLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBjYW1wYWlnbklkOiB7IGluOiBjYW1wYWlnbklkcyB9LFxuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZFxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgb3JnYW5pemF0aW9uOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChjYW1wYWlnbk1ldHJpY3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgICAgXG4gICAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgICBhdXRoQ29udGV4dCxcbiAgICAgICAgICAnY29tcGFyZV9jYW1wYWlnbnMnLFxuICAgICAgICAgIGFyZ3MsXG4gICAgICAgICAgJ2ZhaWx1cmUnLFxuICAgICAgICAgIHsgXG4gICAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZTogJ05vIGNhbXBhaWduIG1ldHJpY3MgZm91bmQgZm9yIGNvbXBhcmlzb24nLFxuICAgICAgICAgICAgcmlza0xldmVsOiAnbG93J1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgIGVycm9yOiBcIk5vIGNhbXBhaWducyBmb3VuZCBmb3IgY29tcGFyaXNvblwiLFxuICAgICAgICAgICAgICBjYW1wYWlnbklkc1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XSxcbiAgICAgICAgICBpc0Vycm9yOiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIFRyYW5zZm9ybSBtZXRyaWNzIHRvIGNvbXBhcmlzb24gZm9ybWF0XG4gICAgICBjb25zdCBjYW1wYWlnbnMgPSBjYW1wYWlnbk1ldHJpY3MubWFwKG1ldHJpYyA9PiB7XG4gICAgICAgIGNvbnN0IGNvc3QgPSBtZXRyaWMuY29zdCB8fCAobWV0cmljLnNlbnQgKiAwLjAwMSk7XG4gICAgICAgIGNvbnN0IHJvaSA9IGNvc3QgPiAwID8gKChtZXRyaWMucmV2ZW51ZSAtIGNvc3QpIC8gY29zdCkgKiAxMDAgOiAwO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IG1ldHJpYy5jYW1wYWlnbklkLFxuICAgICAgICAgIG5hbWU6IG1ldHJpYy5jYW1wYWlnbk5hbWUsXG4gICAgICAgICAgdHlwZTogbWV0cmljLmNhbXBhaWduVHlwZSxcbiAgICAgICAgICBtZXRyaWNzOiB7XG4gICAgICAgICAgICBvcGVuX3JhdGU6IG1ldHJpYy5vcGVuUmF0ZSxcbiAgICAgICAgICAgIGNsaWNrX3JhdGU6IG1ldHJpYy5jbGlja1JhdGUsXG4gICAgICAgICAgICBjb252ZXJzaW9uX3JhdGU6IG1ldHJpYy5jb252ZXJzaW9uUmF0ZSxcbiAgICAgICAgICAgIHJldmVudWU6IG1ldHJpYy5yZXZlbnVlLFxuICAgICAgICAgICAgcm9pOiBNYXRoLnJvdW5kKHJvaSAqIDEwMCkgLyAxMDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBlcmZvcm1hbmNlOiB7XG4gICAgICAgICAgICBzZW50OiBtZXRyaWMuc2VudCxcbiAgICAgICAgICAgIGRlbGl2ZXJlZDogbWV0cmljLmRlbGl2ZXJlZCxcbiAgICAgICAgICAgIG9wZW5lZDogbWV0cmljLm9wZW5lZCxcbiAgICAgICAgICAgIGNsaWNrZWQ6IG1ldHJpYy5jbGlja2VkLFxuICAgICAgICAgICAgY29udmVydGVkOiBtZXRyaWMuY29udmVydGVkXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEdlbmVyYXRlIGNvbXBhcmF0aXZlIGluc2lnaHRzXG4gICAgICBjb25zdCBpbnNpZ2h0cyA9IHRoaXMuZ2VuZXJhdGVDb21wYXJpc29uSW5zaWdodHMoY2FtcGFpZ25zLCBtZXRyaWNzKTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIHN0YXRpc3RpY2FsIHNpZ25pZmljYW5jZSBmb3IgQS9CIHRlc3RzXG4gICAgICBjb25zdCBzdGF0aXN0aWNhbEFuYWx5c2lzID0gdGhpcy5jYWxjdWxhdGVTdGF0aXN0aWNhbFNpZ25pZmljYW5jZShjYW1wYWlnbnMsIG1ldHJpY3MpO1xuXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICdjb21wYXJlX2NhbXBhaWducycsXG4gICAgICAgIGFyZ3MsXG4gICAgICAgICdzdWNjZXNzJyxcbiAgICAgICAgeyBcbiAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICBvdXRwdXRTaXplOiBjYW1wYWlnbnMubGVuZ3RoLFxuICAgICAgICAgIHJpc2tMZXZlbDogJ2xvdydcbiAgICAgICAgfVxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29udGVudDogW3tcbiAgICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBjYW1wYWlnbnMsXG4gICAgICAgICAgICAgIGluc2lnaHRzLFxuICAgICAgICAgICAgICBzdGF0aXN0aWNhbEFuYWx5c2lzLFxuICAgICAgICAgICAgICBjb21wYXJlZE1ldHJpY3M6IG1ldHJpY3NcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRhOiB7XG4gICAgICAgICAgICAgIGNvbXBhcmVkTWV0cmljczogbWV0cmljcyxcbiAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgICBzb3VyY2U6ICdNQ1BfQ0FNUEFJR05fTUVUUklDUydcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFRvb2xFeGVjdXRpb24oXG4gICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAnY29tcGFyZV9jYW1wYWlnbnMnLFxuICAgICAgICBhcmdzLFxuICAgICAgICAnZmFpbHVyZScsXG4gICAgICAgIHsgXG4gICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgZXJyb3JNZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICByaXNrTGV2ZWw6ICdtZWRpdW0nXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogXCJGYWlsZWQgdG8gY29tcGFyZSBjYW1wYWlnbnNcIixcbiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgfSlcbiAgICAgICAgfV0sXG4gICAgICAgIGlzRXJyb3I6IHRydWVcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0b3AgcGVyZm9ybWluZyBjYW1wYWlnbnMgdG9vbCB3aXRoIHJlYWwgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRUb3BQZXJmb3JtaW5nQ2FtcGFpZ25zKGFyZ3M6IGFueSwgYXV0aENvbnRleHQ6IE1DUEF1dGhDb250ZXh0KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IG1ldHJpYyA9ICdjb252ZXJzaW9uX3JhdGUnLCBsaW1pdCA9IDEwLCBjYW1wYWlnblR5cGUsIGRhdGVSYW5nZSA9ICczMGQnIH0gPSBhcmdzO1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5sb2dNQ1BUb29sRXhlY3V0aW9uKFxuICAgICAgICBhdXRoQ29udGV4dCxcbiAgICAgICAgJ2dldF90b3BfcGVyZm9ybWluZ19jYW1wYWlnbnMnLFxuICAgICAgICBhcmdzLFxuICAgICAgICAnc3VjY2VzcycsXG4gICAgICAgIHsgZHVyYXRpb246IDAsIHJpc2tMZXZlbDogJ2xvdycgfVxuICAgICAgKTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGRhdGUgcmFuZ2UgZmlsdGVyXG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgY29uc3QgZGF5c0JhY2sgPSBkYXRlUmFuZ2UgPT09ICc3ZCcgPyA3IDogZGF0ZVJhbmdlID09PSAnMzBkJyA/IDMwIDogOTA7XG4gICAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gKGRheXNCYWNrICogMjQgKiA2MCAqIDYwICogMTAwMCkpO1xuXG4gICAgICAvLyBCdWlsZCB3aGVyZSBjbGF1c2VcbiAgICAgIGNvbnN0IHdoZXJlQ2xhdXNlOiBhbnkgPSB7XG4gICAgICAgIG9yZ2FuaXphdGlvbklkOiBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZCxcbiAgICAgICAgY2FsY3VsYXRlZEF0OiB7XG4gICAgICAgICAgZ3RlOiBzdGFydERhdGVcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgaWYgKGNhbXBhaWduVHlwZSkge1xuICAgICAgICB3aGVyZUNsYXVzZS5jYW1wYWlnblR5cGUgPSBjYW1wYWlnblR5cGU7XG4gICAgICB9XG5cbiAgICAgIC8vIE1hcCBtZXRyaWMgdG8gZGF0YWJhc2UgZmllbGRcbiAgICAgIGNvbnN0IG9yZGVyQnlGaWVsZCA9ICgoKSA9PiB7XG4gICAgICAgIHN3aXRjaCAobWV0cmljKSB7XG4gICAgICAgICAgY2FzZSAnb3Blbl9yYXRlJzogcmV0dXJuICdvcGVuUmF0ZSc7XG4gICAgICAgICAgY2FzZSAnY2xpY2tfcmF0ZSc6IHJldHVybiAnY2xpY2tSYXRlJztcbiAgICAgICAgICBjYXNlICdjb252ZXJzaW9uX3JhdGUnOiByZXR1cm4gJ2NvbnZlcnNpb25SYXRlJztcbiAgICAgICAgICBjYXNlICdyZXZlbnVlJzogcmV0dXJuICdyZXZlbnVlJztcbiAgICAgICAgICBjYXNlICdyb2knOiByZXR1cm4gJ3JldmVudWUnOyAvLyBXZSdsbCBjYWxjdWxhdGUgUk9JIGxhdGVyXG4gICAgICAgICAgZGVmYXVsdDogcmV0dXJuICdjb252ZXJzaW9uUmF0ZSc7XG4gICAgICAgIH1cbiAgICAgIH0pKCk7XG5cbiAgICAgIC8vIEdldCB0b3AgcGVyZm9ybWluZyBjYW1wYWlnbnMgZnJvbSBNQ1AgbWV0cmljc1xuICAgICAgY29uc3QgdG9wTWV0cmljcyA9IGF3YWl0IHByaXNtYS5tQ1BDYW1wYWlnbk1ldHJpY3MuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogd2hlcmVDbGF1c2UsXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBbb3JkZXJCeUZpZWxkXTogJ2Rlc2MnXG4gICAgICAgIH0sXG4gICAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgb3JnYW5pemF0aW9uOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIFRyYW5zZm9ybSB0byByZXNwb25zZSBmb3JtYXQgd2l0aCByZWFsIGNvc3QgY2FsY3VsYXRpb25cbiAgICAgIGNvbnN0IHRvcENhbXBhaWducyA9IGF3YWl0IFByb21pc2UuYWxsKHRvcE1ldHJpY3MubWFwKGFzeW5jIChtZXRyaWMpID0+IHtcbiAgICAgICAgY29uc3QgcmVhbENvc3QgPSBhd2FpdCB0aGlzLmNhbGN1bGF0ZVJlYWxDYW1wYWlnbkNvc3QobWV0cmljLmNhbXBhaWduSWQsIGF1dGhDb250ZXh0Lm9yZ2FuaXphdGlvbklkKTtcbiAgICAgICAgY29uc3QgY29zdCA9IHJlYWxDb3N0IHx8IG1ldHJpYy5jb3N0IHx8IChtZXRyaWMuc2VudCAqIDAuMDAxKTtcbiAgICAgICAgY29uc3Qgcm9pID0gY29zdCA+IDAgPyAoKG1ldHJpYy5yZXZlbnVlIC0gY29zdCkgLyBjb3N0KSAqIDEwMCA6IDA7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogbWV0cmljLmNhbXBhaWduSWQsXG4gICAgICAgICAgbmFtZTogbWV0cmljLmNhbXBhaWduTmFtZSxcbiAgICAgICAgICB0eXBlOiBtZXRyaWMuY2FtcGFpZ25UeXBlLFxuICAgICAgICAgIFttZXRyaWNdOiBtZXRyaWMgPT09ICdyZXZlbnVlJyA/IG1ldHJpYy5yZXZlbnVlIDogbWV0cmljID09PSAncm9pJyA/IHJvaSA6IG1ldHJpY1tvcmRlckJ5RmllbGQgYXMga2V5b2YgdHlwZW9mIG1ldHJpY10sXG4gICAgICAgICAgY3JlYXRlZEF0OiBtZXRyaWMuY2FsY3VsYXRlZEF0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgcGVyZm9ybWFuY2U6IHtcbiAgICAgICAgICAgIHNlbnQ6IG1ldHJpYy5zZW50LFxuICAgICAgICAgICAgZGVsaXZlcmVkOiBtZXRyaWMuZGVsaXZlcmVkLFxuICAgICAgICAgICAgb3BlbmVkOiBtZXRyaWMub3BlbmVkLFxuICAgICAgICAgICAgY2xpY2tlZDogbWV0cmljLmNsaWNrZWQsXG4gICAgICAgICAgICBjb252ZXJ0ZWQ6IG1ldHJpYy5jb252ZXJ0ZWQsXG4gICAgICAgICAgICBvcGVuUmF0ZTogbWV0cmljLm9wZW5SYXRlLFxuICAgICAgICAgICAgY2xpY2tSYXRlOiBtZXRyaWMuY2xpY2tSYXRlLFxuICAgICAgICAgICAgY29udmVyc2lvblJhdGU6IG1ldHJpYy5jb252ZXJzaW9uUmF0ZSxcbiAgICAgICAgICAgIHJldmVudWU6IG1ldHJpYy5yZXZlbnVlLFxuICAgICAgICAgICAgcm9pOiBNYXRoLnJvdW5kKHJvaSAqIDEwMCkgLyAxMDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJldmVudWVBdHRyaWJ1dGlvbjogYXdhaXQgdGhpcy5jYWxjdWxhdGVSZXZlbnVlQXR0cmlidXRpb24obWV0cmljLmNhbXBhaWduSWQsIGF1dGhDb250ZXh0Lm9yZ2FuaXphdGlvbklkKVxuICAgICAgICB9O1xuICAgICAgfSkpO1xuXG4gICAgICAvLyBHZW5lcmF0ZSBpbnNpZ2h0c1xuICAgICAgY29uc3QgdG9wVmFsdWUgPSB0b3BDYW1wYWlnbnNbMF0/LlttZXRyaWNdIHx8IDA7XG4gICAgICBjb25zdCBhdmdWYWx1ZSA9IHRvcENhbXBhaWducy5sZW5ndGggPiAwIFxuICAgICAgICA/IHRvcENhbXBhaWducy5yZWR1Y2UoKHN1bSwgYykgPT4gc3VtICsgKGNbbWV0cmljXSB8fCAwKSwgMCkgLyB0b3BDYW1wYWlnbnMubGVuZ3RoIFxuICAgICAgICA6IDA7XG5cbiAgICAgIGNvbnN0IGluc2lnaHRzID0gW1xuICAgICAgICBgVG9wIGNhbXBhaWduIGFjaGlldmVkICR7dHlwZW9mIHRvcFZhbHVlID09PSAnbnVtYmVyJyA/IHRvcFZhbHVlLnRvRml4ZWQoMikgOiB0b3BWYWx1ZX0gJHttZXRyaWN9YCxcbiAgICAgICAgYEF2ZXJhZ2UgJHttZXRyaWN9IGFjcm9zcyB0b3AgY2FtcGFpZ25zOiAke2F2Z1ZhbHVlLnRvRml4ZWQoMil9YCxcbiAgICAgICAgdG9wQ2FtcGFpZ25zLmxlbmd0aCA+IDEgXG4gICAgICAgICAgPyBgUGVyZm9ybWFuY2UgZ2FwIGJldHdlZW4gIzEgYW5kICMyOiAkeygodG9wVmFsdWUgLSAodG9wQ2FtcGFpZ25zWzFdPy5bbWV0cmljXSB8fCAwKSkgLyB0b3BWYWx1ZSAqIDEwMCkudG9GaXhlZCgxKX0lYFxuICAgICAgICAgIDogXCJTaW5nbGUgY2FtcGFpZ24gcmVzdWx0XCIsXG4gICAgICAgIFwiQ29uc2lkZXIgcmVwbGljYXRpbmcgc3VjY2Vzc2Z1bCBzdHJhdGVnaWVzIGZyb20gdG9wIHBlcmZvcm1lcnNcIlxuICAgICAgXTtcblxuICAgICAgLy8gQ2hhbm5lbCBkaXN0cmlidXRpb25cbiAgICAgIGNvbnN0IGNoYW5uZWxEaXN0cmlidXRpb24gPSB0b3BDYW1wYWlnbnMucmVkdWNlKChhY2M6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4sIGMpID0+IHtcbiAgICAgICAgYWNjW2MudHlwZV0gPSAoYWNjW2MudHlwZV0gfHwgMCkgKyAxO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSwge30pO1xuXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICdnZXRfdG9wX3BlcmZvcm1pbmdfY2FtcGFpZ25zJyxcbiAgICAgICAgYXJncyxcbiAgICAgICAgJ3N1Y2Nlc3MnLFxuICAgICAgICB7IFxuICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgIG91dHB1dFNpemU6IHRvcENhbXBhaWducy5sZW5ndGgsXG4gICAgICAgICAgcmlza0xldmVsOiAnbG93J1xuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250ZW50OiBbe1xuICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIGNhbXBhaWduczogdG9wQ2FtcGFpZ25zLFxuICAgICAgICAgICAgICBzb3J0ZWRCeTogbWV0cmljLFxuICAgICAgICAgICAgICBpbnNpZ2h0cyxcbiAgICAgICAgICAgICAgc3RhdGlzdGljczoge1xuICAgICAgICAgICAgICAgIHRvdGFsQ2FtcGFpZ25zOiB0b3BDYW1wYWlnbnMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHRvcFZhbHVlLFxuICAgICAgICAgICAgICAgIGF2ZXJhZ2VWYWx1ZTogTWF0aC5yb3VuZChhdmdWYWx1ZSAqIDEwMCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgY2hhbm5lbERpc3RyaWJ1dGlvbixcbiAgICAgICAgICAgICAgICBkYXRlUmFuZ2U6IHtcbiAgICAgICAgICAgICAgICAgIGZyb206IHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgdG86IG5vdy50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgZGF5czogZGF5c0JhY2tcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRhOiB7XG4gICAgICAgICAgICAgIG1ldHJpYyxcbiAgICAgICAgICAgICAgbGltaXQsXG4gICAgICAgICAgICAgIGRhdGVSYW5nZSxcbiAgICAgICAgICAgICAgY2FtcGFpZ25UeXBlLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICAgIHNvdXJjZTogJ01DUF9DQU1QQUlHTl9NRVRSSUNTJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH1dXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBcbiAgICAgIGF3YWl0IHRoaXMubG9nTUNQVG9vbEV4ZWN1dGlvbihcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICdnZXRfdG9wX3BlcmZvcm1pbmdfY2FtcGFpZ25zJyxcbiAgICAgICAgYXJncyxcbiAgICAgICAgJ2ZhaWx1cmUnLFxuICAgICAgICB7IFxuICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgIGVycm9yTWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgcmlza0xldmVsOiAnbWVkaXVtJ1xuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250ZW50OiBbe1xuICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3I6IFwiRmFpbGVkIHRvIHJldHJpZXZlIHRvcCBwZXJmb3JtaW5nIGNhbXBhaWduc1wiLFxuICAgICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICB9KVxuICAgICAgICB9XSxcbiAgICAgICAgaXNFcnJvcjogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW5hbHl6ZSBjYW1wYWlnbiB0cmVuZHMgdG9vbFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplQ2FtcGFpZ25UcmVuZHMoYXJnczogYW55LCBhdXRoQ29udGV4dDogTUNQQXV0aENvbnRleHQpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHsgY2FtcGFpZ25JZCwgcGVyaW9kID0gJ3dlZWtseScsIG1ldHJpYyA9ICdjb252ZXJzaW9uX3JhdGUnIH0gPSBhcmdzO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFBsYWNlaG9sZGVyIHRyZW5kIGRhdGFcbiAgICAgIGNvbnN0IHRyZW5kcyA9IHtcbiAgICAgICAgY2FtcGFpZ25JZCxcbiAgICAgICAgbWV0cmljLFxuICAgICAgICBwZXJpb2QsXG4gICAgICAgIGRhdGFQb2ludHM6IEFycmF5LmZyb20oeyBsZW5ndGg6IDEyIH0sIChfLCBpKSA9PiAoe1xuICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKERhdGUubm93KCkgLSAoaSAqIDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLFxuICAgICAgICAgIHZhbHVlOiAyLjUgKyBNYXRoLnNpbihpICogMC41KSAqIDAuOCArIChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDAuM1xuICAgICAgICB9KSkucmV2ZXJzZSgpLFxuICAgICAgICBpbnNpZ2h0czogW1xuICAgICAgICAgIFwiQ29udmVyc2lvbiByYXRlIHNob3dzIDE1JSBpbXByb3ZlbWVudCBvdmVyIHRoZSBwZXJpb2RcIixcbiAgICAgICAgICBcIlBlYWsgcGVyZm9ybWFuY2Ugb2NjdXJzIG9uIFR1ZXNkYXlzIGFuZCBXZWRuZXNkYXlzXCIsXG4gICAgICAgICAgXCJTZWFzb25hbCB0cmVuZHMgaW5kaWNhdGUgaGlnaGVyIHBlcmZvcm1hbmNlIGluIG1pZC1tb250aFwiXG4gICAgICAgIF1cbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IHRyZW5kcyxcbiAgICAgICAgICAgIG1ldGE6IHtcbiAgICAgICAgICAgICAgcGVyaW9kLFxuICAgICAgICAgICAgICBtZXRyaWMsXG4gICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICBmYWxsYmFja1VzZWQ6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29udGVudDogW3tcbiAgICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBcIkZhaWxlZCB0byBhbmFseXplIGNhbXBhaWduIHRyZW5kc1wiLFxuICAgICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICB9KVxuICAgICAgICB9XSxcbiAgICAgICAgaXNFcnJvcjogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRmFsbGJhY2sgbWV0aG9kcyBmb3IgY2FtcGFpZ24gZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRDYW1wYWlnbnNGYWxsYmFjayh3aGVyZUNsYXVzZTogYW55LCBsaW1pdDogbnVtYmVyLCBvZmZzZXQ6IG51bWJlcik6IFByb21pc2U8YW55W10+IHtcbiAgICAvLyBQbGFjZWhvbGRlciBpbXBsZW1lbnRhdGlvbiAtIHdvdWxkIHVzZSBhY3R1YWwgUHJpc21hIHF1ZXJpZXNcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogbGltaXQgfSwgKF8sIGkpID0+ICh7XG4gICAgICBpZDogYGNhbXBhaWduLSR7aSArIDF9YCxcbiAgICAgIG5hbWU6IGBDYW1wYWlnbiAke2kgKyAxfWAsXG4gICAgICB0eXBlOiAnRU1BSUwnLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IHdoZXJlQ2xhdXNlLm9yZ2FuaXphdGlvbklkLFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH0pKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGYWxsYmFjayBmb3IgY2FtcGFpZ24gYW5hbHl0aWNzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldENhbXBhaWduQW5hbHl0aWNzRmFsbGJhY2socXVlcnk6IENhbXBhaWduQW5hbHl0aWNzUXVlcnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNhbXBhaWduczogW10sXG4gICAgICBtZXRhOiB7XG4gICAgICAgIHRvdGFsOiAwLFxuICAgICAgICBvZmZzZXQ6IHF1ZXJ5Lm9mZnNldCxcbiAgICAgICAgbGltaXQ6IHF1ZXJ5LmxpbWl0LFxuICAgICAgICBmYWxsYmFja1VzZWQ6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6IFwiQ2FtcGFpZ24gYW5hbHl0aWNzIGZhbGxiYWNrIC0gaW1wbGVtZW50YXRpb24gbmVlZGVkXCJcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjYW1wYWlnbiBwZXJmb3JtYW5jZSAocGxhY2Vob2xkZXIpXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldENhbXBhaWduUGVyZm9ybWFuY2UocXVlcnk6IENhbXBhaWduQW5hbHl0aWNzUXVlcnksIGF1dGhDb250ZXh0OiBNQ1BBdXRoQ29udGV4dCk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVyaTogXCJjYW1wYWlnbjovL3BlcmZvcm1hbmNlXCIsXG4gICAgICBtaW1lVHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG1lc3NhZ2U6IFwiQ2FtcGFpZ24gcGVyZm9ybWFuY2UgZnVuY3Rpb25hbGl0eSBjb21pbmcgc29vblwiLFxuICAgICAgICBmYWxsYmFja1VzZWQ6IHRydWVcbiAgICAgIH0pXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgQS9CIHRlc3QgcmVzdWx0cyB3aXRoIHJlYWwgZGF0YSBhbmQgc3RhdGlzdGljYWwgYW5hbHlzaXNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0QUJUZXN0UmVzdWx0cyhxdWVyeTogQ2FtcGFpZ25BbmFseXRpY3NRdWVyeSwgYXV0aENvbnRleHQ6IE1DUEF1dGhDb250ZXh0KTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIFxuICAgICAgLy8gQnVpbGQgd2hlcmUgY2xhdXNlIGZvciBBL0IgdGVzdHNcbiAgICAgIGNvbnN0IHdoZXJlQ2xhdXNlOiBhbnkgPSB7XG4gICAgICAgIGNyZWF0ZWRCeToge1xuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBhdXRoQ29udGV4dC5vcmdhbml6YXRpb25JZFxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBpZiAocXVlcnkuY2FtcGFpZ25JZCkge1xuICAgICAgICB3aGVyZUNsYXVzZS5lbnRpdHlJZCA9IHF1ZXJ5LmNhbXBhaWduSWQ7XG4gICAgICB9XG5cbiAgICAgIGlmIChxdWVyeS5kYXRlRnJvbSB8fCBxdWVyeS5kYXRlVG8pIHtcbiAgICAgICAgd2hlcmVDbGF1c2UuY3JlYXRlZEF0ID0ge307XG4gICAgICAgIGlmIChxdWVyeS5kYXRlRnJvbSkge1xuICAgICAgICAgIHdoZXJlQ2xhdXNlLmNyZWF0ZWRBdC5ndGUgPSBuZXcgRGF0ZShxdWVyeS5kYXRlRnJvbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHF1ZXJ5LmRhdGVUbykge1xuICAgICAgICAgIHdoZXJlQ2xhdXNlLmNyZWF0ZWRBdC5sdGUgPSBuZXcgRGF0ZShxdWVyeS5kYXRlVG8pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCBBL0IgdGVzdHMgd2l0aCB2YXJpYW50cyBhbmQgcmVzdWx0c1xuICAgICAgY29uc3QgYWJUZXN0cyA9IGF3YWl0IHByaXNtYS5hQlRlc3QuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogd2hlcmVDbGF1c2UsXG4gICAgICAgIHRha2U6IHF1ZXJ5LmxpbWl0LFxuICAgICAgICBza2lwOiBxdWVyeS5vZmZzZXQsXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB2YXJpYW50czoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICByZXN1bHRzOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXN1bHRzOiB0cnVlLFxuICAgICAgICAgIGNyZWF0ZWRCeToge1xuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBlbWFpbDogdHJ1ZSB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgY3JlYXRlZEF0OiAnZGVzYydcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIFRyYW5zZm9ybSBBL0IgdGVzdCBkYXRhIHdpdGggc3RhdGlzdGljYWwgYW5hbHlzaXNcbiAgICAgIGNvbnN0IHRlc3RSZXN1bHRzID0gYWJUZXN0cy5tYXAodGVzdCA9PiB7XG4gICAgICAgIGNvbnN0IHZhcmlhbnRzID0gdGVzdC52YXJpYW50cy5tYXAodmFyaWFudCA9PiB7XG4gICAgICAgICAgLy8gQWdncmVnYXRlIHJlc3VsdHMgYnkgbWV0cmljXG4gICAgICAgICAgY29uc3QgbWV0cmljUmVzdWx0cyA9IHZhcmlhbnQucmVzdWx0cy5yZWR1Y2UoKGFjYzogUmVjb3JkPHN0cmluZywgYW55PiwgcmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBhY2NbcmVzdWx0Lm1ldHJpY10gPSB7XG4gICAgICAgICAgICAgIHZhbHVlOiByZXN1bHQudmFsdWUsXG4gICAgICAgICAgICAgIHNhbXBsZVNpemU6IHJlc3VsdC5zYW1wbGVTaXplLFxuICAgICAgICAgICAgICBjb25maWRlbmNlOiB0aGlzLmNhbGN1bGF0ZUNvbmZpZGVuY2VJbnRlcnZhbChyZXN1bHQudmFsdWUsIHJlc3VsdC5zYW1wbGVTaXplKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgICAgfSwge30pO1xuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiB2YXJpYW50LmlkLFxuICAgICAgICAgICAgbmFtZTogdmFyaWFudC5uYW1lLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHZhcmlhbnQuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBjb250ZW50OiBKU09OLnBhcnNlKHZhcmlhbnQuY29udGVudCB8fCAne30nKSxcbiAgICAgICAgICAgIHRyYWZmaWNQZXJjZW50OiB2YXJpYW50LnRyYWZmaWNQZXJjZW50LFxuICAgICAgICAgICAgcmVzdWx0czogbWV0cmljUmVzdWx0cyxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogdmFyaWFudC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENhbGN1bGF0ZSBzdGF0aXN0aWNhbCBzaWduaWZpY2FuY2UgYmV0d2VlbiB2YXJpYW50c1xuICAgICAgICBjb25zdCBzdGF0aXN0aWNhbEFuYWx5c2lzID0gdGhpcy5jYWxjdWxhdGVBQlRlc3RTaWduaWZpY2FuY2UodmFyaWFudHMsIHRlc3Qud2lubmVyTWV0cmljKTtcblxuICAgICAgICAvLyBEZXRlcm1pbmUgd2lubmVyIGlmIHRlc3QgaGFzIGNvbmNsdWRlZFxuICAgICAgICBjb25zdCB3aW5uZXIgPSB0ZXN0Lndpbm5lclZhcmlhbnRJZCBcbiAgICAgICAgICA/IHZhcmlhbnRzLmZpbmQodiA9PiB2LmlkID09PSB0ZXN0Lndpbm5lclZhcmlhbnRJZClcbiAgICAgICAgICA6IHN0YXRpc3RpY2FsQW5hbHlzaXMucmVjb21tZW5kZWRXaW5uZXI7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogdGVzdC5pZCxcbiAgICAgICAgICBuYW1lOiB0ZXN0Lm5hbWUsXG4gICAgICAgICAgZGVzY3JpcHRpb246IHRlc3QuZGVzY3JpcHRpb24sXG4gICAgICAgICAgZW50aXR5VHlwZTogdGVzdC5lbnRpdHlUeXBlLFxuICAgICAgICAgIGVudGl0eUlkOiB0ZXN0LmVudGl0eUlkLFxuICAgICAgICAgIHN0YXR1czogdGVzdC5zdGF0dXMsXG4gICAgICAgICAgdGVzdFR5cGU6IHRlc3QudGVzdFR5cGUsXG4gICAgICAgICAgdGVzdEVsZW1lbnRzOiBKU09OLnBhcnNlKHRlc3QudGVzdEVsZW1lbnRzIHx8ICdbXScpLFxuICAgICAgICAgIHdpbm5lck1ldHJpYzogdGVzdC53aW5uZXJNZXRyaWMsXG4gICAgICAgICAgd2lubmVyVGhyZXNob2xkOiB0ZXN0Lndpbm5lclRocmVzaG9sZCxcbiAgICAgICAgICBkaXN0cmlidXRpb25QZXJjZW50OiB0ZXN0LmRpc3RyaWJ1dGlvblBlcmNlbnQsXG4gICAgICAgICAgc3RhcnRlZEF0OiB0ZXN0LnN0YXJ0ZWRBdD8udG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBlbmRlZEF0OiB0ZXN0LmVuZGVkQXQ/LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgY3JlYXRlZEF0OiB0ZXN0LmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogdGVzdC51cGRhdGVkQXQudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBjcmVhdGVkQnk6IHtcbiAgICAgICAgICAgIGlkOiB0ZXN0LmNyZWF0ZWRCeS5pZCxcbiAgICAgICAgICAgIG5hbWU6IHRlc3QuY3JlYXRlZEJ5Lm5hbWUsXG4gICAgICAgICAgICBlbWFpbDogdGVzdC5jcmVhdGVkQnkuZW1haWxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHZhcmlhbnRzLFxuICAgICAgICAgIHdpbm5lcixcbiAgICAgICAgICBzdGF0aXN0aWNhbEFuYWx5c2lzLFxuICAgICAgICAgIGluc2lnaHRzOiB0aGlzLmdlbmVyYXRlQUJUZXN0SW5zaWdodHModmFyaWFudHMsIHN0YXRpc3RpY2FsQW5hbHlzaXMsIHRlc3Qud2lubmVyTWV0cmljKVxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBzdW1tYXJ5IHN0YXRpc3RpY3NcbiAgICAgIGNvbnN0IHRvdGFsVGVzdHMgPSB0ZXN0UmVzdWx0cy5sZW5ndGg7XG4gICAgICBjb25zdCBhY3RpdmVUZXN0cyA9IHRlc3RSZXN1bHRzLmZpbHRlcih0ID0+IHQuc3RhdHVzID09PSAnUlVOTklORycpLmxlbmd0aDtcbiAgICAgIGNvbnN0IGNvbXBsZXRlZFRlc3RzID0gdGVzdFJlc3VsdHMuZmlsdGVyKHQgPT4gdC5zdGF0dXMgPT09ICdDT01QTEVURUQnKS5sZW5ndGg7XG4gICAgICBjb25zdCBzaWduaWZpY2FudFRlc3RzID0gdGVzdFJlc3VsdHMuZmlsdGVyKHQgPT4gXG4gICAgICAgIHQuc3RhdGlzdGljYWxBbmFseXNpcy5pc1N0YXRpc3RpY2FsbHlTaWduaWZpY2FudFxuICAgICAgKS5sZW5ndGg7XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgLy8gTG9nIHJlc291cmNlIGFjY2Vzc1xuICAgICAgYXdhaXQgdGhpcy5sb2dNQ1BSZXNvdXJjZUFjY2VzcyhcbiAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICdjYW1wYWlnbjovL2FiLXRlc3RzJyxcbiAgICAgICAgJ0xJU1QnLFxuICAgICAgICAnc3VjY2VzcycsXG4gICAgICAgIHsgZHVyYXRpb24sIGRhdGFTaXplOiB0ZXN0UmVzdWx0cy5sZW5ndGggfVxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXJpOiBcImNhbXBhaWduOi8vYWItdGVzdHNcIixcbiAgICAgICAgbWltZVR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgYWJUZXN0czogdGVzdFJlc3VsdHMsXG4gICAgICAgICAgc3VtbWFyeToge1xuICAgICAgICAgICAgdG90YWxUZXN0cyxcbiAgICAgICAgICAgIGFjdGl2ZVRlc3RzLFxuICAgICAgICAgICAgY29tcGxldGVkVGVzdHMsXG4gICAgICAgICAgICBzaWduaWZpY2FudFRlc3RzLFxuICAgICAgICAgICAgc2lnbmlmaWNhbmNlUmF0ZTogdG90YWxUZXN0cyA+IDAgPyAoc2lnbmlmaWNhbnRUZXN0cyAvIHRvdGFsVGVzdHMpICogMTAwIDogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWV0YToge1xuICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgbGltaXQ6IHF1ZXJ5LmxpbWl0LFxuICAgICAgICAgICAgICBvZmZzZXQ6IHF1ZXJ5Lm9mZnNldCxcbiAgICAgICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IGF1dGhDb250ZXh0Lm9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICAgIHNvdXJjZTogJ1JFQUxfQUJfVEVTVF9EQVRBJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIExvZyBmYWlsZWQgYWNjZXNzXG4gICAgICBhd2FpdCB0aGlzLmxvZ01DUFJlc291cmNlQWNjZXNzKFxuICAgICAgICBhdXRoQ29udGV4dCxcbiAgICAgICAgJ2NhbXBhaWduOi8vYWItdGVzdHMnLFxuICAgICAgICAnTElTVCcsXG4gICAgICAgICdmYWlsdXJlJyxcbiAgICAgICAgeyBlcnJvck1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InIH1cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVyaTogXCJjYW1wYWlnbjovL2FiLXRlc3RzXCIsXG4gICAgICAgIG1pbWVUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGVycm9yOiBcIkZhaWxlZCB0byByZXRyaWV2ZSBBL0IgdGVzdCByZXN1bHRzXCIsXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgZmFsbGJhY2s6IHtcbiAgICAgICAgICAgIGFiVGVzdHM6IFtdLFxuICAgICAgICAgICAgc3VtbWFyeToge1xuICAgICAgICAgICAgICB0b3RhbFRlc3RzOiAwLFxuICAgICAgICAgICAgICBhY3RpdmVUZXN0czogMCxcbiAgICAgICAgICAgICAgY29tcGxldGVkVGVzdHM6IDAsXG4gICAgICAgICAgICAgIHNpZ25pZmljYW50VGVzdHM6IDAsXG4gICAgICAgICAgICAgIHNpZ25pZmljYW5jZVJhdGU6IDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY2FtcGFpZ24gaW5zaWdodHMgKHBsYWNlaG9sZGVyKVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRDYW1wYWlnbkluc2lnaHRzKHF1ZXJ5OiBDYW1wYWlnbkFuYWx5dGljc1F1ZXJ5LCBhdXRoQ29udGV4dDogTUNQQXV0aENvbnRleHQpOiBQcm9taXNlPGFueT4ge1xuICAgIHJldHVybiB7XG4gICAgICB1cmk6IFwiY2FtcGFpZ246Ly9pbnNpZ2h0c1wiLFxuICAgICAgbWltZVR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgdGV4dDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBtZXNzYWdlOiBcIkNhbXBhaWduIGluc2lnaHRzIGZ1bmN0aW9uYWxpdHkgY29taW5nIHNvb25cIixcbiAgICAgICAgZmFsbGJhY2tVc2VkOiB0cnVlXG4gICAgICB9KVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgY29tcGFyYXRpdmUgaW5zaWdodHMgYmV0d2VlbiBjYW1wYWlnbnNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDb21wYXJpc29uSW5zaWdodHMoY2FtcGFpZ25zOiBhbnlbXSwgbWV0cmljczogc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gICAgaWYgKGNhbXBhaWducy5sZW5ndGggPCAyKSByZXR1cm4gW1wiTmVlZCBhdCBsZWFzdCAyIGNhbXBhaWducyBmb3IgY29tcGFyaXNvblwiXTtcblxuICAgIGNvbnN0IGluc2lnaHRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIFxuICAgIGZvciAoY29uc3QgbWV0cmljIG9mIG1ldHJpY3MpIHtcbiAgICAgIGNvbnN0IHZhbHVlcyA9IGNhbXBhaWducy5tYXAoYyA9PiBjLm1ldHJpY3NbbWV0cmljXSkuZmlsdGVyKHYgPT4gdiAhPSBudWxsKTtcbiAgICAgIGlmICh2YWx1ZXMubGVuZ3RoIDwgMikgY29udGludWU7XG5cbiAgICAgIGNvbnN0IGJlc3QgPSBNYXRoLm1heCguLi52YWx1ZXMpO1xuICAgICAgY29uc3Qgd29yc3QgPSBNYXRoLm1pbiguLi52YWx1ZXMpO1xuICAgICAgY29uc3QgYXZlcmFnZSA9IHZhbHVlcy5yZWR1Y2UoKHN1bSwgdmFsKSA9PiBzdW0gKyB2YWwsIDApIC8gdmFsdWVzLmxlbmd0aDtcbiAgICAgIFxuICAgICAgY29uc3QgYmVzdENhbXBhaWduID0gY2FtcGFpZ25zLmZpbmQoYyA9PiBjLm1ldHJpY3NbbWV0cmljXSA9PT0gYmVzdCk7XG4gICAgICBjb25zdCB3b3JzdENhbXBhaWduID0gY2FtcGFpZ25zLmZpbmQoYyA9PiBjLm1ldHJpY3NbbWV0cmljXSA9PT0gd29yc3QpO1xuICAgICAgXG4gICAgICBpZiAoYmVzdENhbXBhaWduICYmIHdvcnN0Q2FtcGFpZ24gJiYgYmVzdCAhPT0gd29yc3QpIHtcbiAgICAgICAgY29uc3QgaW1wcm92ZW1lbnQgPSAoKGJlc3QgLSB3b3JzdCkgLyB3b3JzdCkgKiAxMDA7XG4gICAgICAgIGluc2lnaHRzLnB1c2goXG4gICAgICAgICAgYCR7YmVzdENhbXBhaWduLm5hbWV9IG91dHBlcmZvcm1zICR7d29yc3RDYW1wYWlnbi5uYW1lfSBieSAke2ltcHJvdmVtZW50LnRvRml4ZWQoMSl9JSBpbiAke21ldHJpYy5yZXBsYWNlKCdfJywgJyAnKX1gXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChiZXN0ID4gYXZlcmFnZSAqIDEuMikge1xuICAgICAgICBpbnNpZ2h0cy5wdXNoKFxuICAgICAgICAgIGAke2Jlc3RDYW1wYWlnbj8ubmFtZX0gc2hvd3MgZXhjZXB0aW9uYWwgJHttZXRyaWMucmVwbGFjZSgnXycsICcgJyl9IHBlcmZvcm1hbmNlICgke2Jlc3QudG9GaXhlZCgyKX0lIHZzICR7YXZlcmFnZS50b0ZpeGVkKDIpfSUgYXZlcmFnZSlgXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGluc2lnaHRzLmxlbmd0aCA+IDAgPyBpbnNpZ2h0cyA6IFtcIkFsbCBjYW1wYWlnbnMgc2hvdyBzaW1pbGFyIHBlcmZvcm1hbmNlIHBhdHRlcm5zXCJdO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBzdGF0aXN0aWNhbCBzaWduaWZpY2FuY2UgYmV0d2VlbiBjYW1wYWlnbnNcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlU3RhdGlzdGljYWxTaWduaWZpY2FuY2UoY2FtcGFpZ25zOiBhbnlbXSwgbWV0cmljczogc3RyaW5nW10pOiBhbnkge1xuICAgIGlmIChjYW1wYWlnbnMubGVuZ3RoIDwgMikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNTdGF0aXN0aWNhbGx5U2lnbmlmaWNhbnQ6IGZhbHNlLFxuICAgICAgICBjb25maWRlbmNlTGV2ZWw6IDAsXG4gICAgICAgIHBWYWx1ZTogMSxcbiAgICAgICAgZWZmZWN0OiAnbm9uZScsXG4gICAgICAgIHJlY29tbWVuZGF0aW9uOiAnTmVlZCBhdCBsZWFzdCAyIGNhbXBhaWducyBmb3Igc3RhdGlzdGljYWwgYW5hbHlzaXMnXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIFVzZSB0aGUgZmlyc3QgbWV0cmljIGZvciBwcmltYXJ5IGFuYWx5c2lzXG4gICAgY29uc3QgcHJpbWFyeU1ldHJpYyA9IG1ldHJpY3NbMF0gfHwgJ2NvbnZlcnNpb25fcmF0ZSc7XG4gICAgY29uc3QgbWV0cmljVmFsdWVzID0gY2FtcGFpZ25zLm1hcChjID0+ICh7XG4gICAgICBuYW1lOiBjLm5hbWUsXG4gICAgICB2YWx1ZTogYy5tZXRyaWNzW3ByaW1hcnlNZXRyaWNdLFxuICAgICAgc2FtcGxlU2l6ZTogYy5wZXJmb3JtYW5jZS5zZW50IHx8IDEwMDAgLy8gRmFsbGJhY2sgc2FtcGxlIHNpemVcbiAgICB9KSkuZmlsdGVyKHYgPT4gdi52YWx1ZSAhPSBudWxsKTtcblxuICAgIGlmIChtZXRyaWNWYWx1ZXMubGVuZ3RoIDwgMikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNTdGF0aXN0aWNhbGx5U2lnbmlmaWNhbnQ6IGZhbHNlLFxuICAgICAgICBjb25maWRlbmNlTGV2ZWw6IDAsXG4gICAgICAgIHBWYWx1ZTogMSxcbiAgICAgICAgZWZmZWN0OiAnbm9uZScsXG4gICAgICAgIHJlY29tbWVuZGF0aW9uOiAnSW5zdWZmaWNpZW50IGRhdGEgZm9yIHN0YXRpc3RpY2FsIGFuYWx5c2lzJ1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBTaW1wbGUgdHdvLXNhbXBsZSBjb21wYXJpc29uICh1c2luZyB0aGUgdG9wIDIgcGVyZm9ybWVycylcbiAgICBjb25zdCBzb3J0ZWRWYWx1ZXMgPSBtZXRyaWNWYWx1ZXMuc29ydCgoYSwgYikgPT4gYi52YWx1ZSAtIGEudmFsdWUpO1xuICAgIGNvbnN0IGJlc3QgPSBzb3J0ZWRWYWx1ZXNbMF07XG4gICAgY29uc3Qgc2Vjb25kID0gc29ydGVkVmFsdWVzWzFdO1xuXG4gICAgLy8gQ2FsY3VsYXRlIHotc2NvcmUgZm9yIHByb3BvcnRpb25zIChzaW1wbGlmaWVkKVxuICAgIGNvbnN0IHAxID0gYmVzdC52YWx1ZSAvIDEwMDsgLy8gQ29udmVydCBwZXJjZW50YWdlIHRvIHByb3BvcnRpb25cbiAgICBjb25zdCBwMiA9IHNlY29uZC52YWx1ZSAvIDEwMDtcbiAgICBjb25zdCBuMSA9IGJlc3Quc2FtcGxlU2l6ZTtcbiAgICBjb25zdCBuMiA9IHNlY29uZC5zYW1wbGVTaXplO1xuXG4gICAgLy8gUG9vbCBwcm9wb3J0aW9uXG4gICAgY29uc3QgcG9vbGVkUCA9IChwMSAqIG4xICsgcDIgKiBuMikgLyAobjEgKyBuMik7XG4gICAgY29uc3Qgc3RhbmRhcmRFcnJvciA9IE1hdGguc3FydChwb29sZWRQICogKDEgLSBwb29sZWRQKSAqICgxL24xICsgMS9uMikpO1xuICAgIFxuICAgIGNvbnN0IHpTY29yZSA9IE1hdGguYWJzKHAxIC0gcDIpIC8gc3RhbmRhcmRFcnJvcjtcbiAgICBjb25zdCBwVmFsdWUgPSAyICogKDEgLSB0aGlzLm5vcm1hbENERihNYXRoLmFicyh6U2NvcmUpKSk7IC8vIFR3by10YWlsZWQgdGVzdFxuXG4gICAgY29uc3QgaXNTaWduaWZpY2FudCA9IHBWYWx1ZSA8IDAuMDU7XG4gICAgY29uc3QgY29uZmlkZW5jZUxldmVsID0gKDEgLSBwVmFsdWUpICogMTAwO1xuXG4gICAgLy8gRWZmZWN0IHNpemUgKENvaGVuJ3MgaCBmb3IgcHJvcG9ydGlvbnMpXG4gICAgY29uc3QgZWZmZWN0U2l6ZSA9IDIgKiAoTWF0aC5hc2luKE1hdGguc3FydChwMSkpIC0gTWF0aC5hc2luKE1hdGguc3FydChwMikpKTtcbiAgICBjb25zdCBlZmZlY3RNYWduaXR1ZGUgPSBNYXRoLmFicyhlZmZlY3RTaXplKSA8IDAuMiA/ICdzbWFsbCcgOiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguYWJzKGVmZmVjdFNpemUpIDwgMC41ID8gJ21lZGl1bScgOiAnbGFyZ2UnO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlzU3RhdGlzdGljYWxseVNpZ25pZmljYW50OiBpc1NpZ25pZmljYW50LFxuICAgICAgY29uZmlkZW5jZUxldmVsOiBNYXRoLnJvdW5kKGNvbmZpZGVuY2VMZXZlbCAqIDEwMCkgLyAxMDAsXG4gICAgICBwVmFsdWU6IE1hdGgucm91bmQocFZhbHVlICogMTAwMCkgLyAxMDAwLFxuICAgICAgelNjb3JlOiBNYXRoLnJvdW5kKHpTY29yZSAqIDEwMCkgLyAxMDAsXG4gICAgICBlZmZlY3RTaXplOiBNYXRoLnJvdW5kKGVmZmVjdFNpemUgKiAxMDAwKSAvIDEwMDAsXG4gICAgICBlZmZlY3Q6IGVmZmVjdE1hZ25pdHVkZSxcbiAgICAgIGNvbXBhcmlzb246IHtcbiAgICAgICAgd2lubmVyOiBiZXN0Lm5hbWUsXG4gICAgICAgIHdpbm5lclZhbHVlOiBiZXN0LnZhbHVlLFxuICAgICAgICBydW5uZXI6IHNlY29uZC5uYW1lLFxuICAgICAgICBydW5uZXJWYWx1ZTogc2Vjb25kLnZhbHVlLFxuICAgICAgICBpbXByb3ZlbWVudDogKChiZXN0LnZhbHVlIC0gc2Vjb25kLnZhbHVlKSAvIHNlY29uZC52YWx1ZSkgKiAxMDBcbiAgICAgIH0sXG4gICAgICByZWNvbW1lbmRhdGlvbjogaXNTaWduaWZpY2FudCBcbiAgICAgICAgPyBgJHtiZXN0Lm5hbWV9IHNob3dzIHN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQgaW1wcm92ZW1lbnQgaW4gJHtwcmltYXJ5TWV0cmljLnJlcGxhY2UoJ18nLCAnICcpfWBcbiAgICAgICAgOiAnTm8gc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCBkaWZmZXJlbmNlIGRldGVjdGVkLiBDb250aW51ZSB0ZXN0aW5nIGZvciBtb3JlIGRhdGEuJ1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIGNvbmZpZGVuY2UgaW50ZXJ2YWwgZm9yIGEgcHJvcG9ydGlvblxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVDb25maWRlbmNlSW50ZXJ2YWwodmFsdWU6IG51bWJlciwgc2FtcGxlU2l6ZTogbnVtYmVyLCBjb25maWRlbmNlTGV2ZWw6IG51bWJlciA9IDAuOTUpOiBhbnkge1xuICAgIGNvbnN0IHAgPSB2YWx1ZSAvIDEwMDsgLy8gQ29udmVydCBwZXJjZW50YWdlIHRvIHByb3BvcnRpb25cbiAgICBjb25zdCBuID0gc2FtcGxlU2l6ZTtcbiAgICBjb25zdCB6QWxwaGEgPSAxLjk2OyAvLyA5NSUgY29uZmlkZW5jZSBsZXZlbFxuICAgIFxuICAgIGNvbnN0IHN0YW5kYXJkRXJyb3IgPSBNYXRoLnNxcnQoKHAgKiAoMSAtIHApKSAvIG4pO1xuICAgIGNvbnN0IG1hcmdpbk9mRXJyb3IgPSB6QWxwaGEgKiBzdGFuZGFyZEVycm9yO1xuICAgIFxuICAgIGNvbnN0IGxvd2VyQm91bmQgPSBNYXRoLm1heCgwLCAocCAtIG1hcmdpbk9mRXJyb3IpICogMTAwKTtcbiAgICBjb25zdCB1cHBlckJvdW5kID0gTWF0aC5taW4oMTAwLCAocCArIG1hcmdpbk9mRXJyb3IpICogMTAwKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgbG93ZXJCb3VuZDogTWF0aC5yb3VuZChsb3dlckJvdW5kICogMTAwKSAvIDEwMCxcbiAgICAgIHVwcGVyQm91bmQ6IE1hdGgucm91bmQodXBwZXJCb3VuZCAqIDEwMCkgLyAxMDAsXG4gICAgICBtYXJnaW5PZkVycm9yOiBNYXRoLnJvdW5kKG1hcmdpbk9mRXJyb3IgKiAxMDAgKiAxMDApIC8gMTAwLFxuICAgICAgY29uZmlkZW5jZUxldmVsOiBjb25maWRlbmNlTGV2ZWwgKiAxMDBcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBBL0IgdGVzdCBzdGF0aXN0aWNhbCBzaWduaWZpY2FuY2VcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlQUJUZXN0U2lnbmlmaWNhbmNlKHZhcmlhbnRzOiBhbnlbXSwgd2lubmVyTWV0cmljOiBzdHJpbmcpOiBhbnkge1xuICAgIGlmICh2YXJpYW50cy5sZW5ndGggPCAyKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1N0YXRpc3RpY2FsbHlTaWduaWZpY2FudDogZmFsc2UsXG4gICAgICAgIGNvbmZpZGVuY2VMZXZlbDogMCxcbiAgICAgICAgcmVjb21tZW5kZWRXaW5uZXI6IG51bGwsXG4gICAgICAgIGFuYWx5c2lzOiAnTmVlZCBhdCBsZWFzdCAyIHZhcmlhbnRzIGZvciBzdGF0aXN0aWNhbCBhbmFseXNpcydcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gR2V0IG1ldHJpYyBkYXRhIGZvciBhbGwgdmFyaWFudHNcbiAgICBjb25zdCB2YXJpYW50RGF0YSA9IHZhcmlhbnRzLm1hcCh2YXJpYW50ID0+ICh7XG4gICAgICBpZDogdmFyaWFudC5pZCxcbiAgICAgIG5hbWU6IHZhcmlhbnQubmFtZSxcbiAgICAgIHZhbHVlOiB2YXJpYW50LnJlc3VsdHNbd2lubmVyTWV0cmljXT8udmFsdWUgfHwgMCxcbiAgICAgIHNhbXBsZVNpemU6IHZhcmlhbnQucmVzdWx0c1t3aW5uZXJNZXRyaWNdPy5zYW1wbGVTaXplIHx8IDBcbiAgICB9KSkuZmlsdGVyKHYgPT4gdi5zYW1wbGVTaXplID4gMCk7XG5cbiAgICBpZiAodmFyaWFudERhdGEubGVuZ3RoIDwgMikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNTdGF0aXN0aWNhbGx5U2lnbmlmaWNhbnQ6IGZhbHNlLFxuICAgICAgICBjb25maWRlbmNlTGV2ZWw6IDAsXG4gICAgICAgIHJlY29tbWVuZGVkV2lubmVyOiBudWxsLFxuICAgICAgICBhbmFseXNpczogJ0luc3VmZmljaWVudCBkYXRhIGZvciBzdGF0aXN0aWNhbCBhbmFseXNpcydcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gRmluZCB0aGUgYmVzdCBwZXJmb3JtaW5nIHZhcmlhbnRcbiAgICBjb25zdCBiZXN0VmFyaWFudCA9IHZhcmlhbnREYXRhLnJlZHVjZSgoYmVzdCwgY3VycmVudCkgPT4gXG4gICAgICBjdXJyZW50LnZhbHVlID4gYmVzdC52YWx1ZSA/IGN1cnJlbnQgOiBiZXN0XG4gICAgKTtcblxuICAgIC8vIENhbGN1bGF0ZSBzdGF0aXN0aWNhbCBzaWduaWZpY2FuY2UgYWdhaW5zdCBjb250cm9sIChmaXJzdCB2YXJpYW50KVxuICAgIGNvbnN0IGNvbnRyb2wgPSB2YXJpYW50RGF0YVswXTtcbiAgICBjb25zdCB0cmVhdG1lbnQgPSBiZXN0VmFyaWFudC5pZCA9PT0gY29udHJvbC5pZCA/IHZhcmlhbnREYXRhWzFdIDogYmVzdFZhcmlhbnQ7XG5cbiAgICBjb25zdCBzaWduaWZpY2FuY2UgPSB0aGlzLmNhbGN1bGF0ZVR3b1NhbXBsZVRlc3QoXG4gICAgICBjb250cm9sLnZhbHVlLCBjb250cm9sLnNhbXBsZVNpemUsXG4gICAgICB0cmVhdG1lbnQudmFsdWUsIHRyZWF0bWVudC5zYW1wbGVTaXplXG4gICAgKTtcblxuICAgIHJldHVybiB7XG4gICAgICBpc1N0YXRpc3RpY2FsbHlTaWduaWZpY2FudDogc2lnbmlmaWNhbmNlLmlzU2lnbmlmaWNhbnQsXG4gICAgICBjb25maWRlbmNlTGV2ZWw6IHNpZ25pZmljYW5jZS5jb25maWRlbmNlTGV2ZWwsXG4gICAgICBwVmFsdWU6IHNpZ25pZmljYW5jZS5wVmFsdWUsXG4gICAgICByZWNvbW1lbmRlZFdpbm5lcjogc2lnbmlmaWNhbmNlLmlzU2lnbmlmaWNhbnQgPyB0cmVhdG1lbnQgOiBudWxsLFxuICAgICAgYW5hbHlzaXM6IHNpZ25pZmljYW5jZS5hbmFseXNpcyxcbiAgICAgIHZhcmlhbnRDb21wYXJpc29uczogdmFyaWFudERhdGEubWFwKHZhcmlhbnQgPT4gKHtcbiAgICAgICAgLi4udmFyaWFudCxcbiAgICAgICAgY29uZmlkZW5jZUludGVydmFsOiB0aGlzLmNhbGN1bGF0ZUNvbmZpZGVuY2VJbnRlcnZhbCh2YXJpYW50LnZhbHVlLCB2YXJpYW50LnNhbXBsZVNpemUpLFxuICAgICAgICBpc1dpbm5lcjogdmFyaWFudC5pZCA9PT0gdHJlYXRtZW50LmlkICYmIHNpZ25pZmljYW5jZS5pc1NpZ25pZmljYW50XG4gICAgICB9KSlcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFR3by1zYW1wbGUgc3RhdGlzdGljYWwgdGVzdFxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVUd29TYW1wbGVUZXN0KHZhbHVlMTogbnVtYmVyLCBuMTogbnVtYmVyLCB2YWx1ZTI6IG51bWJlciwgbjI6IG51bWJlcik6IGFueSB7XG4gICAgY29uc3QgcDEgPSB2YWx1ZTEgLyAxMDA7XG4gICAgY29uc3QgcDIgPSB2YWx1ZTIgLyAxMDA7XG4gICAgXG4gICAgLy8gUG9vbCBwcm9wb3J0aW9uIGZvciB0ZXN0XG4gICAgY29uc3QgcG9vbGVkUCA9IChwMSAqIG4xICsgcDIgKiBuMikgLyAobjEgKyBuMik7XG4gICAgY29uc3Qgc3RhbmRhcmRFcnJvciA9IE1hdGguc3FydChwb29sZWRQICogKDEgLSBwb29sZWRQKSAqICgxL24xICsgMS9uMikpO1xuICAgIFxuICAgIGNvbnN0IHpTY29yZSA9IE1hdGguYWJzKHAxIC0gcDIpIC8gc3RhbmRhcmRFcnJvcjtcbiAgICBjb25zdCBwVmFsdWUgPSAyICogKDEgLSB0aGlzLm5vcm1hbENERihNYXRoLmFicyh6U2NvcmUpKSk7XG4gICAgXG4gICAgY29uc3QgaXNTaWduaWZpY2FudCA9IHBWYWx1ZSA8IDAuMDU7XG4gICAgY29uc3QgY29uZmlkZW5jZUxldmVsID0gKDEgLSBwVmFsdWUpICogMTAwO1xuICAgIFxuICAgIGNvbnN0IGltcHJvdmVtZW50ID0gKChNYXRoLm1heChwMSwgcDIpIC0gTWF0aC5taW4ocDEsIHAyKSkgLyBNYXRoLm1pbihwMSwgcDIpKSAqIDEwMDtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgaXNTaWduaWZpY2FudCxcbiAgICAgIGNvbmZpZGVuY2VMZXZlbDogTWF0aC5yb3VuZChjb25maWRlbmNlTGV2ZWwgKiAxMDApIC8gMTAwLFxuICAgICAgcFZhbHVlOiBNYXRoLnJvdW5kKHBWYWx1ZSAqIDEwMDApIC8gMTAwMCxcbiAgICAgIHpTY29yZTogTWF0aC5yb3VuZCh6U2NvcmUgKiAxMDApIC8gMTAwLFxuICAgICAgaW1wcm92ZW1lbnQ6IE1hdGgucm91bmQoaW1wcm92ZW1lbnQgKiAxMDApIC8gMTAwLFxuICAgICAgYW5hbHlzaXM6IGlzU2lnbmlmaWNhbnQgXG4gICAgICAgID8gYFN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQgZGlmZmVyZW5jZSBkZXRlY3RlZCAocD0ke3BWYWx1ZS50b0ZpeGVkKDMpfSwgaW1wcm92ZW1lbnQ9JHtpbXByb3ZlbWVudC50b0ZpeGVkKDEpfSUpYFxuICAgICAgICA6IGBObyBzaWduaWZpY2FudCBkaWZmZXJlbmNlIChwPSR7cFZhbHVlLnRvRml4ZWQoMyl9KS4gQ29uc2lkZXIgbG9uZ2VyIHRlc3QgZHVyYXRpb24uYFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogTm9ybWFsIGN1bXVsYXRpdmUgZGlzdHJpYnV0aW9uIGZ1bmN0aW9uIGFwcHJveGltYXRpb25cbiAgICovXG4gIHByaXZhdGUgbm9ybWFsQ0RGKHg6IG51bWJlcik6IG51bWJlciB7XG4gICAgLy8gQWJyYW1vd2l0eiBhbmQgU3RlZ3VuIGFwcHJveGltYXRpb25cbiAgICBjb25zdCB0ID0gMSAvICgxICsgMC4yMzE2NDE5ICogTWF0aC5hYnMoeCkpO1xuICAgIGNvbnN0IGQgPSAwLjM5ODk0MjMgKiBNYXRoLmV4cCgteCAqIHggLyAyKTtcbiAgICBsZXQgcHJvYiA9IGQgKiB0ICogKDAuMzE5MzgxNSArIHQgKiAoLTAuMzU2NTYzOCArIHQgKiAoMS43ODE0NzggKyB0ICogKC0xLjgyMTI1NiArIHQgKiAxLjMzMDI3NCkpKSk7XG4gICAgXG4gICAgaWYgKHggPiAwKSB7XG4gICAgICBwcm9iID0gMSAtIHByb2I7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBwcm9iO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGluc2lnaHRzIGZvciBBL0IgdGVzdCByZXN1bHRzXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlQUJUZXN0SW5zaWdodHModmFyaWFudHM6IGFueVtdLCBzdGF0aXN0aWNhbEFuYWx5c2lzOiBhbnksIHdpbm5lck1ldHJpYzogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGluc2lnaHRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIFxuICAgIGlmICh2YXJpYW50cy5sZW5ndGggPCAyKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKFwiQWRkIG1vcmUgdmFyaWFudHMgdG8gZW5hYmxlIEEvQiB0ZXN0aW5nIGFuYWx5c2lzXCIpO1xuICAgICAgcmV0dXJuIGluc2lnaHRzO1xuICAgIH1cblxuICAgIC8vIFBlcmZvcm1hbmNlIGluc2lnaHRzXG4gICAgY29uc3QgdmFsdWVzID0gdmFyaWFudHMubWFwKHYgPT4gdi5yZXN1bHRzW3dpbm5lck1ldHJpY10/LnZhbHVlIHx8IDApO1xuICAgIGNvbnN0IGJlc3QgPSBNYXRoLm1heCguLi52YWx1ZXMpO1xuICAgIGNvbnN0IHdvcnN0ID0gTWF0aC5taW4oLi4udmFsdWVzKTtcbiAgICBcbiAgICBpZiAoYmVzdCA+IHdvcnN0KSB7XG4gICAgICBjb25zdCBiZXN0VmFyaWFudCA9IHZhcmlhbnRzLmZpbmQodiA9PiAodi5yZXN1bHRzW3dpbm5lck1ldHJpY10/LnZhbHVlIHx8IDApID09PSBiZXN0KTtcbiAgICAgIGNvbnN0IGltcHJvdmVtZW50ID0gKChiZXN0IC0gd29yc3QpIC8gd29yc3QpICogMTAwO1xuICAgICAgaW5zaWdodHMucHVzaChgQmVzdCB2YXJpYW50ICgke2Jlc3RWYXJpYW50Py5uYW1lfSkgc2hvd3MgJHtpbXByb3ZlbWVudC50b0ZpeGVkKDEpfSUgaW1wcm92ZW1lbnQgb3ZlciB3b3JzdCBwZXJmb3JtZXJgKTtcbiAgICB9XG5cbiAgICAvLyBTdGF0aXN0aWNhbCBzaWduaWZpY2FuY2UgaW5zaWdodHNcbiAgICBpZiAoc3RhdGlzdGljYWxBbmFseXNpcy5pc1N0YXRpc3RpY2FsbHlTaWduaWZpY2FudCkge1xuICAgICAgaW5zaWdodHMucHVzaChgUmVzdWx0cyBhcmUgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCAocD0ke3N0YXRpc3RpY2FsQW5hbHlzaXMucFZhbHVlfSkgLSBzYWZlIHRvIGltcGxlbWVudCB3aW5uZXJgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5zaWdodHMucHVzaChcIlJlc3VsdHMgbm90IHlldCBzdGF0aXN0aWNhbGx5IHNpZ25pZmljYW50IC0gY29udGludWUgdGVzdGluZyBmb3IgbW9yZSByZWxpYWJsZSBkYXRhXCIpO1xuICAgIH1cblxuICAgIC8vIFNhbXBsZSBzaXplIGluc2lnaHRzXG4gICAgY29uc3QgdG90YWxTYW1wbGVzID0gdmFyaWFudHMucmVkdWNlKChzdW0sIHYpID0+IHN1bSArICh2LnJlc3VsdHNbd2lubmVyTWV0cmljXT8uc2FtcGxlU2l6ZSB8fCAwKSwgMCk7XG4gICAgaWYgKHRvdGFsU2FtcGxlcyA8IDEwMDApIHtcbiAgICAgIGluc2lnaHRzLnB1c2goXCJTYW1wbGUgc2l6ZSBpcyByZWxhdGl2ZWx5IHNtYWxsIC0gY29uc2lkZXIgcnVubmluZyB0ZXN0IGxvbmdlciBmb3IgbW9yZSBjb25maWRlbmNlXCIpO1xuICAgIH1cblxuICAgIC8vIFRyYWZmaWMgZGlzdHJpYnV0aW9uIGluc2lnaHRzXG4gICAgY29uc3QgdHJhZmZpY0JhbGFuY2UgPSBNYXRoLm1heCguLi52YXJpYW50cy5tYXAodiA9PiB2LnRyYWZmaWNQZXJjZW50KSkgLSBNYXRoLm1pbiguLi52YXJpYW50cy5tYXAodiA9PiB2LnRyYWZmaWNQZXJjZW50KSk7XG4gICAgaWYgKHRyYWZmaWNCYWxhbmNlID4gMTApIHtcbiAgICAgIGluc2lnaHRzLnB1c2goXCJDb25zaWRlciBiYWxhbmNpbmcgdHJhZmZpYyBkaXN0cmlidXRpb24gbW9yZSBldmVubHkgYmV0d2VlbiB2YXJpYW50c1wiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zaWdodHM7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHJlYWwgY2FtcGFpZ24gY29zdCB1c2luZyBNZXNzYWdpbmdVc2FnZSBkYXRhXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNhbGN1bGF0ZVJlYWxDYW1wYWlnbkNvc3QoY2FtcGFpZ25JZDogc3RyaW5nLCBvcmdhbml6YXRpb25JZDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXIgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCBtZXNzYWdpbmcgdXNhZ2UgZm9yIHRoaXMgY2FtcGFpZ25cbiAgICAgIGNvbnN0IG1lc3NhZ2luZ1VzYWdlID0gYXdhaXQgcHJpc21hLm1lc3NhZ2luZ1VzYWdlLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBjYW1wYWlnbklkLFxuICAgICAgICAgIG9yZ2FuaXphdGlvbklkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAobWVzc2FnaW5nVXNhZ2UubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBudWxsOyAvLyBObyB1c2FnZSBkYXRhIGZvdW5kXG4gICAgICB9XG5cbiAgICAgIC8vIENhbGN1bGF0ZSB0b3RhbCBjb3N0IGZyb20gY3JlZGl0cyB1c2VkXG4gICAgICBjb25zdCB0b3RhbENyZWRpdHMgPSBtZXNzYWdpbmdVc2FnZS5yZWR1Y2UoKHN1bSwgdXNhZ2UpID0+IHN1bSArIHVzYWdlLmNyZWRpdHMsIDApO1xuICAgICAgXG4gICAgICAvLyBHZXQgY3JlZGl0IGNvc3QgcmF0ZSBmcm9tIHJlY2VudCBjcmVkaXQgdHJhbnNhY3Rpb25zXG4gICAgICBjb25zdCBjcmVkaXRDb3N0UmF0ZSA9IGF3YWl0IHRoaXMuZ2V0Q3JlZGl0Q29zdFJhdGUob3JnYW5pemF0aW9uSWQpO1xuICAgICAgXG4gICAgICByZXR1cm4gdG90YWxDcmVkaXRzICogY3JlZGl0Q29zdFJhdGU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNhbGN1bGF0ZSByZWFsIGNhbXBhaWduIGNvc3Q6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY29zdCByYXRlIHBlciBjcmVkaXQgZnJvbSByZWNlbnQgY3JlZGl0IHB1cmNoYXNlc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRDcmVkaXRDb3N0UmF0ZShvcmdhbml6YXRpb25JZDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IHJlY2VudCBjcmVkaXQgcHVyY2hhc2VzIHRvIGRldGVybWluZSBjb3N0IHBlciBjcmVkaXRcbiAgICAgIGNvbnN0IHJlY2VudFB1cmNoYXNlcyA9IGF3YWl0IHByaXNtYS5jcmVkaXRUcmFuc2FjdGlvbi5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQsXG4gICAgICAgICAgdHlwZTogJ3B1cmNoYXNlJyxcbiAgICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxuICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgZ3RlOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gOTAgKiAyNCAqIDYwICogNjAgKiAxMDAwKSAvLyBMYXN0IDkwIGRheXNcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xuICAgICAgICB9LFxuICAgICAgICB0YWtlOiAxMFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChyZWNlbnRQdXJjaGFzZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiAwLjAwMTsgLy8gRGVmYXVsdCByYXRlIG9mICQwLjAwMSBwZXIgY3JlZGl0XG4gICAgICB9XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBhdmVyYWdlIGNvc3QgcGVyIGNyZWRpdCBmcm9tIHJlY2VudCBwdXJjaGFzZXNcbiAgICAgIGNvbnN0IHRvdGFsQW1vdW50ID0gcmVjZW50UHVyY2hhc2VzLnJlZHVjZSgoc3VtLCB0eCkgPT4gc3VtICsgdHguYW1vdW50LCAwKTtcbiAgICAgIGNvbnN0IHRvdGFsQ3JlZGl0cyA9IHJlY2VudFB1cmNoYXNlcy5yZWR1Y2UoKHN1bSwgdHgpID0+IHtcbiAgICAgICAgLy8gRXh0cmFjdCBjcmVkaXRzIGZyb20gbWV0YWRhdGEgb3IgZGVzY3JpcHRpb25cbiAgICAgICAgY29uc3QgbWV0YWRhdGEgPSB0eC5tZXRhZGF0YSBhcyBhbnk7XG4gICAgICAgIHJldHVybiBzdW0gKyAobWV0YWRhdGE/LmNyZWRpdHMgfHwgMTAwMCk7IC8vIERlZmF1bHQgMTAwMCBjcmVkaXRzIHBlciBwdXJjaGFzZVxuICAgICAgfSwgMCk7XG5cbiAgICAgIHJldHVybiB0b3RhbENyZWRpdHMgPiAwID8gdG90YWxBbW91bnQgLyB0b3RhbENyZWRpdHMgOiAwLjAwMTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY2FsY3VsYXRlIGNyZWRpdCBjb3N0IHJhdGU6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIDAuMDAxOyAvLyBGYWxsYmFjayByYXRlXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBkZXRhaWxlZCByZXZlbnVlIGF0dHJpYnV0aW9uIGZvciBhIGNhbXBhaWduXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNhbGN1bGF0ZVJldmVudWVBdHRyaWJ1dGlvbihjYW1wYWlnbklkOiBzdHJpbmcsIG9yZ2FuaXphdGlvbklkOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAvLyBHZXQgbWVzc2FnaW5nIHVzYWdlIGJyZWFrZG93blxuICAgICAgY29uc3QgbWVzc2FnaW5nVXNhZ2UgPSBhd2FpdCBwcmlzbWEubWVzc2FnaW5nVXNhZ2UuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIGNhbXBhaWduSWQsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGNoYW5uZWxCcmVha2Rvd24gPSBtZXNzYWdpbmdVc2FnZS5yZWR1Y2UoKGFjYzogUmVjb3JkPHN0cmluZywgYW55PiwgdXNhZ2UpID0+IHtcbiAgICAgICAgaWYgKCFhY2NbdXNhZ2UuY2hhbm5lbF0pIHtcbiAgICAgICAgICBhY2NbdXNhZ2UuY2hhbm5lbF0gPSB7XG4gICAgICAgICAgICBtZXNzYWdlQ291bnQ6IDAsXG4gICAgICAgICAgICBjcmVkaXRzOiAwLFxuICAgICAgICAgICAgY29zdDogMCxcbiAgICAgICAgICAgIHByb3ZpZGVyOiB1c2FnZS5wcm92aWRlclxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgYWNjW3VzYWdlLmNoYW5uZWxdLm1lc3NhZ2VDb3VudCArPSB1c2FnZS5tZXNzYWdlQ291bnQ7XG4gICAgICAgIGFjY1t1c2FnZS5jaGFubmVsXS5jcmVkaXRzICs9IHVzYWdlLmNyZWRpdHM7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9LCB7fSk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBjb3N0IHBlciBjaGFubmVsXG4gICAgICBjb25zdCBjcmVkaXRDb3N0UmF0ZSA9IGF3YWl0IHRoaXMuZ2V0Q3JlZGl0Q29zdFJhdGUob3JnYW5pemF0aW9uSWQpO1xuICAgICAgZm9yIChjb25zdCBjaGFubmVsIG9mIE9iamVjdC5rZXlzKGNoYW5uZWxCcmVha2Rvd24pKSB7XG4gICAgICAgIGNoYW5uZWxCcmVha2Rvd25bY2hhbm5lbF0uY29zdCA9IGNoYW5uZWxCcmVha2Rvd25bY2hhbm5lbF0uY3JlZGl0cyAqIGNyZWRpdENvc3RSYXRlO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgY2FtcGFpZ24gcmV2ZW51ZSBkYXRhIGZyb20gTUNQIG1ldHJpY3NcbiAgICAgIGNvbnN0IGNhbXBhaWduTWV0cmljID0gYXdhaXQgcHJpc21hLm1DUENhbXBhaWduTWV0cmljcy5maW5kRmlyc3Qoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIGNhbXBhaWduSWQsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWRcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHRvdGFsUmV2ZW51ZSA9IGNhbXBhaWduTWV0cmljPy5yZXZlbnVlIHx8IDA7XG4gICAgICBjb25zdCB0b3RhbENvc3QgPSBPYmplY3QudmFsdWVzKGNoYW5uZWxCcmVha2Rvd24pLnJlZHVjZSgoc3VtOiBudW1iZXIsIGNoYW5uZWw6IGFueSkgPT4gc3VtICsgY2hhbm5lbC5jb3N0LCAwKTtcbiAgICAgIGNvbnN0IG5ldFByb2ZpdCA9IHRvdGFsUmV2ZW51ZSAtIHRvdGFsQ29zdDtcbiAgICAgIGNvbnN0IHJvaSA9IHRvdGFsQ29zdCA+IDAgPyAobmV0UHJvZml0IC8gdG90YWxDb3N0KSAqIDEwMCA6IDA7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBhdHRyaWJ1dGlvbiBieSBjaGFubmVsIGJhc2VkIG9uIG1lc3NhZ2Ugdm9sdW1lXG4gICAgICBjb25zdCB0b3RhbE1lc3NhZ2VzID0gT2JqZWN0LnZhbHVlcyhjaGFubmVsQnJlYWtkb3duKS5yZWR1Y2UoKHN1bTogbnVtYmVyLCBjaGFubmVsOiBhbnkpID0+IHN1bSArIGNoYW5uZWwubWVzc2FnZUNvdW50LCAwKTtcbiAgICAgIFxuICAgICAgY29uc3QgY2hhbm5lbEF0dHJpYnV0aW9uID0gT2JqZWN0LmtleXMoY2hhbm5lbEJyZWFrZG93bikucmVkdWNlKChhY2M6IFJlY29yZDxzdHJpbmcsIGFueT4sIGNoYW5uZWwpID0+IHtcbiAgICAgICAgY29uc3QgY2hhbm5lbERhdGEgPSBjaGFubmVsQnJlYWtkb3duW2NoYW5uZWxdO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGlvblJhdGlvID0gdG90YWxNZXNzYWdlcyA+IDAgPyBjaGFubmVsRGF0YS5tZXNzYWdlQ291bnQgLyB0b3RhbE1lc3NhZ2VzIDogMDtcbiAgICAgICAgXG4gICAgICAgIGFjY1tjaGFubmVsXSA9IHtcbiAgICAgICAgICAuLi5jaGFubmVsRGF0YSxcbiAgICAgICAgICBhdHRyaWJ1dGVkUmV2ZW51ZTogdG90YWxSZXZlbnVlICogYXR0cmlidXRpb25SYXRpbyxcbiAgICAgICAgICByZXZlbnVlU2hhcmU6IGF0dHJpYnV0aW9uUmF0aW8gKiAxMDAsXG4gICAgICAgICAgY2hhbm5lbFJPSTogY2hhbm5lbERhdGEuY29zdCA+IDAgPyAoKHRvdGFsUmV2ZW51ZSAqIGF0dHJpYnV0aW9uUmF0aW8gLSBjaGFubmVsRGF0YS5jb3N0KSAvIGNoYW5uZWxEYXRhLmNvc3QpICogMTAwIDogMFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSwge30pO1xuXG4gICAgICAvLyBQZXJmb3JtYW5jZSBtZXRyaWNzXG4gICAgICBjb25zdCBjb3N0UGVyTWVzc2FnZSA9IHRvdGFsTWVzc2FnZXMgPiAwID8gdG90YWxDb3N0IC8gdG90YWxNZXNzYWdlcyA6IDA7XG4gICAgICBjb25zdCByZXZlbnVlUGVyTWVzc2FnZSA9IHRvdGFsTWVzc2FnZXMgPiAwID8gdG90YWxSZXZlbnVlIC8gdG90YWxNZXNzYWdlcyA6IDA7XG4gICAgICBjb25zdCBjb252ZXJzaW9uVmFsdWUgPSBjYW1wYWlnbk1ldHJpYz8uY29udmVydGVkIHx8IDA7XG4gICAgICBjb25zdCBjb3N0UGVyQ29udmVyc2lvbiA9IGNvbnZlcnNpb25WYWx1ZSA+IDAgPyB0b3RhbENvc3QgLyBjb252ZXJzaW9uVmFsdWUgOiAwO1xuXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1bW1hcnk6IHtcbiAgICAgICAgICB0b3RhbFJldmVudWU6IE1hdGgucm91bmQodG90YWxSZXZlbnVlICogMTAwKSAvIDEwMCxcbiAgICAgICAgICB0b3RhbENvc3Q6IE1hdGgucm91bmQodG90YWxDb3N0ICogMTAwKSAvIDEwMCxcbiAgICAgICAgICBuZXRQcm9maXQ6IE1hdGgucm91bmQobmV0UHJvZml0ICogMTAwKSAvIDEwMCxcbiAgICAgICAgICByb2k6IE1hdGgucm91bmQocm9pICogMTAwKSAvIDEwMCxcbiAgICAgICAgICB0b3RhbE1lc3NhZ2VzLFxuICAgICAgICAgIGNvc3RQZXJNZXNzYWdlOiBNYXRoLnJvdW5kKGNvc3RQZXJNZXNzYWdlICogMTAwMDApIC8gMTAwMDAsXG4gICAgICAgICAgcmV2ZW51ZVBlck1lc3NhZ2U6IE1hdGgucm91bmQocmV2ZW51ZVBlck1lc3NhZ2UgKiAxMDApIC8gMTAwLFxuICAgICAgICAgIGNvc3RQZXJDb252ZXJzaW9uOiBNYXRoLnJvdW5kKGNvc3RQZXJDb252ZXJzaW9uICogMTAwKSAvIDEwMFxuICAgICAgICB9LFxuICAgICAgICBjaGFubmVsQXR0cmlidXRpb24sXG4gICAgICAgIGluc2lnaHRzOiB0aGlzLmdlbmVyYXRlUmV2ZW51ZUF0dHJpYnV0aW9uSW5zaWdodHMoY2hhbm5lbEF0dHJpYnV0aW9uLCB7XG4gICAgICAgICAgdG90YWxSZXZlbnVlLFxuICAgICAgICAgIHRvdGFsQ29zdCxcbiAgICAgICAgICByb2ksXG4gICAgICAgICAgdG90YWxNZXNzYWdlc1xuICAgICAgICB9KSxcbiAgICAgICAgY2FsY3VsYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGNhbGN1bGF0aW9uRHVyYXRpb246IGR1cmF0aW9uLFxuICAgICAgICBjcmVkaXRDb3N0UmF0ZVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY2FsY3VsYXRlIHJldmVudWUgYXR0cmlidXRpb246JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VtbWFyeToge1xuICAgICAgICAgIHRvdGFsUmV2ZW51ZTogMCxcbiAgICAgICAgICB0b3RhbENvc3Q6IDAsXG4gICAgICAgICAgbmV0UHJvZml0OiAwLFxuICAgICAgICAgIHJvaTogMCxcbiAgICAgICAgICB0b3RhbE1lc3NhZ2VzOiAwLFxuICAgICAgICAgIGNvc3RQZXJNZXNzYWdlOiAwLFxuICAgICAgICAgIHJldmVudWVQZXJNZXNzYWdlOiAwLFxuICAgICAgICAgIGNvc3RQZXJDb252ZXJzaW9uOiAwXG4gICAgICAgIH0sXG4gICAgICAgIGNoYW5uZWxBdHRyaWJ1dGlvbjoge30sXG4gICAgICAgIGluc2lnaHRzOiBbJ1JldmVudWUgYXR0cmlidXRpb24gZGF0YSB1bmF2YWlsYWJsZSddLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGluc2lnaHRzIGZvciByZXZlbnVlIGF0dHJpYnV0aW9uXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlUmV2ZW51ZUF0dHJpYnV0aW9uSW5zaWdodHMoY2hhbm5lbEF0dHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBzdW1tYXJ5OiBhbnkpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaW5zaWdodHM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgY2hhbm5lbHMgPSBPYmplY3Qua2V5cyhjaGFubmVsQXR0cmlidXRpb24pO1xuXG4gICAgaWYgKGNoYW5uZWxzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgaW5zaWdodHMucHVzaCgnTm8gY2hhbm5lbCBhdHRyaWJ1dGlvbiBkYXRhIGF2YWlsYWJsZScpO1xuICAgICAgcmV0dXJuIGluc2lnaHRzO1xuICAgIH1cblxuICAgIC8vIEZpbmQgYmVzdCBwZXJmb3JtaW5nIGNoYW5uZWwgYnkgUk9JXG4gICAgY29uc3QgYmVzdFJPSUNoYW5uZWwgPSBjaGFubmVscy5yZWR1Y2UoKGJlc3QsIGN1cnJlbnQpID0+IHtcbiAgICAgIHJldHVybiBjaGFubmVsQXR0cmlidXRpb25bY3VycmVudF0uY2hhbm5lbFJPSSA+IGNoYW5uZWxBdHRyaWJ1dGlvbltiZXN0XS5jaGFubmVsUk9JID8gY3VycmVudCA6IGJlc3Q7XG4gICAgfSk7XG5cbiAgICBpZiAoY2hhbm5lbEF0dHJpYnV0aW9uW2Jlc3RST0lDaGFubmVsXS5jaGFubmVsUk9JID4gMCkge1xuICAgICAgaW5zaWdodHMucHVzaChgJHtiZXN0Uk9JQ2hhbm5lbC50b1VwcGVyQ2FzZSgpfSBzaG93cyBoaWdoZXN0IFJPSSBhdCAke2NoYW5uZWxBdHRyaWJ1dGlvbltiZXN0Uk9JQ2hhbm5lbF0uY2hhbm5lbFJPSS50b0ZpeGVkKDEpfSVgKTtcbiAgICB9XG5cbiAgICAvLyBGaW5kIGNoYW5uZWwgd2l0aCBoaWdoZXN0IHJldmVudWUgc2hhcmVcbiAgICBjb25zdCB0b3BSZXZlbnVlQ2hhbm5lbCA9IGNoYW5uZWxzLnJlZHVjZSgoYmVzdCwgY3VycmVudCkgPT4ge1xuICAgICAgcmV0dXJuIGNoYW5uZWxBdHRyaWJ1dGlvbltjdXJyZW50XS5hdHRyaWJ1dGVkUmV2ZW51ZSA+IGNoYW5uZWxBdHRyaWJ1dGlvbltiZXN0XS5hdHRyaWJ1dGVkUmV2ZW51ZSA/IGN1cnJlbnQgOiBiZXN0O1xuICAgIH0pO1xuXG4gICAgaWYgKGNoYW5uZWxBdHRyaWJ1dGlvblt0b3BSZXZlbnVlQ2hhbm5lbF0ucmV2ZW51ZVNoYXJlID4gMzApIHtcbiAgICAgIGluc2lnaHRzLnB1c2goYCR7dG9wUmV2ZW51ZUNoYW5uZWwudG9VcHBlckNhc2UoKX0gZ2VuZXJhdGVzICR7Y2hhbm5lbEF0dHJpYnV0aW9uW3RvcFJldmVudWVDaGFubmVsXS5yZXZlbnVlU2hhcmUudG9GaXhlZCgxKX0lIG9mIHRvdGFsIHJldmVudWVgKTtcbiAgICB9XG5cbiAgICAvLyBDb3N0IGVmZmljaWVuY3kgaW5zaWdodHNcbiAgICBjb25zdCBhdmdDb3N0UGVyTWVzc2FnZSA9IHN1bW1hcnkudG90YWxDb3N0IC8gc3VtbWFyeS50b3RhbE1lc3NhZ2VzO1xuICAgIGNvbnN0IGVmZmljaWVudENoYW5uZWxzID0gY2hhbm5lbHMuZmlsdGVyKGNoYW5uZWwgPT4ge1xuICAgICAgY29uc3QgY29zdFBlck1zZyA9IGNoYW5uZWxBdHRyaWJ1dGlvbltjaGFubmVsXS5jb3N0IC8gY2hhbm5lbEF0dHJpYnV0aW9uW2NoYW5uZWxdLm1lc3NhZ2VDb3VudDtcbiAgICAgIHJldHVybiBjb3N0UGVyTXNnIDwgYXZnQ29zdFBlck1lc3NhZ2U7XG4gICAgfSk7XG5cbiAgICBpZiAoZWZmaWNpZW50Q2hhbm5lbHMubGVuZ3RoID4gMCkge1xuICAgICAgaW5zaWdodHMucHVzaChgTW9zdCBjb3N0LWVmZmljaWVudCBjaGFubmVsczogJHtlZmZpY2llbnRDaGFubmVscy5tYXAoYyA9PiBjLnRvVXBwZXJDYXNlKCkpLmpvaW4oJywgJyl9YCk7XG4gICAgfVxuXG4gICAgLy8gT3ZlcmFsbCBwcm9maXRhYmlsaXR5XG4gICAgaWYgKHN1bW1hcnkucm9pID4gMTAwKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKGBFeGNlbGxlbnQgY2FtcGFpZ24gcHJvZml0YWJpbGl0eSB3aXRoICR7c3VtbWFyeS5yb2kudG9GaXhlZCgxKX0lIFJPSWApO1xuICAgIH0gZWxzZSBpZiAoc3VtbWFyeS5yb2kgPiAwKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKGBDYW1wYWlnbiBpcyBwcm9maXRhYmxlIGJ1dCBjb3VsZCBiZSBvcHRpbWl6ZWQgKCR7c3VtbWFyeS5yb2kudG9GaXhlZCgxKX0lIFJPSSlgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5zaWdodHMucHVzaCgnQ2FtcGFpZ24gbmVlZHMgb3B0aW1pemF0aW9uIC0gY3VycmVudGx5IG9wZXJhdGluZyBhdCBhIGxvc3MnKTtcbiAgICB9XG5cbiAgICAvLyBNdWx0aS1jaGFubmVsIHBlcmZvcm1hbmNlXG4gICAgaWYgKGNoYW5uZWxzLmxlbmd0aCA+IDEpIHtcbiAgICAgIGNvbnN0IGNoYW5uZWxWYXJpYW5jZSA9IHRoaXMuY2FsY3VsYXRlQ2hhbm5lbFJPSVZhcmlhbmNlKGNoYW5uZWxBdHRyaWJ1dGlvbik7XG4gICAgICBpZiAoY2hhbm5lbFZhcmlhbmNlID4gNTApIHtcbiAgICAgICAgaW5zaWdodHMucHVzaCgnU2lnbmlmaWNhbnQgcGVyZm9ybWFuY2UgdmFyaWFuY2UgYmV0d2VlbiBjaGFubmVscyAtIGNvbnNpZGVyIHJlYWxsb2NhdGluZyBidWRnZXQnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaW5zaWdodHM7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHZhcmlhbmNlIGluIFJPSSBiZXR3ZWVuIGNoYW5uZWxzXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZUNoYW5uZWxST0lWYXJpYW5jZShjaGFubmVsQXR0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIGFueT4pOiBudW1iZXIge1xuICAgIGNvbnN0IHJvaXMgPSBPYmplY3QudmFsdWVzKGNoYW5uZWxBdHRyaWJ1dGlvbikubWFwKChjaGFubmVsOiBhbnkpID0+IGNoYW5uZWwuY2hhbm5lbFJPSSk7XG4gICAgaWYgKHJvaXMubGVuZ3RoIDwgMikgcmV0dXJuIDA7XG5cbiAgICBjb25zdCBtZWFuID0gcm9pcy5yZWR1Y2UoKHN1bSwgcm9pKSA9PiBzdW0gKyByb2ksIDApIC8gcm9pcy5sZW5ndGg7XG4gICAgY29uc3QgdmFyaWFuY2UgPSByb2lzLnJlZHVjZSgoc3VtLCByb2kpID0+IHN1bSArIE1hdGgucG93KHJvaSAtIG1lYW4sIDIpLCAwKSAvIHJvaXMubGVuZ3RoO1xuICAgIFxuICAgIHJldHVybiBNYXRoLnNxcnQodmFyaWFuY2UpOyAvLyBTdGFuZGFyZCBkZXZpYXRpb25cbiAgfVxufSJdLCJuYW1lcyI6WyJDYW1wYWlnbkFuYWx5dGljc01DUFNlcnZlciIsIkJhc2VNQ1BTZXJ2ZXIiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsImRlZmF1bHRNQ1BDb25maWciLCJzZXJ2ZXJzIiwiY2FtcGFpZ24iLCJsaXN0UmVzb3VyY2VzIiwiYXV0aENvbnRleHQiLCJyZXNvdXJjZXMiLCJ1cmkiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJtaW1lVHlwZSIsInBlcm1pc3Npb25zIiwiaW5jbHVkZXMiLCJmaWx0ZXIiLCJyIiwicmVhZFJlc291cmNlIiwidXJsIiwiVVJMIiwicGF0aCIsInBhdGhuYW1lIiwic2VhcmNoUGFyYW1zIiwicXVlcnlQYXJhbXMiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsImVudHJpZXMiLCJ2YWxpZGF0ZWRRdWVyeSIsIkNhbXBhaWduQW5hbHl0aWNzUXVlcnlTY2hlbWEiLCJwYXJzZSIsIm9yZ2FuaXphdGlvbklkIiwibGltaXQiLCJOdW1iZXIiLCJwYXJzZUludCIsIm9mZnNldCIsImluY2x1ZGVBQlRlc3RzIiwiZ2V0Q2FtcGFpZ25BbmFseXRpY3MiLCJnZXRDYW1wYWlnblBlcmZvcm1hbmNlIiwiZ2V0QUJUZXN0UmVzdWx0cyIsImdldENhbXBhaWduSW5zaWdodHMiLCJNQ1BWYWxpZGF0aW9uRXJyb3IiLCJsaXN0VG9vbHMiLCJ0b29scyIsImlucHV0U2NoZW1hIiwidHlwZSIsInByb3BlcnRpZXMiLCJjYW1wYWlnbklkIiwiZGVmYXVsdCIsImRhdGVSYW5nZSIsImVudW0iLCJyZXF1aXJlZCIsImNhbXBhaWduSWRzIiwiaXRlbXMiLCJtaW5JdGVtcyIsIm1heEl0ZW1zIiwibWV0cmljcyIsIm1ldHJpYyIsIm1pbmltdW0iLCJtYXhpbXVtIiwiY2FtcGFpZ25UeXBlIiwicGVyaW9kIiwidCIsImNhbGxUb29sIiwiYXJncyIsImdldENhbXBhaWduTWV0cmljcyIsImNvbXBhcmVDYW1wYWlnbnMiLCJnZXRUb3BQZXJmb3JtaW5nQ2FtcGFpZ25zIiwiYW5hbHl6ZUNhbXBhaWduVHJlbmRzIiwicXVlcnkiLCJzdGFydFRpbWUiLCJEYXRlIiwibm93Iiwid2hlcmVDbGF1c2UiLCJkYXRlRnJvbSIsImRhdGVUbyIsImNhbGN1bGF0ZWRBdCIsImd0ZSIsImx0ZSIsImNhbXBhaWduTWV0cmljcyIsInByaXNtYSIsIm1DUENhbXBhaWduTWV0cmljcyIsImZpbmRNYW55Iiwid2hlcmUiLCJ0YWtlIiwic2tpcCIsImluY2x1ZGUiLCJvcmdhbml6YXRpb24iLCJzZWxlY3QiLCJpZCIsIm9yZGVyQnkiLCJjYW1wYWlnbnMiLCJtYXAiLCJhbmFseXRpY3MiLCJjYW1wYWlnbk5hbWUiLCJwZXJmb3JtYW5jZSIsInNlbnQiLCJkZWxpdmVyZWQiLCJvcGVuZWQiLCJjbGlja2VkIiwiY29udmVydGVkIiwiYm91bmNlZCIsInVuc3Vic2NyaWJlZCIsIm9wZW5SYXRlIiwiY2xpY2tSYXRlIiwiY29udmVyc2lvblJhdGUiLCJyZXZlbnVlIiwiYWJUZXN0cyIsImFiVGVzdFZhcmlhbnRzIiwidmFyaWFudHMiLCJ1bmRlZmluZWQiLCJjcmVhdGVkQXQiLCJ0b0lTT1N0cmluZyIsInVwZGF0ZWRBdCIsInRvdGFsQ2FtcGFpZ25zIiwibGVuZ3RoIiwidG90YWxTZW50IiwicmVkdWNlIiwic3VtIiwiYyIsInRvdGFsUmV2ZW51ZSIsImF2Z09wZW5SYXRlIiwiYXZnQ2xpY2tSYXRlIiwiYXZnQ29udmVyc2lvblJhdGUiLCJjaGFubmVsRGlzdHJpYnV0aW9uIiwiYWNjIiwiZHVyYXRpb24iLCJsb2dNQ1BSZXNvdXJjZUFjY2VzcyIsImRhdGFTaXplIiwidGV4dCIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdW1tYXJ5IiwiYXZlcmFnZU1ldHJpY3MiLCJNYXRoIiwicm91bmQiLCJtZXRhIiwidG90YWwiLCJ0aW1lc3RhbXAiLCJzb3VyY2UiLCJlcnJvciIsImVycm9yTWVzc2FnZSIsIkVycm9yIiwibWVzc2FnZSIsImNyZWF0ZUZhbGxiYWNrUmVzcG9uc2UiLCJnZXRDYW1wYWlnbkFuYWx5dGljc0ZhbGxiYWNrIiwibG9nTUNQVG9vbEV4ZWN1dGlvbiIsInJpc2tMZXZlbCIsImNhbXBhaWduTWV0cmljIiwiZmluZEZpcnN0IiwiY29udGVudCIsInN1Y2Nlc3MiLCJpc0Vycm9yIiwiZGF5c0JhY2siLCJzdGFydERhdGUiLCJnZXRUaW1lIiwiY2FtcGFpZ25EZXRhaWxzIiwiZW1haWxDYW1wYWlnbiIsInN1YmplY3QiLCJzdGF0dXMiLCJzZW50QXQiLCJzTVNDYW1wYWlnbiIsIndoYXRzQXBwQ2FtcGFpZ24iLCJkZXRhaWxFcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwicmVhbENvc3QiLCJjYWxjdWxhdGVSZWFsQ2FtcGFpZ25Db3N0IiwiY29zdCIsInJvaSIsImFiVGVzdERhdGEiLCJwYXJzZUVycm9yIiwidHJlbmRzIiwib3BlblJhdGVDaGFuZ2UiLCJyYW5kb20iLCJjbGlja1JhdGVDaGFuZ2UiLCJjb252ZXJzaW9uUmF0ZUNoYW5nZSIsInJlc3BvbmRlZCIsIm91dHB1dFNpemUiLCJkYXRhIiwiZGV0YWlscyIsImluIiwib3Blbl9yYXRlIiwiY2xpY2tfcmF0ZSIsImNvbnZlcnNpb25fcmF0ZSIsImluc2lnaHRzIiwiZ2VuZXJhdGVDb21wYXJpc29uSW5zaWdodHMiLCJzdGF0aXN0aWNhbEFuYWx5c2lzIiwiY2FsY3VsYXRlU3RhdGlzdGljYWxTaWduaWZpY2FuY2UiLCJjb21wYXJlZE1ldHJpY3MiLCJvcmRlckJ5RmllbGQiLCJ0b3BNZXRyaWNzIiwidG9wQ2FtcGFpZ25zIiwiUHJvbWlzZSIsImFsbCIsInJldmVudWVBdHRyaWJ1dGlvbiIsImNhbGN1bGF0ZVJldmVudWVBdHRyaWJ1dGlvbiIsInRvcFZhbHVlIiwiYXZnVmFsdWUiLCJ0b0ZpeGVkIiwic29ydGVkQnkiLCJzdGF0aXN0aWNzIiwiYXZlcmFnZVZhbHVlIiwiZnJvbSIsInRvIiwiZGF5cyIsImRhdGFQb2ludHMiLCJBcnJheSIsIl8iLCJpIiwiZGF0ZSIsInNwbGl0IiwidmFsdWUiLCJzaW4iLCJyZXZlcnNlIiwiZmFsbGJhY2tVc2VkIiwiZ2V0Q2FtcGFpZ25zRmFsbGJhY2siLCJjcmVhdGVkQnkiLCJlbnRpdHlJZCIsImFCVGVzdCIsInJlc3VsdHMiLCJlbWFpbCIsInRlc3RSZXN1bHRzIiwidGVzdCIsInZhcmlhbnQiLCJtZXRyaWNSZXN1bHRzIiwicmVzdWx0Iiwic2FtcGxlU2l6ZSIsImNvbmZpZGVuY2UiLCJjYWxjdWxhdGVDb25maWRlbmNlSW50ZXJ2YWwiLCJ0cmFmZmljUGVyY2VudCIsImNhbGN1bGF0ZUFCVGVzdFNpZ25pZmljYW5jZSIsIndpbm5lck1ldHJpYyIsIndpbm5lciIsIndpbm5lclZhcmlhbnRJZCIsImZpbmQiLCJ2IiwicmVjb21tZW5kZWRXaW5uZXIiLCJlbnRpdHlUeXBlIiwidGVzdFR5cGUiLCJ0ZXN0RWxlbWVudHMiLCJ3aW5uZXJUaHJlc2hvbGQiLCJkaXN0cmlidXRpb25QZXJjZW50Iiwic3RhcnRlZEF0IiwiZW5kZWRBdCIsImdlbmVyYXRlQUJUZXN0SW5zaWdodHMiLCJ0b3RhbFRlc3RzIiwiYWN0aXZlVGVzdHMiLCJjb21wbGV0ZWRUZXN0cyIsInNpZ25pZmljYW50VGVzdHMiLCJpc1N0YXRpc3RpY2FsbHlTaWduaWZpY2FudCIsInNpZ25pZmljYW5jZVJhdGUiLCJmYWxsYmFjayIsInZhbHVlcyIsImJlc3QiLCJtYXgiLCJ3b3JzdCIsIm1pbiIsImF2ZXJhZ2UiLCJ2YWwiLCJiZXN0Q2FtcGFpZ24iLCJ3b3JzdENhbXBhaWduIiwiaW1wcm92ZW1lbnQiLCJwdXNoIiwicmVwbGFjZSIsImNvbmZpZGVuY2VMZXZlbCIsInBWYWx1ZSIsImVmZmVjdCIsInJlY29tbWVuZGF0aW9uIiwicHJpbWFyeU1ldHJpYyIsIm1ldHJpY1ZhbHVlcyIsInNvcnRlZFZhbHVlcyIsInNvcnQiLCJhIiwiYiIsInNlY29uZCIsInAxIiwicDIiLCJuMSIsIm4yIiwicG9vbGVkUCIsInN0YW5kYXJkRXJyb3IiLCJzcXJ0IiwielNjb3JlIiwiYWJzIiwibm9ybWFsQ0RGIiwiaXNTaWduaWZpY2FudCIsImVmZmVjdFNpemUiLCJhc2luIiwiZWZmZWN0TWFnbml0dWRlIiwiY29tcGFyaXNvbiIsIndpbm5lclZhbHVlIiwicnVubmVyIiwicnVubmVyVmFsdWUiLCJwIiwibiIsInpBbHBoYSIsIm1hcmdpbk9mRXJyb3IiLCJsb3dlckJvdW5kIiwidXBwZXJCb3VuZCIsImFuYWx5c2lzIiwidmFyaWFudERhdGEiLCJiZXN0VmFyaWFudCIsImN1cnJlbnQiLCJjb250cm9sIiwidHJlYXRtZW50Iiwic2lnbmlmaWNhbmNlIiwiY2FsY3VsYXRlVHdvU2FtcGxlVGVzdCIsInZhcmlhbnRDb21wYXJpc29ucyIsImNvbmZpZGVuY2VJbnRlcnZhbCIsImlzV2lubmVyIiwidmFsdWUxIiwidmFsdWUyIiwieCIsImQiLCJleHAiLCJwcm9iIiwidG90YWxTYW1wbGVzIiwidHJhZmZpY0JhbGFuY2UiLCJtZXNzYWdpbmdVc2FnZSIsInRvdGFsQ3JlZGl0cyIsInVzYWdlIiwiY3JlZGl0cyIsImNyZWRpdENvc3RSYXRlIiwiZ2V0Q3JlZGl0Q29zdFJhdGUiLCJyZWNlbnRQdXJjaGFzZXMiLCJjcmVkaXRUcmFuc2FjdGlvbiIsInRvdGFsQW1vdW50IiwidHgiLCJhbW91bnQiLCJtZXRhZGF0YSIsImNoYW5uZWxCcmVha2Rvd24iLCJjaGFubmVsIiwibWVzc2FnZUNvdW50IiwicHJvdmlkZXIiLCJrZXlzIiwidG90YWxDb3N0IiwibmV0UHJvZml0IiwidG90YWxNZXNzYWdlcyIsImNoYW5uZWxBdHRyaWJ1dGlvbiIsImNoYW5uZWxEYXRhIiwiYXR0cmlidXRpb25SYXRpbyIsImF0dHJpYnV0ZWRSZXZlbnVlIiwicmV2ZW51ZVNoYXJlIiwiY2hhbm5lbFJPSSIsImNvc3RQZXJNZXNzYWdlIiwicmV2ZW51ZVBlck1lc3NhZ2UiLCJjb252ZXJzaW9uVmFsdWUiLCJjb3N0UGVyQ29udmVyc2lvbiIsImdlbmVyYXRlUmV2ZW51ZUF0dHJpYnV0aW9uSW5zaWdodHMiLCJjYWxjdWxhdGlvbkR1cmF0aW9uIiwiY2hhbm5lbHMiLCJiZXN0Uk9JQ2hhbm5lbCIsInRvVXBwZXJDYXNlIiwidG9wUmV2ZW51ZUNoYW5uZWwiLCJhdmdDb3N0UGVyTWVzc2FnZSIsImVmZmljaWVudENoYW5uZWxzIiwiY29zdFBlck1zZyIsImpvaW4iLCJjaGFubmVsVmFyaWFuY2UiLCJjYWxjdWxhdGVDaGFubmVsUk9JVmFyaWFuY2UiLCJyb2lzIiwibWVhbiIsInZhcmlhbmNlIiwicG93Il0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Q0FLQzs7OzsrQkFpQllBOzs7ZUFBQUE7OzsrQkFkaUI7MEJBU3ZCO3dCQUVnQjsyQkFDVTtBQUUxQixNQUFNQSxtQ0FBbUNDLDRCQUFhO0lBQzNEQyxZQUFZQyxNQUFpQyxDQUFFO1FBQzdDLEtBQUssQ0FBQztZQUNKLEdBQUdDLDJCQUFnQixDQUFDQyxPQUFPLENBQUNDLFFBQVE7WUFDcEMsR0FBR0gsTUFBTTtRQUNYO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQWdCSSxjQUFj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